function e(e){K(e),T(e),p(e),c(e),g(e),w(e),G(e),Z(e),J(e),U(e),W(e),H(e),X(e),Y(e),E(e),Q(e),S(e),N(e),b(e),n(e),v(e),m(e),o(e),d(e),r(e),j(e),I(e),z(e),h(e),s(e),O(e),x(e),u(e),l(e),f(e),V(e),i(e),A(e)}var t=angular.module("CopyleaksReport",["ngAnimate","ngSanitize","ngMaterial","ThemingModule","angularMoment","chart.js"]);function n(e){e.controller("education-report-ctrl",["$scope","$window","$timeout","utilitiesService","statisticsService","settingsService","logService","shareDialogService","pageService","affixService","reportDataService","$rootScope","contentTypeService","reportServiceListener","sourcesService","DataService","reportServiceMediator",function(i,e,s,t,r,n,o,a,c,l,u,d,p,g,m,h,f){function v(){var e=$(".contributing-to-height-1").height()+$(".contributing-to-height-report-info").height()+$(".contributing-to-height-scan-properties").height()+$(".contributing-to-height-page").height()+100;isNaN(e)||window.parent.postMessage(JSON.stringify(e),"*")}function S(){i.okToAffix=!1;try{var e=$(".contributing-to-height-page").offset().top}catch(e){}isNaN(e)&&(e=0),$("html").animate({scrollTop:e},"slow",function(){i.okToAffix=!0})}function w(e,t){i.document_pagination.ready=!0,i.document_pagination.current=parseInt(e),function(){if(p.contentType.isText())var e=u.scanned_document.text.pages.startPosition;else e=[0];i.document_pagination.total_pages=e.length}(),u.pageNum==e&&!1!==t||(S(),u.pageNum=e,i.removeAffix&&i.removeAffix(),s(function(){},10)),E(),i.updateCurrentPageMatches(),y()}function y(){d.$broadcast("updatePageMatchesNow")}$("html").css("maxHeight","auto"),u.type=u.reportTypes.multipleSuspects,i.$emit("recalculateHeaderSegments"),i.reportDataService=u,i.$on("on-element-resized",function(){v()}),s(v,1e3),i.$on("setMultipleSuspectPage",function(e,t){w(t.pageNumber)}),i.$on("switchContentType",function(){I(),w(1)}),S(),i.document_pagination={current:-1,total_pages:-1,ready:!1},i.lockedSources={},i.sources=u.sources,i.sourceListControl={},i.paginationControl={},i.paginationControl.getMaxPagination=t.getMaxPaginationCount,i.update_page_matches=y;var b=!1;function x(e){var t,n=e.type,o=e.params;switch(n){case"cb_scanned_document_success":!function(){u.pageNum?w(u.pageNum):w(1);i.$emit("hideLabelIfRequestIsInTheFuture")}();break;case"new_result_recieved":t=o.result,E(),k(t);break;case"cb_result_ready":k(o.result),E(),i.paginationControl.recomputePageColors&&i.paginationControl.recomputePageColors(u.sources);break;case"cb_last_sourceRequestSent":O();break;case"cb_emptySources":!function(){if("Processing"!=u.scanProgressPercents&&u.scanned_document&&u.scanned_document.metadata.words){if(u.showStatisticControls){var e=r.getEmpty(u.scanned_document.metadata.words);M(),i.$emit("setControlToNoResultsState",e)}i.sourceListControl.showEmpty&&i.sourceListControl.showEmpty()}u.noMatches=!0,i.$broadcast("isEmptySources",e),i.isEmpty=!0}();break;case"cb_scanned_document_error":break;case"cb_failed_to_get_resources":cb_failed_to_get_resources();break;case"result_matches_recieved":break;case"existing_results_with_matches":O();break;case"incoming_results":case"existing_result_with_matches":break;default:s(function(){throw new Error("out of range: "+n)})}}function T(e){var t=e.type;e.params;s(function(){throw new Error("out of range: "+t)})}function _(e,t){s(function(){throw new Error("out of range: "+e)})}function k(e){var t=1<i.document_pagination.total?i.document_pagination.current-1:0;i.document_pagination.ready&&e.matches&&(e.matches.identical&&0<e.matches.identical[t].length||e.matches.similar&&0<e.matches.similar[t].length||e.matches.relatedMeaning&&0<e.matches.relatedMeaning[t].length)&&i.updateCurrentPageMatchesThrotteled()}i.$on("updatePageMatches",function(){b||i.updateCurrentPageMatchesAndStatistics()}),i.updateCurrentPageMatchesAndStatistics=function(){i.updateCurrentPageMatches(),O()},i.updateCurrentPageMatches=function(){o.log("updateCurrentPageMatches() called."),i.document_pagination.ready&&(b=!0,i.$broadcast("updatePageMatches"),b=!1)},i.updateCurrentPageMatchesThrotteled=t.throttleWithGuaranteedLastRun(i.updateCurrentPageMatches,1e3),i.getMoreResults=function(){if(!n.instance.showOnlyTopResults)throw new Error("not implemented")},i.$on("getMoreResults",i.getMoreResults),i.start=function(){g.registerToEvents().then(_,T,x)},i.start(),i.focusResults=function(e){i.unfocusResults();for(var t=0;t<e.length;++t){var n=e[t];null!=n&&(i.lockedSources[n]=n)}$(window).width()<768&&i.sourceListControl&&i.sourceListControl.show&&i.sourceListControl.show()},i.unfocusResults=function(){t.clearObject(i.lockedSources)};i.source_page_changed=function(e){f.changeMultiSuspectPage(e.current),w(e.current)};function C(){if(u.scanned_document){o.log("word count: "+u.scanned_document.metadata.words);var e=u.scanned_document.metadata.words;return e&&r.haveDataForStatistics(u.sources)?(o.log("sources for statistics: "),o.log(u.sources),r.computeStatistics(u.sources,e,u.excludedRangeCount)):null}}function M(e){o.log("updateChildrenControls"),e&&(o.log("got statistics"),i.$emit("showStatistics",e)),i.paginationControl.recomputePageColors&&i.paginationControl.recomputePageColors(u.sources)}i.getStatistics=C,i.$on("updateGraph",function(){O()});var P=i.$on("switchToSingleSuspectReport",function(){i.deregisterAffix&&i.deregisterAffix()}),R=i.$on("$destroy",function(){i.deregisterAffix&&i.deregisterAffix(),P&&P(),R&&R()});var D=null;function O(){if(D&&(s.cancel(D),D=null),100==u.scanProgressPercents){if(u.showStatisticControls)var e=C();M(e),!u.showStatisticControls||e?y():D=s(O,1e3)}else D=s(O,1e3)}i.$on("raiseSourceListRefresh",E);function E(){i.sourceListControl.refresh&&i.sourceListControl.refresh()}function I(){S(),i.removeAffix&&i.removeAffix(),i.$broadcast("updateNavigationButtons")}i.switchToHtmlContentType=function(){p.contentType.setToHtml(),f.switchReportContentType("html"),I(),w(1)},i.switchToTextContentType=function(){p.contentType.setToText(),f.switchReportContentType("text"),I(),w(1),i.paginationControl.recomputePageColors&&i.paginationControl.recomputePageColors(u.sources)},i.$on("switchContentType",function(){I(),w(1)}),l.init(i,".my-target","my-affix")}])}function o(e){e.controller("one-to-one-ctrl",["$scope","$timeout","utilitiesService","statisticsService","settingsService","logService","shareDialogService","oneToOneReportService","pageService","reportDataService","scrollService","$rootScope","contentTypeService","reportServiceListener","reportServiceMediator",function(a,c,e,l,t,n,o,u,i,d,s,r,p,g,m){function h(){a.sourcePageIndex=Number(d.pageNumSource),a.resultPageIndex=Number(d.pageNumResult)}function f(){var e=$(".contributing-to-height-1").height()+$(".contributing-to-height-report-info").height()+$(".contributing-to-height-scan-properties").height()+$(".source-page").height()+100;isNaN(e)||window.parent.postMessage(JSON.stringify(e),"*")}function v(e,t,n,o){var i=function(e,t){switch(e.substr(0,1)){case"i":return t.identical;case"r":return t.relatedMeaning;case"s":return t.minorChanges}}(e,t.matches.text.comparison),s=Number(e.substr(e.lastIndexOf("_")+1)),r=i.groupId.indexOf(s);return S(n,i["source"==o?"source":"suspected"].chars.starts[r])}function S(e,t){for(var n=e.length-1;0<n;n--){if(e[n]<=t)break}return n}function w(){h(),P(),E(),a.page1Control.setText(a.sourceText)}function y(){h(),R(),I(),a.page2Control.setText(a.resultText)}function b(e){e.then(_,k,x)}function x(e){var t,n,o,i,s=e.type,r=e.params;switch(s){case"cb_scanned_document_success":!function(){P(),E(),a.showDocument=!0,a.page1Control.setText&&a.page1Control.setText(a.sourceText);a.$emit("hideLabelIfRequestIsInTheFuture"),N()}();break;case"new_result_recieved":i=r.result,u.setSource(angular.merge({},i)),d.resultTitle=i.title;break;case"cb_result_ready":!function(){R(),I(),E(),a.page1Control.setText&&a.page1Control.setText(a.sourceText);a.page2Control.setText&&a.page2Control.setText(a.resultText);N()}();break;case"cb_last_sourceRequestSent":break;case"cb_emptySources":!function(){if(d.scanned_document&&100==d.scanProgressPercents&&d.scanned_document.metadata.words){if(d.showStatisticControls){var e=l.getEmpty(d.scanned_document.metadata.words);F(),a.$emit("setControlToNoResultsState",e)}a.sourceListControl.showEmpty&&a.sourceListControl.showEmpty()}}();break;case"incoming_results":n=r.sources,o=underscore.find(n.results.all,function(e){return e.id==d.resultId}),u.setSource(o),d.resultTitle=o.title;break;case"result_matches_recieved":!function(e,t){if(e!=d.resultId)return;u.resultSuccess(t),T()}(r.suspectId,r.match);break;case"existing_result_with_matches":t=r.result,u.setSource(angular.merge({},t)),d.resultTitle=t.title,u.resultSuccess(t.matches),T();break;default:c(function(){throw new Error("out of range: "+s)})}}function T(){a.result=u.getSource(),a.page1Control.hasResult=!0,a.page2Control.hasResult=!0,R(),N(),E(),I(),c(function(){a.page1Control.setText&&a.page1Control.setText(a.sourceText),a.page2Control.setText&&a.page2Control.setText(a.resultText)})}function _(e,t){}function k(e,t){switch(e){case"cb_scanned_document_error":t.response,a.showDocument=!1;break;case"cb_failed_to_get_resources":break;default:c(function(){throw new Error("out of range: "+e)})}}function C(){return p.contentType.isHtml()?0:a.sourcePaginationObject&&a.sourcePaginationObject.pagination?a.sourcePaginationObject.pagination.current-1:0}function M(){return p.contentType.isHtml()?0:a.suspectPaginationObject&&a.suspectPaginationObject.pagination?a.suspectPaginationObject.pagination.current-1:0}function P(){a.reportDataService.scanned_document&&(p.contentType.isText()?a.sourcePages=a.reportDataService.scanned_document.text.splitValue:a.sourcePages=[a.reportDataService.scanned_document.html.value],angular.extend(a.sourcePaginationObject.pagination,{current:parseInt(a.sourcePageIndex),total_pages:a.sourcePages.length,ready:!0}),a.$broadcast("updateNavigationButtons"),a.sourceText=a.sourceTextClean=a.sourcePages[C()])}function R(){a.result=u.getSource(),a.suspectResult||(a.suspectResult=u.getSuspect()),a.sourcesForSource={},a.sourcesForSource[a.result.id]=a.result,a.sourcesForSuspect={},a.sourcesForSuspect[a.result.id]=a.suspectResult,a.sourcePaginationObject.results=a.sourcesForSource,a.suspectPaginationObject.results=a.sourcesForSuspect,a.suspectTitle=a.result.title,a.suspectUrl=a.suspectResult.url,D()}function D(){a.resultPages=function(){if(p.contentType.isText()){if(a.suspectTextPages)return a.suspectTextPages;var e=new B;return a.suspectTextPages=e.splitText(a.result.matches.text.value,a.result.matches.text.pages.startPosition),a.suspectTextPages}return[a.result.matches.html.value]}(),a.resultPages&&(angular.extend(a.suspectPaginationObject.pagination,{current:parseInt(a.resultPageIndex),total_pages:a.resultPages.length,ready:!0}),r.$broadcast("updateNavigationButtons"),a.resultText=a.resultPages[M()],a.page2Control.setText&&a.page2Control.setText(a.resultText),a.sourceTitle="Your text",f())}function O(){d.scrollToPagesPlease&&c(function(){d.scrollToPagesPlease=!1,$("html, body").scrollTop($(".contributing-to-height-page").offset().top)})}function E(){if(a.sourcesForSource){if(a.result){var e=C(),t=i.updateCurrentPageMatches([a.result],e,d.excludedRangesPerPage,p.contentType.get());a.sourceText=i.highlightText({text:a.sourceTextClean,matches:t,sources:a.sourcesForSource,mapType:"sourceToSuspect",reportType:"1to1",disableTooltip:!0,pageType:d.pageTypes.source}),c(function(){s.scrollSource(a.page1Control),O()},300),a.sourcePaginationObject.control.recomputePageColors&&a.sourcePaginationObject.control.recomputePageColors(a.sourcesForSource)}}else a.page1Control.setText&&a.page1Control.setText(a.sourceText)}function I(){if(a.sourcesForSuspect&&a.suspectPaginationObject.pagination){var e=p.contentType.isHtml()&&a.suspectResult.matches.html?"html":"text",t=i.updateCurrentPageMatches([a.suspectResult],M(),null,e);a.resultText=i.highlightText({text:a.resultText,matches:t,sources:a.sourcesForSuspect,mapType:"suspectToSource",reportType:"1to1",disableTooltip:!0,contentType:a.result.contentType,pageType:d.pageTypes.suspect}),c(function(){s.scrollSuspect(a.page2Control),O()},300),a.suspectPaginationObject.control.recomputePageColors&&a.suspectPaginationObject.control.recomputePageColors(a.sourcesForSuspect)}}function N(){if(d.showStatisticControls)var e=function(){if(d.scanned_document){n.log("word count: "+d.scanned_document.metadata.words);var e=d.scanned_document.metadata.words;return e&&l.haveDataForStatistics(a.sourcesForSource)?(n.log("sources for statistics: "),n.log(a.sourcesForSource),l.computeStatistics(a.sourcesForSource,e,d.excludedRangeCount)):null}}();F(e)}function F(e){n.log("updateChildrenControls"),e&&(n.log("got statistics"),a.$emit("showStatistics",e))}function L(){P(),D(),E(),I(),c(function(){a.page1Control.setText&&a.page1Control.setText(a.sourceText),a.page2Control.setText&&a.page2Control.setText(a.resultText)}),switchingContentType=!0}d.type=d.reportTypes.singleSuspect,a.$emit("recalculateHeaderSegments"),a.oneToOneReportService=u,a.reportDataService=d,a.contentTypeService=p,a.resultId=d.resultId,d.pageNumSource||(d.pageNumSource=1),d.pageNumResult||(d.pageNumResult=1),h(),a.page1Control={},a.page2Control={},a.sourcePaginationObject={control:{},pagination:{ready:!1}},a.suspectPaginationObject={control:{},pagination:{ready:!1}},window.maxHeight&&$("html").css("maxHeight",window.maxHeight+"px"),a.$on("gotParentHeight",function(){$("html").css("maxHeight",window.maxHeight+"px")}),c(f,1e3),a.$on("on-element-resized",function(){f()}),a.sourceMatchSelected=function(e){if(p.contentType.isHtml()&&a.suspectResult.matches.html)a.page2Control.scrollToMatch(e);else{s.setSuspectMatchToScrollTo(e[0]);var t=v(e[0],u.getSource(),a.suspectResult.matches.text.pages.startPosition,"suspect");a.suspectPaginationObject.pagination.current!=t+1?(a.suspectPaginationObject.pagination.current=t+1,a.resultPagechanged(!0)):s.scrollSuspect(a.page2Control)}},a.suspectMatchSelected=function(e){if(p.contentType.isHtml())a.page1Control.scrollToMatch(e);else{s.setSourceMatchToScrollTo(e[0]);var t=v(e[0],u.getSource(),d.scanned_document.text.pages.startPosition,"source");a.sourcePaginationObject.pagination.current!=t+1?(a.sourcePaginationObject.pagination.current=t+1,a.sourcePageChanged()):s.scrollSource(a.page1Control)}},a.$on("setSingleSuspectSourcePage",function(e,t){d.pageNumSource=a.sourcePaginationObject.pagination.current=t.pageNumber,w()}),a.sourcePageChanged=function(e){e||s.recordSuspectPageTopLocation(),d.pageNumSource=a.sourcePaginationObject.pagination.current,m.changeSingleSuspectSourcePage(d.pageNumSource),w()},a.$on("setSingleSuspectSuspectPage",function(e,t){d.pageNumResult=a.suspectPaginationObject.pagination.current=t.pageNumber,y()}),a.sourcePaginationObject.changed=a.sourcePageChanged,a.resultPagechanged=function(e){e||s.recordSourcePageTopLocation(),d.pageNumResult=a.suspectPaginationObject.pagination.current,m.changeSingleSuspectSuspectPage(d.pageNumResult),y()},a.suspectPaginationObject.changed=a.resultPagechanged,a.result=u.getSource(),a.suspectResult||(a.suspectResult=u.getSuspect()),a.suspectResult&&a.result&&a.result.matches&&a.result.matches.pages&&a.reportDataService.scanned_document&&(!p.contentType.get||(p.isHtmlContentType(a.result.contentType)?p.contentType.isHtml():p.contentType.isText()))?(b(g.registerToEvents()),function(){var e=null;e=p.isHtmlContentType(a.result.contentType)?[0]:a.result.matches.text.pages.startPosition;var t=new B;d.suspectPages=t.splitText(a.result.text,e),P(),R(),N(),E(),I(),c(function(){a.page1Control.setText&&a.page1Control.setText(a.sourceText),a.page2Control.setText&&a.page2Control.setText(a.resultText)})}()):b(g.registerToEvents()),a.suspectHasHtmlContentType=function(){return a.suspectResult.matches.html},a.$on("switchContentType",function(e,t){L()}),a.switchContentType=function(){p.contentType.switch(),m.switchReportContentType(p.contentType.get()),L()}}])}function i(e){e.controller("reportController",["$scope","reportDataService","contentTypeService","reportServiceListener","$timeout","reportServiceMediator","utilitiesService",function(n,t,e,o,i,s,r){function a(){if(t.scanned_document&&(o.onDocumentReady(t.scanned_document),t.resultId)){var e=t.sources[t.resultId];e&&o.deferred.notify({type:"existing_result_with_matches",params:{result:e}})}}function c(){t.scanned_document&&(o.onDocumentReady(t.scanned_document),t.sources&&0!=r.length(t.sources)&&o.deferred.notify({type:"existing_results_with_matches",params:{result:t.sources}}))}n.reportDataService=t,n.contentTypeService=e,n.showOneToOne=t.type==t.reportTypes.singleSuspect,n.goBack=function(){s.backButtonClicked()},n.$on("switchToSingleSuspectReport",function(e,t){n.$broadcast("recalculatingStatistics"),n.showOneToOne=!0,s.registered=a}),n.$on("switchToMultiSuspectReport",function(){n.$broadcast("recalculatingStatistics"),n.showOneToOne=!1,s.registered=c})}])}function s(e){function t(n,e,t,o,i,s,r){n.showShareModal=function(){r.show()},n.reportDataService=i,n.statisticsControl={},n.scanPropertiesControl={},n.$on("showStatistics",function(e,t){n.scanPropertiesControl.statistics=t,n.statisticsControl.statistics=t,n.scanPropertiesControl.showStatistics&&n.scanPropertiesControl.showStatistics(t),n.statisticsControl.showStatistics&&n.statisticsControl.showStatistics(t)}),n.$on("setControlToNoResultsState",function(e,t){s.setControlToNoResultsState(n.scanPropertiesControl,t),s.setControlToNoResultsState(n.statisticsControl,t)}),n.$on("hideLabelIfRequestIsInTheFuture",function(){!function(){if(i.scannedDocumentMeta&&i.scannedDocumentMeta.creationTime){var e=moment(),t=moment.utc(i.scannedDocumentMeta.creationTime);n.isRequestTimeInTheFuture=e<t?function(){return new moment<moment.utc(i.scannedDocumentMeta.creationTime)||!(n.isRequestTimeInTheFuture=function(){return!1})}:function(){return!1}}}()})}t.$inject=["$scope","settingsService","logService","$element","reportDataService","utilitiesService","shareDialogService"],e.directive("cpEducationReportTopArea",[function(){return{restrict:"A",controller:t}}])}function r(e){function t(n,o,e,t,i,s,r,a,c,l,u,d){n.reportDataService=a,n.isShared=!!window.keyForToken,n.toggleBurger=function(){n.isBurgerMenuVisible=!n.isBurgerMenuVisible},n.control.setText=function(t){n.loaded=!0,o(function(){t=u.getIframeText(t);var e=c.find(".content-iframe")[0];$(e).attr("srcdoc",t)},100)},n.control.scrollToMatch=function(e){var t={matchId:e,type:"copyleaksMatchScrollRequest"},n=JSON.stringify(t),o=c.find(".content-iframe")[0];o&&o.contentWindow&&o.contentWindow.postMessage(n,"*")},n.text&&n.control.setText(n.text),t.initScopeForIframeZoom(n),n.clicked=function(e){var t=e.currentTarget.getAttribute("ranges");n.raiseFocusResults(t)},n.raiseFocusResults=function(e){n.focusResult({items:e})},n.toggleBurger=function(){n.isBurgerMenuVisible=!n.isBurgerMenuVisible},n.showShareModal=function(){r.show()},n.$watch("pageTitle",function(e,t){e!=t&&(n.showToolTip="Your text"!=e)}),window.addEventListener("message",function(e){if(!e||!e.data)return;var t=null;try{t=JSON.parse(e.data)}catch(e){return}if("copyleaksMatchClicked"!==t.type)return;if(t.pageType!=n.pageType)return;o(function(){n.raiseFocusResults(t.rangeIds)})},!1),n.download=function(){n.pageType==a.pageTypes.source?d.downloadSource("html"):d.downloadSuspect("html")}}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","reportDataService","$element","pageService","iframeService","reportServiceMediator"],e.directive("cpOneToOneHtmlPage",["logService",function(e){return{restrict:"E",scope:{control:"=",text:"=",focusResult:"&",pageTitle:"=",pageType:"@",pageUrl:"=?",switchContentType:"&"},template:'<div class="panel panel-scanned-text parent-height" ng-clock><div class="burger-menu" ng-show="isBurgerMenuVisible"><div class="burger-menu-item" role="button"><a ng-click="zoom < maxZoom && zoomIn()" ng-class="{\'disabled\': zoom == maxZoom}"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">zoom_in</md-icon></a></div><div class="burger-menu-item" role="button"><a ng-click="zoom > minZoom && zoomOut()" ng-class="{\'disabled\': zoom == minZoom}"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">zoom_out</md-icon></a></div><div class="burger-menu-item" role="button" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a></div><div class="burger-menu-item" role="button" ng-if="pageUrl" aria-label="visit website"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="showShareModal()"><md-icon md-font-icon="link">share</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="switchContentType()"><md-icon md-font-icon="link">title</md-icon></a></div></div><div class="panel-heading" layout="row"><div class="one-to-one-page-title" flex><md-tooltip ng-if="showToolTip">{{pageTitle}}</md-tooltip>{{pageTitle}}</div><span class="hidden visible-when-burger"><a ng-click="toggleBurger()"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">menu</md-icon></a></span> <span class="hidden-when-burger"><a class="btn-share-report-mobile" ng-click="switchContentType()"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span> <span class="hidden-when-burger"><md-icon class="panel-heading-button-with-md-icon" ng-click="zoom > minZoom && zoomOut()" md-font-icon="link" ng-class="{\'disabled\': zoom == minZoom}">zoom_out</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom Out</md-tooltip></span> <span class="hidden-when-burger"><md-icon ng-click="zoom < maxZoom && zoomIn()" class="panel-heading-button-with-md-icon" md-font-icon="link" ng-class="{\'disabled\': zoom == maxZoom}">zoom_in</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom In</md-tooltip></span> <span class="hidden-when-burger" ng-if="pageUrl"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile" aria-label="visit website"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Visit Website</md-tooltip></span> <span class="hidden-when-burger" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span></div><div class="panel-body panel-body-html" ng-class="{\'results-panel-body\': !loaded || reportDataService.working, \'heigher\': !paginationObject || paginationObject.pagination.total_pages == 1 && otherPageObject.pagination.total_pages == 1}"><md-progress-circular md-mode="indeterminate" class="pull-left hide-during-angular-ng-leave" md-diameter="50px" ng-show="!loaded || reportDataService.working"></md-progress-circular><md-tooltip md-direction="bottom" ng-show="!loaded" class="hide-during-angular-ng-leave" md-delay="500">Loading page...</md-tooltip><iframe class="content-iframe" sandbox="allow-scripts" seamless frameBorder="0" style="height:100%;width:100%;" ng-style="iframeStyle"></iframe></div></div>',controller:t,link:function(e,t,n){}}}])}e(t);var a=window.innerHeight;function c(e){function t(l,e,t,n,u,d,o,p,g,i,m,s,r){l.settings=t.instance,l.reportDataService=g,l.isShared=!!window.keyForToken,l.showShareModal=function(){o.show()},l.download=function(){r.downloadSource("html")},n.initScopeForIframeZoom(l);var h=null;function a(){if(d.log("refreshMatches() called."),g.scanned_document&&g.scanned_document.html){var e,t=p.updateCurrentPageMatches(g.sources,0,g.excludedHtmlRangesPerPage,"html");((e=t).identical&&0<e.identical.length||e.relatedMeaning&&0<e.relatedMeaning.length||e.similar&&0<e.similar.length)&&(l.isSwitchTypeVisible=!0);var n,o,i=(n=t,(o={}).identical=underscore.pluck(n.identical,"id"),o.similar=underscore.pluck(n.similar,"id"),o.relatedMeaning=underscore.pluck(n.relatedMeaning,"id"),o.similar=underscore.pluck(n.similar,"id"),o);if(!(h&&(r=h,f((s=i).identical,r.identical)&&f(s.similar,r.similar)&&f(s.relatedMeaning,r.relatedMeaning)))){var s,r;h=i,l.loaded=!0;var a=p.highlightText({text:g.scanned_document.html.value,matches:t,sources:g.sources,mapType:"sourceToSuspect",disableTooltip:!0});a=m.getIframeText(a);var c=document.getElementById("sourceIframe");$(c).attr("srcdoc",a),u.$broadcast("registerAffix",{type:"html"})}}}function f(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;for(var n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}l.refreshMatches=a,g.scanned_document&&g.scanned_document.html&&a(),l.$on("isEmptySources",function(){l.isSwitchTypeVisible=!0}),window.addEventListener("message",function(e){if(!e||!e.data)return;var t=null;try{t=JSON.parse(e.data)}catch(e){return}if("copyleaksMatchClicked"!==t.type)return;l.clicked(t.rangeIds)},!1),l.askForRefresh=underscore.throttle(function(){d.log("Asked page matches to refresh"),l.refreshedNow?l.refreshedNow=!1:a()},3e4),l.clicked=function(e){if(1!=e.length||-1!=e[0]){var t=underscore.map(e,g.getSourceIdFromMatchId);l.focusResults({items:t})}},l.exitLocked=function(){l.focusResults({})}}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","pageService","reportDataService","$element","iframeService","contentTypeService","reportServiceMediator"],e.directive("cpHtmlPage",["logService","contentTypeService",function(o,i){return{restrict:"E",scope:{focusResults:"&",unfocus:"&",switchContentType:"&",text:"=?"},template:'<div class="panel panel-scanned-text parent-height"><div class="panel-heading" layout="row"><div flex></div><span class="hidden-when-burger"><md-icon ng-click="zoom < maxZoom && zoomIn()" class="panel-heading-button-with-md-icon" md-font-icon="link" ng-class="{\'disabled\': zoom == maxZoom}">zoom_in</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom In</md-tooltip></span> <span class="hidden-when-burger"><md-icon class="panel-heading-button-with-md-icon" ng-click="zoom > minZoom && zoomOut()" md-font-icon="link" ng-class="{\'disabled\': zoom == minZoom}">zoom_out</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom Out</md-tooltip></span> <span ng-if="!isShared" class="hidden-when-burger"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span> <span><a class="btn-share-report-mobile hidden visible-xs-inline" ng-click="showShareModal()"><md-icon md-font-icon="link" class="panel-heading-button-with-md-icon">share</md-icon></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Share this report</md-tooltip></span> <span class="hidden-when-burger"><a class="btn-share-report-mobile" ng-click="isSwitchTypeVisible ? switchContentType() : angular.noop" ng-class="{\'disabeld-anchor\' : !isSwitchTypeVisible}"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span></div><div class="panel-body panel-body-html results-panel-body multi heigher"><md-progress-circular md-mode="indeterminate" class="hide-during-angular-ng-leave" md-diameter="50px" ng-show="!loaded || reportDataService.working"></md-progress-circular><md-tooltip md-direction="auto" ng-show="!loaded" class="hide-during-angular-ng-leave" md-delay="500">Loading page...</md-tooltip><iframe id="sourceIframe" width="100%" sandbox="allow-scripts" seamless frameBorder="0" style="max-height: 100%; height:100%" ng-style="iframeStyle"></iframe></div></div>',controller:t,link:function(e,t,n){e.$on("updatePageMatches",function(){i.contentType.isText()||(o.log("cp-page: currentMatches changed!"),e.askForRefresh())}),e.$on("updatePageMatchesNow",function(){i.contentType.isText()||(e.refreshMatches(),e.refreshedNow=!0)})}}}])}function l(e){e.directive("multiSuspectReport",[function(){return{restrict:"E",template:'<div ng-cloak layout="row" class="parent-height contributing-to-height-page" ng-if="!reportDataService.isErrored" cp-on-resize><div flex-gt-lg="75" flex-gt-xs="67" flex="100" ng-if="contentTypeService.contentType.isText()" class="almost-parent-height" id="my-affix" ng-class="{\'no-pagination\': !document_pagination.ready || document_pagination.total_pages == 1}"><md-card layout="row" class="parent-height"><div flex class="parent-height overflow-x-hidden"><cp-page focus-results="focusResults(items)" unfocus="unfocusResults()" document-pagination="document_pagination" switch-content-type="switchToHtmlContentType()"></cp-page></div></md-card><div layout="row" class="pagination-row" ng-show="document_pagination.current > 0 && document_pagination.total_pages > 1"><div flex><cp-pagination2 pagination="document_pagination" control="paginationControl" on-changed="source_page_changed(pagination);" initial-sources="paginationObject.results"></cp-pagination2></div></div><div layout="row" class="one-to-one-footer my-target"><span>Powered by</span><a href="https://copyleaks.com" alt="Copyleaks.com"><img src="/images/small_logo_black.png"></a></div></div><div flex-gt-lg="75" flex-gt-xs="67" flex="100" class="almost-parent-height" id="my-affix" ng-if="contentTypeService.contentType.isHtml()"><md-card layout="row" class="parent-height"><div flex class="parent-height overflow-x-hidden"><cp-html-page focus-results="focusResults(items)" unfocus="unfocusResults()" switch-content-type="switchToTextContentType()"></cp-html-page></div></md-card><div layout="row" class="pagination-row" ng-show="document_pagination.current > 0 && document_pagination.total_pages > 1"><div flex><cp-pagination2 pagination="document_pagination" control="paginationControl" on-changed="source_page_changed(pagination);" initial-sources="paginationObject.results"></cp-pagination2></div></div><div layout="row" class="one-to-one-footer my-target"><span>Powered by</span><a href="https://copyleaks.com" alt="Copyleaks.com"><img src="/images/small_logo_black.png"></a></div></div><div flex-gt-lg="25" flex-gt-xs="33" flex="100"><md-card id="result-column-next-to-affix"><div layout="row"><div flex class="actual-results"><cp-sources sources="sources" selection-changed="updateCurrentPageMatchesAndStatistics()" locked-sources="lockedSources" pagination="document_pagination" control="sourceListControl"></cp-sources></div></div></md-card></div></div>',controller:"education-report-ctrl"}}])}function u(e){e.directive("cpOneToOneReport",[function(){return{restrict:"E",template:'<div class="container parent-height main-container"><div ng-cloak layout-xs="column" layout="row" class="parent-height contributing-to-height-page" ng-if="!reportDataService.isErrored" cp-on-resize><md-card flex-xs="100" flex-gt-xs="50" class="source-page one-to-one-page"><div class="parent-height overflow-x-hidden"><cp-one-to-one-page control="page1Control" ng-if="contentTypeService.contentType.isText()" text="sourceText" focus-result="sourceMatchSelected (items)" page-title="sourceTitle" page-url="sourceUrl" page-type="{{reportDataService.pageTypes.source}}" pagination-object="sourcePaginationObject" other-page-object="suspectPaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-page><cp-one-to-one-html-page control="page1Control" ng-if="contentTypeService.contentType.isHtml()" text="sourceText" focus-result="sourceMatchSelected (items)" page-title="sourceTitle" page-type="{{reportDataService.pageTypes.source}}" page-url="sourceUrl" pagination-object="sourcePaginationObject" other-page-object="suspectPaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-html-page></div></md-card><md-card flex-xs="100" flex-gt-xs="50" class="suspect-page one-to-one-page"><div class="parent-height overflow-x-hidden"><cp-one-to-one-page control="page2Control" text="resultText" ng-if="contentTypeService.contentType.isText() || !result.matches.html" focus-result="suspectMatchSelected(items)" page-title="suspectTitle" page-url="suspectUrl" page-type="{{reportDataService.pageTypes.suspect}}" pagination-object="suspectPaginationObject" other-page-object="sourcePaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-page><cp-one-to-one-html-page control="page2Control" text="resultText" ng-if="contentTypeService.contentType.isHtml() && result.matches.html" focus-result="suspectMatchSelected(items)" page-title="suspectTitle" page-type="{{reportDataService.pageTypes.suspect}}" page-url="suspectUrl" pagination-object="suspectPaginationObject" other-page-object="sourcePaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-html-page></div></md-card></div><div layout="row" class="one-to-one-footer"><span>Powered by</span><a href="https://copyleaks.com" alt="Copyleaks.com"><img src="/images/small_logo_black.png"></a></div></div>',controller:"one-to-one-ctrl"}}])}function d(e){function t(n,e,t,o,i,s,r,a,c,l,u){n.reportDataService=a,n.highlighted_text=n.text,n.isSwitchToHtmlVisible=1<a.availableTypes.length,n.isShared=!!window.keyForToken,n.paginationObject.control.getMaxPagination=o.getMaxPaginationOneToOne,n.download=function(){n.pageType==a.pageTypes.source?u.downloadSource("text"):u.downloadSuspect("text")},n.control.setText=function(e){n.highlighted_text=e},n.control.findElement=function(e){return c.find(e)},n.clicked=function(e,t){$(".selected-match").removeClass("selected-match"),e.target.classList.add("selected-match"),n.focusResult({items:t})},n.settings=t.instance,n.pageSettings=t.instance[n.pageType],n.source_set_rtl=function(e){n.pageSettings.ui.rtlMode=e,t.set_settings(t.instance)},n.source_font_inc=function(){n.pageSettings.ui.fontSize+=1,n.pageSettings.ui.fontSize=Math.min(n.pageSettings.ui.fontSize,35),t.set_settings(t.instance)},n.source_font_dec=function(){n.pageSettings.ui.fontSize-=1,n.pageSettings.ui.fontSize=Math.max(5,n.pageSettings.ui.fontSize),t.set_settings(t.instance)},n.toggleBurger=function(){n.isBurgerMenuVisible=!n.isBurgerMenuVisible},n.showShareModal=function(){r.show()},n.$watch("pageTitle",function(e,t){e!=t&&(n.showToolTip="Your text"!=e)})}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","reportDataService","$element","pageService","reportServiceMediator"],e.directive("cpOneToOnePage",["logService",function(e){return{restrict:"E",scope:{control:"=",text:"=",focusResult:"&",pageTitle:"=",pageType:"@",paginationObject:"=",otherPageObject:"=",switchContentType:"&",pageUrl:"=?"},template:'<div class="panel panel-scanned-text parent-height" ng-clock><div class="burger-menu" ng-show="isBurgerMenuVisible" ng-clock><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/format_align_left/white@3x.svg" ng-click="source_set_rtl(false)"></div><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/format_align_right/white@3x.svg" ng-click="source_set_rtl(true)"></div><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/FontSizeUp/white@3x.svg" ng-click="source_font_inc()"></div><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/FontSizeDown/white@3x.svg" ng-click="source_font_dec()"></div><div class="burger-menu-item" role="button" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a></div><div class="burger-menu-item" role="button" ng-if="pageUrl && pageUrl != \'Uploaded text\'" aria-label="visit website"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="showShareModal()"><md-icon md-font-icon="link">share</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="switchContentType()" ng-disabled="!isSwitchToHtmlVisible"><md-icon md-font-icon="link" class="clicked-panel-button">title</md-icon></a></div></div><div class="panel-heading" layout="row"><div class="one-to-one-page-title" flex><md-tooltip ng-if="showToolTip">{{pageTitle}}</md-tooltip>{{pageTitle}}</div><span class="hidden-when-burger"><a class="btn-share-report-mobile" ng-click="isSwitchToHtmlVisible ? switchContentType() : angular.noop" ng-disabled="!isSwitchToHtmlVisible"><md-icon class="panel-heading-button-with-md-icon clicked-panel-button" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/format_align_left/white@3x.svg" ng-click="source_set_rtl(false)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Left</md-tooltip></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/format_align_right/white@3x.svg" ng-click="source_set_rtl(true)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Right</md-tooltip></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/FontSizeUp/white@3x.svg" ng-click="source_font_inc()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Increase Font Size</md-tooltip></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/FontSizeDown/white@3x.svg" ng-click="source_font_dec()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Decrease Font Size</md-tooltip></span> <span class="hidden-when-burger" ng-if="pageUrl && pageUrl != \'Uploaded text\'"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile" aria-label="visit website"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Visit Website</md-tooltip></span> <span class="hidden-when-burger" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span> <span class="hidden visible-when-burger"><a ng-click="toggleBurger()"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">menu</md-icon></a></span></div><div class="panel-body panel-body-scrollable flexcroll" ng-class="{\'heigher\': paginationObject.pagination.total_pages == 1 && otherPageObject.pagination.total_pages == 1, \'results-panel-body\': !highlighted_text || !control.hasResult }"><md-progress-circular md-mode="indeterminate" class="pull-left hide-during-angular-ng-leave" md-diameter="50px" ng-show="!highlighted_text || !control.hasResult"></md-progress-circular><pre ng-show="highlighted_text" ng-bind-html-compile="highlighted_text | unsafe" compile-tags="span" style="font-size: {{ pageSettings.ui.fontSize }}px;" ng-class="{\'rtl-mode\': pageSettings.ui.rtlMode, \'identical-on\': settings.showIdentical, \'similar-on\': settings.showSimilar, \'related-on\': settings.showRelated}"></pre></div><div class="panel-footer" ng-hide="!highlighted_text || paginationObject.pagination.total_pages == 1 && otherPageObject.pagination.total_pages == 1"><div class="one-to-one-pagination-row"><cp-pagination2 pagination="paginationObject.pagination" control="paginationObject.control" on-changed="paginationObject.changed()" initial-sources="paginationObject.results"></cp-pagination2></div></div></div>',controller:t}}])}function p(e){function t(o,e,t,n,i,s,r,a,c,l,u){function d(){if(s.log("refreshMatches() called."),c.scanned_document&&c.scanned_document.text&&c.scanned_document.text.splitValue&&!(o.documentPagination.current<1)&&o.documentPagination.ready){var e=a.updateCurrentPageMatches(c.sources,o.documentPagination.current-1,c.excludedRangesPerPage,"text"),t=c.scanned_document.text.splitValue[o.documentPagination.current-1];(0<n.length(c.sources)||c.noMatches)&&(o.isSwitchTypeVisible=!0),o.highlighted_text=a.highlightText({text:t,matches:e,sources:c.sources,mapType:"sourceToSuspect"}),i.$broadcast("registerAffix",{type:"text"})}}o.settings=t.instance,o.reportDataService=c,o.isShared=!!window.keyForToken,o.showShareModal=function(){r.show()},o.download=function(){u.downloadSource("text")},o.shouldHide=function(){return!c.scanned_document||!!l.contentType.isHtml()},o.isSwitchToHtmlVisible=1<c.availableTypes.length,o.refreshMatches=d,c.scanned_document&&c.scanned_document.text.splitValue&&(o.shouldHide()||d()),o.askForRefresh=underscore.throttle(function(){o.askedForRefresh&&(s.log("Asked page matches to refresh"),d())},15e3),o.clicked=function(e,t){if(1!=t.length||-1!=t[0]){e.target.classList.add("selected-match");var n=underscore.map(t,c.getSourceIdFromMatchId);o.focusResults({items:n})}},o.exitLocked=function(){o.focusResults({})},o.source_set_rtl=function(e){t.instance.ui.rtlMode=e,t.set_settings(t.instance)},o.source_font_inc=function(){t.instance.ui.fontSize+=1,t.instance.ui.fontSize=Math.min(t.instance.ui.fontSize,35),t.set_settings(t.instance)},o.source_font_dec=function(){t.instance.ui.fontSize-=1,t.instance.ui.fontSize=Math.max(5,t.instance.ui.fontSize),t.set_settings(t.instance)}}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","pageService","reportDataService","contentTypeService","reportServiceMediator"],y(e),e.directive("cpPage",["logService","contentTypeService",function(o,e){return{restrict:"E",scope:{focusResults:"&",unfocus:"&",documentPagination:"=",switchContentType:"&"},template:'<div class="panel panel-scanned-text" layout="column"><div class="panel-heading" layout="row"><div flex></div><span><img src="/images/compare-education/formating/format_align_left/white@3x.svg" ng-click="source_set_rtl(false)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Left</md-tooltip></span> <span><img src="/images/compare-education/formating/format_align_right/white@3x.svg" ng-click="source_set_rtl(true)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Right</md-tooltip></span> <span><img src="/images/compare-education/formating/FontSizeUp/white@3x.svg" ng-click="source_font_inc()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Increase Font Size</md-tooltip></span> <span><img src="/images/compare-education/formating/FontSizeDown/white@3x.svg" ng-click="source_font_dec()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Decrease Font Size</md-tooltip></span> <span ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span> <span><a class="btn-share-report-mobile hidden visible-xs-inline" ng-click="showShareModal()"><md-icon md-font-icon="link" class="panel-heading-button-with-md-icon">share</md-icon></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Share this report</md-tooltip></span> <span><a class="btn-share-report-mobile" ng-click="isSwitchToHtmlVisible || isSwitchTypeVisible? switchContentType() : angular.noop" ng-class="{\'disabeld-anchor\' : !isSwitchToHtmlVisible || !isSwitchTypeVisible}"><md-icon class="panel-heading-button-with-md-icon" ng-click="switchContentType()" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span></div><div class="panel-body flexcroll" ng-class="{\'results-panel-body\': !highlighted_text}" flex><div class="text-page-loading-container"><md-progress-circular md-mode="indeterminate" class="hide-during-angular-ng-leave text-loading-indicator" md-diameter="50px" ng-show="!highlighted_text || reportDataService.working"></md-progress-circular></div><pre ng-show="highlighted_text" ng-bind-html-compile="highlighted_text | unsafe" compile-tags="span" style="font-size: {{ settings.ui.fontSize }}px;" ng-class="{\'rtl-mode\': settings.ui.rtlMode, \'identical-on\': settings.showIdentical, \'similar-on\': settings.showSimilar, \'related-on\': settings.showRelated}"></pre></div></div>',controller:t,link:function(e,t,n){e.askedForRefresh=!1,e.$on("updatePageMatches",function(){e.shouldHide()||(o.log("cp-page: currentMatches changed!"),e.askedForRefresh=!0,e.askForRefresh())}),e.$on("updatePageMatchesNow",function(){e.shouldHide()||(e.askedForRefresh=!1,e.refreshMatches())})}}}])}function g(e){function t(s,r,a,e,t){var c={a:[],get g(){return angular.merge({},this.a)},set s(e){this.a=e}};function n(){void 0===s.pagination.current&&(s.pagination.current=s.savedCurrent)}function o(){if(void 0!==s.pagination.current&&1<s.pagination.current)for(var e=s.pagination.current-2;0<=e;e--)if(c.g[e]!=u.noMatch)return{index:e+1,matchType:c.g[e]}}function i(){if(void 0!==s.pagination.current&&s.pagination.current<s.pagination.total_pages)for(var e=s.pagination.current,t=s.pagination.total_pages,n=e;n<t;n++)if(c.g[n]!=u.noMatch)return{index:n+1,matchType:c.g[n]}}function l(){s.onChanged({pagination:s.pagination}),s.setNextMatchesButtons()}s.pagination.ready&&(s.savedCurrent=s.pagination.current),s.source_next=function(){s.pagination.ready&&(n(),void 0!==s.pagination&&s.pagination.total_pages!==s.pagination.current&&(s.pagination.current+=1,l()))},s.source_back=function(){s.pagination.ready&&(n(),void 0===s.pagination||s.pagination.current<=1||(s.pagination.current-=1,l()))},s.findMatchBackwards=function(){if(s.pagination.ready&&(n(),!(s.pagination.total_pages<=1))){var e=o();e&&(s.pagination.current=e.index,l())}},s.findMatchForwards=function(){if(s.pagination.ready&&(n(),s.pagination.current!==s.pagination.total_pages)){var e=i();e&&(s.pagination.current=e.index,l())}},s.page_changed=function(){null!=s.pagination.current?l():s.pagination.current=s.savedCurrent},s.updateNavButtons=function(){if(r.log("updateNavButtons() called"),null!=s.pagination.current){if(!s.pagination.ready)return s.source_next_disabled=!1,void(s.source_back_disabled=!1);s.source_next_disabled=s.pagination.total_pages===s.pagination.current,s.source_back_disabled=1===s.pagination.current}},s.setNextMatchesButtons=function(){var e=i();s.isExistMatchesForward=!!e;var t=o();s.isExistMatchesBackward=!!t},s.isExistMatchesBackward=!1,s.isExistMatchesForward=!1,s.$on("updateNavigationButtons",function(){s.updateNavButtons()}),s.updateNavButtons();var u={noMatch:0,related:3,similar:2,identical:1};function d(e){var t=a.instance;if(t&&s.pagination.ready&&e){r.log("cpPagination: highlightByPage");var n=[];e=underscore.filter(e,function(e){return e.is_active&&0==e.status}),e=underscore.sortBy(e,"matchedWords").reverse();for(var o=s.pagination.total_pages,i=0;i<o;++i)n[i]=u.noMatch,t.showIdentical&&p(n,e,"identical",u.identical,i),n[i]==u.noMatch&&(t.showSimilar&&p(n,e,"similar",u.similar,i),n[i]==u.noMatch&&t.showRelated&&p(n,e,"relatedMeaning",u.related,i));c.s=angular.merge({},n),s.setNextMatchesButtons()}}function p(e,t,n,o,i){var s;for(s=0;s<t.length;s++){t[s].splitMatchesText&&t[s].splitMatchesText[n]&&t[s].splitMatchesText[n][i]&&t[s].splitMatchesText[n][i].groupId&&0<t[s].splitMatchesText[n][i].groupId.length&&(e[i]=o);break}}s.control.recomputePageColors=underscore.debounce(function(e){r.log("cpPagination: recomputePageColors"),s.$apply(function(){d(e)})},1e3),s.initialSources&&d(s.initialSources)}t.$inject=["$scope","logService","settingsService","$window","utilitiesService"],e.directive("cpPagination2",function(){return{restrict:"E",scope:{pagination:"=",onChanged:"&",control:"=",initialSources:"=?"},template:'<div class="pagination2"><div class="pagination-back"><md-button class="md-icon-button hide-when-really-small" aria-label="First page" ng-click="findMatchBackwards()" ng-disabled="!isExistMatchesBackward"><md-icon md-font-icon="link">first_page</md-icon><md-tooltip md-direction="top">Go to previous page with matches</md-tooltip></md-button><md-button class="md-icon-button" aria-label="More" ng-click="source_back()" ng-disabled="source_back_disabled"><md-icon md-font-icon="link">navigate_before</md-icon></md-button></div><div class="pagination-center"><md-input-container><input type="number" ng-model="pagination.current" ng-change="page_changed()" ng-model-options="{ updateOn: \'blur\'}" min="1" max="{{pagination.total_pages}}" update-on-enter class="text-center" aria-label="current page"></md-input-container><span>of &nbsp;&nbsp;{{pagination.total_pages}}</span></div><div class="pagination-forward"><md-button class="md-icon-button" aria-label="First page" ng-click="source_next()" ng-disabled="source_next_disabled"><md-icon md-font-icon="link">navigate_next</md-icon></md-button><md-button class="md-icon-button hide-when-really-small" aria-label="More" ng-click="findMatchForwards()" ng-disabled="!isExistMatchesForward"><md-icon md-font-icon="link">last_page</md-icon><md-tooltip md-direction="top">Go to next page with matches</md-tooltip></md-button></div></div>',controller:t,link:function(n,e,t){n.$watch("pagination.current",function(e,t){e!=t&&void 0!==e&&(n.savedCurrent=e,n.updateNavButtons())},!0)}}}),e.directive("updateOnEnter",function(){return{restrict:"A",require:"ngModel",link:function(t,e,n,o){e.bind("keyup",function(e){13==e.keyCode&&(o.$commitViewValue(),t.$apply(function(){o&&o.$setTouched()}))})}}})}function m(e){e.directive("cpReportInfo",[function(){return{restrict:"E",template:'<div layout="row" class="report-info contributing-to-height-report-info" ng-hide="hideReportInfo"><a ng-click="raiseIconClick()"><div class="report-type-image"><img ng-src="{{reportDataService.reportIcon}}"></div></a><div class="scan-title" flex layout="column"><h1 class="ellipsis-text" ng-cloak flex>{{reportDataService.reportTitle}}</h1><div class="compare-image-height-filler" ng-if="reportDataService.isErrored"></div><div class="scan-metadata" ng-if="reportDataService.scannedDocumentMeta && reportDataService.scannedDocumentMeta.creationTime && !reportDataService.isErrored"><time ng-if="isRequestTimeInTheFuture()">a few seconds ago</time><time ng-if="!isRequestTimeInTheFuture()" am-time-ago="reportDataService.scannedDocumentMeta.creationTime | amUtc | amLocal"></time></div></div><div class="suspected-info-border" ng-hide="hideStatistics" ng-if="!reportDataService.isErrored"><cp-statistics control="statisticsControl" ng-if="reportDataService.showStatisticControls"></cp-statistics></div><div class="suspected-info" ng-if="!reportDataService.isErrored && reportDataService.showShareButton" ng-class="{\'hidden-when-burger\': reportDataService.type== reportDataService.reportTypes.singleSuspect, \'hidden-xs\': reportDataService.type== reportDataService.reportTypes.multipleSuspects}"><a href="#"><div class="btn-share-report" ng-if="!reportDataService.isErrored" ng-click="showShareModal()"><div class="text-center"><md-icon md-font-icon="link">share</md-icon><span class="text hidden-xs">Share</span></div></div></a></div></div>',controller:["$scope","reportServiceMediator",function(e,t){e.hideReportInfo=window.hideTitleSectionCompletely,e.raiseIconClick=function(){t.iconButtonClicked()}}]}}])}function h(e){e.directive("cpOnResize",["$rootScope","$timeout",function(o,i){return{restrict:"A",link:function(t,n,e){"undefined"!=typeof ResizeSensor&&i(function(){var e=new ResizeSensor(n[0],function(){i(function(){o.$broadcast("on-element-resized")})});t.$on("$destroy",function(){e.detach()})},500)}}}])}function f(e){e.directive("report",[function(){return{restrict:"E",scope:{},template:'<div class="report-container container parent-height full-width" cp-education-report-top-area ng-class="{\'one-to-one\' : showOneToOne, \'parent-height-desktop\': parentHeight, \'html-report\': contentTypeService.contentType.isHtml()}"><cp-report-info></cp-report-info><cp-scan-progress></cp-scan-progress><div layout="row" class="contributing-to-height-error error-container" ng-if="reportDataService.isErrored" ng-cloak><div flex><div class="bs-callout bs-callout-warning"><h4 class="normal-font-weight">Scanning Problem</h4><p>{{reportDataService.ErrorMessage}}</p></div></div></div><div layout="row" class="cp-affix-parent contributing-to-height-scan-properties" ng-if="!reportDataService.isErrored"><div flex="100" hide-xs ng-hide="hide"><cp-scan-properties control="scanPropertiesControl"></cp-scan-properties></div></div><div class="parent-height"><div class="almost-parent-height-one-to-one" ng-class="{\'margin-top-20\' : hidePropertiesSectionCompletely}" ng-if="showOneToOne"><cp-one-to-one-report></cp-one-to-one-report></div><div class="parent-height" ng-class="{\'margin-top-20\' : hidePropertiesSectionCompletely}" ng-if="!showOneToOne"><multi-suspect-report></multi-suspect-report></div></div></div>',controller:"reportController"}}])}function v(e){e.directive("cpScanProgress",[function(){return{restrict:"E",template:'<md-card ng-if="reportDataService.scanProgressPercents < 100 && !reportDataService.isErrored" ng-cloak layout="row" class="contributing-to-height-scan-progress scan-progress"><div flex="100"><div class="panel panel panel-progress"><div class="panel-heading"><i class="material-icons" ng-show="panelVisible">hourglass_empty</i> Scanning Status</div><div class="panel-body"><md-progress-linear md-mode="determinate" value="{{reportDataService.scanProgressPercents}}"></md-progress-linear><div class="text"><div ng-if="reportDataService.scanProgressPercents <= 5">Analyzing your content...</div><div ng-if="reportDataService.scanProgressPercents > 5 && reportDataService.scanProgressPercents <= 30">Searching more than 30 billion pages online to find matches...</div><div ng-if="reportDataService.scanProgressPercents > 30 && reportDataService.scanProgressPercents < 95">Comparing your text...</div><div ng-if="reportDataService.scanProgressPercents >= 95 && !calculatingScores">Final touches</div><div ng-if="reportDataService.scanProgressPercents >= 95 && calculatingScores">Calculating score...</div></div></div></div></div></md-card>'}}])}function S(e){function t(t,e,n,o,i,s){t.hide=window.hidePropertiesSectionCompletely,t.reportDataService=i,t.graphControl={},t.graphLegendControl={},t.panelVisible=!0,t.togglePanel=function(){$("#scan-properties").slideToggle(),t.panelVisible=!t.panelVisible},t.control.statistics&&(t.graphControl.statistics=t.control.statistics,t.graphLegendControl.statistics=t.control.statistics),t.control.showStatistics=function(e){t.graphControl.statistics=e,t.graphLegendControl.statistics=e,t.graphControl.showStatistics&&t.graphControl.showStatistics(e),t.graphLegendControl.showStatistics&&t.graphLegendControl.showStatistics(e)},t.control.showEmpty=function(e){s.setControlToNoResultsState(t.graphControl,e),s.setControlToNoResultsState(t.graphLegendControl,e)},t.control.isEmpty&&t.control.showEmpty(t.control.emptyResults)}t.$inject=["$scope","settingsService","logService","$element","reportDataService","utilitiesService"],e.directive("cpScanProperties",[function(){return{restrict:"E",scope:{control:"="},template:'<md-card><div class="panel panel-properties" ng-class="{\'when-status-is-shown\': reportDataService.scanProgressPercents < 100 }"><md-button ng-click="togglePanel()"><span>Scan Properties</span> <i class="material-icons" ng-show="panelVisible">expand_less</i> <i class="material-icons" ng-show="!panelVisible">expand_more</i></md-button><div id="scan-properties" class="in top-border"><div layout="row" layout-fill><div flex-gt-md="67" flex-md="58" flex-xs="42" flex><div class="panel-body"><div>Words in Document: {{reportDataService.scanned_document.metadata.words | number }}</div><div><span ng-if="reportDataService.excludedRangeCount > 0">Omitted Words: {{reportDataService.excludedRangeCount | number}}</span></div><div ng-if="reportDataService.type== reportDataService.reportTypes.multipleSuspects && reportDataService.sourceCount > 0">Results Found: {{reportDataService.sourceCount | number }}</div></div></div><div flex-gt-md="11" flex-md="21" flex-xs="27"><cp-graph control="graphControl"></cp-graph></div><div flex-gt-md="22" flex-md="21" flex-xs="27"><cp-graph-legend control="graphLegendControl"></cp-graph-legend></div></div></div></div></md-card>',controller:t}}])}function w(e){function t(r,n,a,o,t,i,s,e,c,l,u){r.settings=a.instance,r.MODE_NORMAL=0,r.MODE_LOCKED=1,r.mode=r.MODE_NORMAL,r.sourcesToShow=[],r.numOfSources=0,r.totalSources=0,function(){function e(){var e=$(".actual-results");e.stop(),e.animate({height:"100%",top:0,bottom:"auto"},300,function(){o(function(){r.sourcesVisible=!0,e.css("overflow","auto")})})}$(window).scroll(function(){768<=$(window).width()||r.sourcesVisible||o(function(){r.hideSources()})}),$(window).resize(function(){r.isMobile=$(window).width()<768,768<=$(window).width()?r.sourcesVisible||e():r.sourcesVisible||o(function(){r.hideSources()})}),r.toggleSourcesVisibility=function(e){768<=$(window).width()||(e.stopPropagation(),r.sourcesVisible?r.hideSources():r.showSources())},r.hideSources=function(){if(!(768<=$(window).width())){var e=$("#sources-panel-heading").outerHeight(),t=$(".actual-results");t.stop(),t.css("overflow","hidden"),r.sourcesVisible?t.animate({top:window.innerHeight},300,function(){o(function(){t.height(e),t.css("bottom",0),t.css("top","auto"),r.sourcesVisible=!1})}):(t.height(e),t.css("top","auto"),t.animate({bottom:0},300,function(){o(function(){r.sourcesVisible=!1})})),n.clearObject(r.lockedSources),r.mode=r.MODE_NORMAL,r.refreshSources()}},r.showSources=function(){768<=$(window).width()||e()},r.control.show=r.showSources,r.isMobile=$(window).width()<768,o(r.hideSources,2e3)}(),r.update_source_status=function(){r.selectionChanged({})},r.refreshSources=function(){if(i.log("cpSources: refreshSources"),r.totalSources=Object.keys(r.sources).length,r.lockedSources&&0<Object.keys(r.lockedSources).length){var e=[];for(var t in r.sources)t in r.lockedSources&&e.push(r.sources[t]);r.numOfSources=e.length,r.mode=r.MODE_LOCKED,r.sourcesToShow=e}else if(r.pagination){var n=function(){var e,t=[],n=r.pagination.current-1,o=!1,i=a.getMaxSourcesWithMatches(r.sources);if(0<i.length)if(a.instance.showPageSources){for(var s in i)(e=i[s]).hasOwnProperty("matches")||(o=!0),0===e.status&&e.hasOwnProperty("matches")&&(e.matches.identical&&e.matches.identical[n]&&0<e.matches.identical[n].length?t.push(e):e.matches.similar&&e.matches.similar[n]&&0<e.matches.similar[n].length?t.push(e):e.matches.relatedMeaning&&e.matches.relatedMeaning[n]&&0<e.matches.relatedMeaning[n].length&&t.push(e));r.isPageEmpty=0==t.length&&!o}else for(var s in i)e=i[s],t.push(e);return t}();r.numOfSources=n.length,r.mode=r.MODE_NORMAL,r.sourcesToShow=n}else r.numOfSources=Object.keys(r.sources).length,r.sourcesToShow=underscore.map(r.sources,function(e){return e})},r.goToSingleSuspectReport=function(e){s.resultId=e.id,l.$broadcast("switchToSingleSuspectReport",{suspectId:e.id})},r.changeVisibilityAndUpdateIfEnter=function(e,t){13===e.keyCode&&r.changeVisibilityAndUpdate(t)},r.changeVisibilityAndUpdate=function(e){r.changeSourceVisibilityStatus(e),r.update_source_status()},r.changeSourceVisibilityStatus=function(e){e.is_active=!e.is_active},r.exitLockedModeIfNotInMobile=function(e){r.exitLockedMode(e)},r.exitLockedMode=function(e){$(".selected-match").removeClass("selected-match"),e.stopPropagation(),n.clearObject(r.lockedSources),r.mode=r.MODE_NORMAL,r.refreshSources()},r.showSettings=function(e){e.stopPropagation(),u.show()},r.showFilter=function(e){e.stopPropagation(),t.show()},r.control.refresh=n.throttleWithGuaranteedLastRun(function(){null!=r.sources&&r.refreshSources()},1e3),r.control.showEmpty=function(){r.isEmpty=!0},r.reportDataService=s}t.$inject=["$scope","utilitiesService","settingsService","$timeout","filterDialogService","logService","reportDataService","contentTypeService","DataService","$rootScope","settingsDialogService"],y(e),e.directive("cpSources",["logService",function(o){return{restrict:"E",scope:{sources:"=",selectionChanged:"&",lockedSources:"=",pagination:"=",control:"="},template:'<div id="sources" class="panel panel-default panel-sources actual-results-height"><div class="panel-heading" id="sources-panel-heading" ng-click="toggleSourcesVisibility($event)" layout="row"><span class="visible-xs-inline" id="sources-visibility-toggle" ng-click="toggleSourcesVisibility($event)" ng-class="{\'up-arrow\': !sourcesVisible, \'down-arrow\': sourcesVisible}"></span> <span flex ng-show="mode === MODE_NORMAL" class="mode-normal">Results</span> <span flex ng-show="mode === MODE_LOCKED" class="mode-locked" ng-click="exitLockedMode($event);" ng-if="!isMobile">Results ({{numOfSources}} of {{totalSources}})</span> <span ng-show="mode === MODE_LOCKED" ng-if="isMobile">Results ({{numOfSources}} of {{totalSources}})</span><div><span><img src="/images/compare-education/filter_list/white@3x.svg" class="pointer" ng-click="showFilter($event)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Filter Results</md-tooltip></span> <span><img src="/images/compare-education/settings/white@3x.svg" class="pointer" ng-click="showSettings($event)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Settings</md-tooltip></span></div></div><div class="panel-body"><div ng-if="isEmpty"><div class="no-results-div text-center"><img src="/images/compare-education/PilgarFree05.png" height="180"><div class="no-results-text">Plagiarism Free</div></div></div><div ng-if="!isEmpty && isPageEmpty"><div class="no-results-div text-center"><img src="/images/compare-education/PilgarFreeOne Page.png" height="180"><div class="no-results-text">This Page Is Plagiarism Free</div></div></div><md-card class="source-card" md-theme="default" md-theme-watch ng-repeat="source in sourcesToShow | orderBy:\'-matchedWords\' track by $index" ng-class="{\'unchecked-source\': !source.is_active}"><md-card-title><md-card-title-text><div class="md-headline" layout="row"><div flex><div ng-show="source.status"><md-tooltip md-direction="bottom" md-delay="500">Loading matches...</md-tooltip><md-progress-circular md-mode="indeterminate" md-diameter="25px"></md-progress-circular></div><a class="title" ng-class="{\'rtl-mode\': settings.ui.rtlMode}" ng-click="goToSingleSuspectReport(source)" ng-if="!source.singleSuspectLink">{{ source.title }}</a> <a class="title" ng-class="{\'rtl-mode\': settings.ui.rtlMode}" ng-href="{{source.singleSuspectLink}}" ng-if="source.singleSuspectLink">{{ source.title }}</a></div><md-button class="md-icon-button visibility-toggle-wrapper" ng-class="{\'pull-left\': settings.ui.rtlMode}" aria-label="Toggle source visibility" ng-click="changeVisibilityAndUpdate(source)" ng-keypress="changeVisibilityAndUpdateIfEnter($event,source)"><md-icon ng-if="source.is_active" md-svg-icon="/images/compare-education/visibility/googblue@3x.svg"></md-icon><md-icon ng-if="!source.is_active" md-svg-icon="/images/compare-education/visibility_off/grey600@3x.svg"></md-icon><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500"><span ng-show="source.is_active">Hide</span> <span ng-show="!source.is_active">Show</span></md-tooltip></md-button></div></md-card-title-text></md-card-title><md-card-content><span class="md-subhead block-with-text" ng-class="{\'rtl-mode\': settings.ui.rtlMode}">{{ source.introduction }}</span><div class="source-url"><a ng-show="source.url.startsWith(\'http\')" href="{{source.url}}" target="_blank">{{ source.url | removeProtocol}}<md-tooltip md-direction="left" md-delay="300">{{ source.url }}</md-tooltip></a> <span ng-show="!source.url.startsWith(\'http\')">{{source.url}}<md-tooltip md-direction="left" md-delay="300">{{ source.url }}</md-tooltip></span></div><div class="source-stat" ng-show="source.status === 0"><hr><span class="percent" ng-class="{\'low\': source.totalMatchedPercents<= 20 , \'medium\': source.totalMatchedPercents<= 60 && source.totalMatchedPercents>=21, \'high\': source.totalMatchedPercents> 60}"><span>{{ source.matchedWords | prettyNumberWithK }}<md-tooltip ng-if="source.matchedWords > 999" class="multiline" md-direction="bottom" md-delay="500">{{ source.matchedWords | prettyNumber }}</md-tooltip></span> similar words ({{source.totalMatchedPercents}}%)</span><div class="pull-right"><md-tooltip class="multiline" md-delay="500" md-direction="left"><div ng-show="source.matches.statistics.identical> 0"><span class="identical-color">Identical {{ source.matches.statistics.identical}} words</span> <span ng-show="!settings.showIdentical">(disabled)</span></div><div ng-show="source.matches.statistics.minorChanges> 0"><span class="similar-color">Minor Changes {{ source.matches.statistics.minorChanges}} words</span> <span ng-show="!settings.showSimilar">(disabled)</span></div><div ng-show="source.matches.statistics.relatedMeaning> 0"><span class="related-color">Related Meaning {{ source.matches.statistics.relatedMeaning }} words</span> <span ng-show="!settings.showRelated">(disabled)</span></div></md-tooltip><div ng-show="source.matches.statistics.identical > 0" ng-class="settings.showIdentical ? \'identical-on\' : \'identical-off\'"></div><div ng-show="source.matches.statistics.minorChanges > 0" ng-class="settings.showSimilar ? \'similar-on\' : \'similar-off\'"></div><div ng-show="source.matches.statistics.relatedMeaning> 0" ng-class="settings.showRelated ? \'related-on\' : \'related-off\'"></div></div></div></md-card-content></md-card></div></div>',controller:t,link:function(n,e,t){n.$watchCollection("sources",function(e,t){o.log("sources changed."),e!==t&&n.refreshSources()}),n.$watch("lockedSources",function(e,t){o.log("lockedSources changed."),e!==t&&n.refreshSources()},!0)}}}])}function y(e){e.directive("ngBindHtmlCompile",["$compile","$parse",function(i,s){return{link:function(t,n,o){var e=s(o.ngBindHtmlCompile);t.$watch(function(){return(e(t)||"").toString()},function(e){n.html(e),o.compileTags?i(n[0].querySelectorAll(o.compileTags))(t):i(n,null,-9999)(t)})}}}]),e.filter("unsafe",["$sce",function(e){return e.trustAsHtml}])}function b(e){e.filter("removeProtocol",function(){return function(e){return e&&e.replace(/(^\w+:|^)\/\//,"")}}).filter("prettyNumberWithK",function(){return function(e){return 1e3<e?parseInt(e/1e3).toLocaleString("en")+"k":e}}).filter("prettyNumber",function(){return function(e){return 1e3<=e?e.toLocaleString("en"):e}})}function x(e){e.service("contentTypeService",[function(){var t={types:{html:"html",text:"text"},contentTypes:{html:"text/html",text:"text/plain"}};t.contentTypesConverter={"text/html":t.types.html,"text/plain":t.types.text};var n="html";function o(e){return n}function e(e){this.propertyName=e}return t.defaultContentType="text/html, text/plain",t.isHtmlContentType=function(e){return e==t.contentTypes.html},t.isTextContentType=function(e){return e==t.contentTypes.text},t.getTypeFromContentType=function(e){return t.contentTypesConverter[e]},e.prototype={init:function(e){this.set(e)},setToText:function(){this.set(t.types.text)},setToHtml:function(){this.set(t.types.html)},getOther:function(){return this.isText()?t.types.html:t.types.text},isText:function(){return this.get()==t.types.text},isHtml:function(){return this.get()==t.types.html},isHtmlOrDefault:function(){var e=this.get();return e==t.types.html||!e},set:function(e){var t;t=e,this.propertyName,n=t},get:function(){return o(this.propertyName)},getOrDefault:function(){var e=o(this.propertyName);return e||t.types.html},hasValue:function(){return!!o(this.propertyName)},switch:function(){this.isHtmlOrDefault()?this.setToText():this.setToHtml()}},t.contentType=new e("mode"),t.getOtherType=function(e){return t.isHtmlContentType(e)?t.contentTypes.html:t.contentTypes.text},t.isHtmlContentType=function(e){return e==t.contentTypes.html},t.isTextContentType=function(e){return e==t.contentTypes.text},t}])}function T(e){e.service("DataService",["$http","logService","reportDataService","contentTypeService",function(e,t,n,o){this.eSourceStatus=Object.freeze({completed:0,reportDownloaded:1,readyToSplit:2,readyToFullText:3,switchingType:4}),this.splitTextDocument=function(e){if(!e.pages)return null;var t=new B;e.splitValue=t.splitText(e.value,e.pages.startPosition)}}])}function k(e){e.service("educationReportService",["settingsService","DataService","$q","$interval","logService","$timeout","$window","reportDataService","utilitiesService","contentTypeService",function(e,t,n,o,i,s,r,a,c,l){return{}}])}function C(e){var t=[];if(3==e.nodeType)t.push(e);else for(var n=e.childNodes,o=0,i=n.length;o<i;++o)t.push.apply(t,C(n[o]));return t}function M(e,t,n){if(document.createRange&&window.getSelection){var o=document.createRange();o.selectNodeContents(e);for(var i,s,r=C(e),a=!1,c=0,l=0;s=r[l++];){if(i=c+s.length,!a&&c<=t&&(t<i||t==i&&l<=r.length)&&(o.setStart(s,t-c),a=!0),a&&n<=i){o.setEnd(s,n-c);break}c=i}var u=window.getSelection();u.removeAllRanges(),u.addRange(o)}else if(document.selection&&document.body.createTextRange){var d=document.body.createTextRange();d.moveToElementText(e),d.collapse(!0),d.moveEnd("character",n),d.moveStart("character",t),d.select()}}function P(e){var t,n=window.getSelection();n.rangeCount&&n.getRangeAt&&(t=n.getRangeAt(0)),document.designMode="on",t&&(n.removeAllRanges(),n.addRange(t)),document.execCommand("HiliteColor",!1,e)||document.execCommand("BackColor",!1,e),document.designMode="off"}function R(t){if(window.getSelection)try{document.execCommand("BackColor",!1,t)||P(t)}catch(e){P(t)}else document.selection&&document.selection.createRange&&document.selection.createRange().execCommand("BackColor",!1,t)}function D(e,t,n,o){M(document.getElementById(e),t,n),R(o)}function O(e){e.service("iframeService",["pageService",function(r){var e={getIframeText:function(e){var t=document.createElement("html");try{t.innerHTML=e}catch(e){}t.getElementsByTagName("body")[0].classList.add("identical-on","similar-on","related-on");var n=t.getElementsByTagName("head")[0],o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=window.location.origin+"/css/copyleaks/compare_education_iframe_report.css",n.appendChild(o);var i=document.createElement("script");i.type="text/javascript";var s=document.createTextNode("var cpyc = "+function(e,t){var n={rangeIds:e,type:"copyleaksMatchClicked",pageType:t};window.removeCss();var o=JSON.stringify(n);parent.postMessage(o,"*");var i="."+e.join("."),s=window.copyleaksSelectedStyle=document.createElement("style");s.type="text/css";var r=e[0].substr(0,1),a=window.getColorForMatchType(r);s.innerHTML=i+"{border-bottom: 2px solid "+a+"}",document.getElementsByTagName("head")[0].appendChild(s)}.toString()+";var listenToMatchScrollRequest = "+function(){window.addEventListener("message",function(e){if(!e||!e.data)return;var t=null;try{t=JSON.parse(e.data)}catch(e){return}if("copyleaksMatchScrollRequest"!==t.type)return;var n=t.matchId,o=document.getElementsByClassName(n)[0],i=o.getBoundingClientRect(),s=i.top+window.scrollY;s<0&&(s=0);var r=i.left;window.removeCss();var a=n[0].substr(0,1),c=window.getColorForMatchType(a),l=window.copyleaksSelectedStyle=document.createElement("style");function u(){for(var e=document.getElementsByTagName("meta"),t=0;t<e.length;t++)if("generator"==e[t].getAttribute("name")&&"pdf2htmlEX"==e[t].getAttribute("content"))return!0;return!1}function d(e,t){for(;(e=e.parentElement)&&!(e.matches||e.matchesSelector).call(e,t););return e}if(l.type="text/css",l.innerHTML="."+n+"{border-bottom: 2px solid "+c+"}",document.getElementsByTagName("head")[0].appendChild(l),u()){var p=d(o,"[data-page-no]"),g=(window.testElement=p).getBoundingClientRect(),m=g.top,h=document.getElementById("page-container");h.scrollTop=h.scrollTop+m,setTimeout(function(){var e=o.getBoundingClientRect();h.scrollTop=h.scrollTop+e.top,h.scrollLeft=e.left},100)}else window.scrollTo(r,s)},!1)}.toString()+";var removeCss = "+function(){window.copyleaksSelectedStyle&&(window.copyleaksSelectedStyle.remove(),window.copyleaksSelectedStyle=null)}.toString()+";var getColorForMatchType= "+r.getColorForMatchType+";listenToMatchScrollRequest();");return i.appendChild(s),n.appendChild(i),e=t.outerHTML}};return String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},e}])}function E(e){e.service("logService",function(){this.debug=!1,this.printStack=!1,this.log=function(e){this.debug&&(this.printStack&&(new Error).stack.substr(5))}})}function I(e){e.service("oneToOneReportService",["settingsService","DataService","$q","$interval","logService","$timeout","sourcesService","$window","reportDataService","pageService","$rootScope","contentTypeService",function(e,o,t,n,i,s,r,a,c,l,u,d){var p={};function g(e){return c[e]}function m(e){return e+"_suspect"}function h(e){return e+"_source"}return p.setSuspect=function(e){var t=m(c.resultId);c[t]=e},p.getSuspect=function(){return g(m(c.resultId))},p.setSource=function(e){var t=h(c.resultId);c[t]=e},p.getSource=function(){return g(h(c.resultId))},p.requestToScannedProcessSent=!1,p.resultSuccess=function(e){var t=p.getSource();if(null!=t){t.matches=e,t.text=e.text;var n=angular.merge({},t);n.splitMatchesText=l.splitMatchesToPages(n.matches.text.comparison,n.matches.text.pages.startPosition,"suspectToSource"),n.splitMatchesHtml=l.splitMatchesToPages(n.matches.html.comparison,[0],"suspectToSource"),n.status=o.eSourceStatus.completed,p.setSuspect(n),c.scanned_document&&c.scanned_document.text&&(t.splitMatchesText=l.splitMatchesToPages(t.matches.text.comparison,c.scanned_document.text.pages.startPosition,"sourceToSuspect"),t.splitMatchesHtml=l.splitMatchesToPages(t.matches.html.comparison,[0],"sourceToSuspect"),t.status=o.eSourceStatus.completed)}else p.match=e},p}])}function N(e){e.service("pageService",["settingsService","DataService","reportDataService","contentTypeService",function(g,m,f,o){var e={updateCurrentPageMatches:function(e,t,n,o){var i,s,r={identical:[],similar:[],relatedMeaning:[],excluded:[]},a=g.instance,c=g.getMaxSourcesWithMatches(e),l="html"==o?"splitMatchesHtml":"splitMatchesText";for(var u in c)if((i=c[u]).is_active&&i.status==m.eSourceStatus.completed&&i[l]){if(a.showIdentical&&i[l].identical){s=i[l].identical[t].groupId.length;for(var d=i[l].identical[t],p=0;p<s;++p)r.identical.push({id:i.id,start:d.starts[p],length:d.lengths[p],gid:d.groupId[p]})}if(a.showSimilar&&i[l].similar){s=i[l].similar[t].groupId.length;for(var d=i[l].similar[t],p=0;p<s;++p)r.similar.push({id:i.id,start:d.starts[p],length:d.lengths[p],gid:d.groupId[p]})}if(a.showRelated&&i[l].relatedMeaning){s=i[l].relatedMeaning[t].groupId.length;for(var d=i[l].relatedMeaning[t],p=0;p<s;++p)r.relatedMeaning.push({id:i.id,start:d.starts[p],length:d.lengths[p],gid:d.groupId[p]})}}if(n&&0<n.length)for(var p=0;p<n[t].length;++p)r.excluded.push({id:-1,match:n[t][p]});return r},highlightText:function(e){if(!e.text)return"";var t=e.text,n=e.text.length,o=e.matches,i=e.sources,s=e.mapType,r=e.reportType,a=e.disableTooltip,c=e.pageType;if(!o||0==o.length)return[];o.excluded=underscore.sortBy(o.excluded,function(e){return e.match.SoE});var l=function(e,t,n){var o=0,i=e;if("sourceToSuspect"==n)"SoS","SoE","SuS","SuE";else{if("suspectToSource"!=n)throw new Error("unsupported mapping type");"SuS","SuE","SoS","SoE"}var s=[];for(c=o;c<i;++c)s.push([]);var r,a=null;h(s,t.identical,"i",1),h(s,t.similar,"s",2),h(s,t.relatedMeaning,"r",3);for(var c=0;c<t.excluded.length;++c){a=t.excluded[c].match,"s_"+a.id+"_"+a.gid;for(var o=a.start,i=o+a.length,l=o;l<i;++l)s[l].push({matchType:4,id:-1})}for(var c=0;c<s.length;++c)0!==(r=y(s[c]))&&(s[c]=s[c].filter(function(e){return e.matchType===r}));for(var u=[{matchType:-1,SoS:-1,SoE:-1,ids:[]}],d={},c=o;c<i;++c)if(0!==s[c].length){var p=u[u.length-1];if(s[c].length===p.ids.length&&s[c][0].matchType==p.matchType&&p.SoE==c&&w(s[c],d[p.SoS]))p.SoE+=1;else{u.push({matchType:s[c][0].matchType,SoS:c,SoE:c+1,ids:[]}),d[c]={},p=u[u.length-1];for(var g=0;g<s[c].length;++g){var m=s[c][g].id;p.ids.push(m),d[c][m]=!0}}}return u.shift(),u}(n,o,s);return 0==l.length?t:(function(e){for(var t=0;t<e.length;++t)e[t].ids=underscore.uniq(e[t].ids)}(l=function(e){var t=[];0<e.length&&t.push(e[0]);for(var n=1;n<e.length;++n){var o=e[n-1],i=e[n],s=t[t.length-1];o.matchType===i.matchType&&d(o.ids,i.ids)?o.SoE===i.SoS?(s.SoE!==i.SoS&&t.push(o),s.SoE=i.SoE):o.SoE>i.SoS&&o.SoE<i.SoE?s.SoE=i.SoE:t.push(i):t.push(i)}return t}(l)),u=l,l=u=u.sort(function(e,t){return parseFloat(t.SoS)-parseFloat(e.SoS)}),t=function(e,t,n,o,i,s,r){for(var a,c=null,l=e.length-1,u=[],d=0;d<t.length;++d){if(a=t[d],l>=a.SoE&&u.unshift(e.substr(a.SoE,l-a.SoE+1)),4==a.matchType){c="",s||(c='<md-tooltip md-direction="top" md-delay="1000">References are omitted according to your settings</md-tooltip>');var p=e.substr(a.SoS,a.SoE-a.SoS);u.unshift('<span class="highlight-4">'+c+p+"</span>")}else{c="",s||(c=S(a.ids,n,i));var p=e.substr(a.SoS,a.SoE-a.SoS),g="<span"+(m=a.matchType,h=a.ids,' class="highlight-'+m+" "+h.join(" ")+'"')+v(r,a.ids)+">"+c;u.unshift(g+p+"</span>")}l=a.SoS-1}var m,h;return 0!=l&&u.unshift(e.substr(0,l+1)),u.join("")}(t,l,i,0,r,a,c));var u},splitMatchesToPages:function(e,t,n){if(!t||null===t)throw"pageRanges cannot be null";var o=new B;return e={identical:o.splitMatch(e.identical,t,n),similar:o.splitMatch(e.minorChanges,t,n),relatedMeaning:o.splitMatch(e.relatedMeaning,t,n)}},getColorForMatchType:t,getColorForClassName:function(e){return t(e[0].substr(0,1))}};function v(e,t){var n=function(e){for(var t="[",n=0;n<e.length;++n)t+="'"+e[n]+"',";return t=t.slice(0,-1),t+="]"}(t);return o.contentType.isHtml()?(e||(e="test"),' onclick="cpyc('+n+", '"+e+"');\""):' ng-click="clicked($event, '+n+');"'}function S(e,t,n){return"1to1"!=n?'<md-tooltip class="multiline" md-direction="top" md-delay="1000">'+function(e,t){{if(1==e.length&&-1==e[0])return"<b>Ignored by request</b>";for(var n={},o={},i=0;i<e.length;++i){var s=f.getSourceIdFromMatchId(e[i]),r=t[s],a=r.url;if(null!=a){var c=a.replace("http://","").replace("https://","").split(/[/?#]/)[0];n.hasOwnProperty(c)?n[c]++:n[c]=1}else o.hasOwnProperty(r.title)?o[r.title]++:o[r.title]=1}for(var l,u,d,p=Object.keys(n),i=0;i<p.length;++i){for(a=p[i],l=n[a],u=a,d=null;;){var g=u.indexOf(".");if(g<0)break;u=u.substr(g+1),n.hasOwnProperty(u)&&(d=u)}null!=d&&(delete n[a],n[d]=n[d]+l)}for(var m="<b>Results came from:</b>",h=Object.keys(n),i=0;i<h.length&&i<7;++i)m+="<BR>"+h[i]+": "+n[h[i]];if(i<7)for(h=Object.keys(o);i<h.length&&i<7;++i)m+="<BR>"+h[i]+": "+o[h[i]];return m}}(e,t)+"</md-tooltip>":""}function h(e,t,n,o){for(var i=0;i<t.length;++i){match=t[i],uniqueId=n+"_"+match.id+"_"+match.gid;for(var s=match.start,r=s+match.length,a=s;a<r;++a)e[a].push({matchType:o,id:uniqueId})}}function w(e,t){for(var n=0;n<e.length;++n)if(!t.hasOwnProperty(e[n].id))return!1;return!0}function d(e,t){if(e.length!==t.length)return!1;for(var n=e.length;n--;)if(e[n]!==t[n])return!1;return!0}function y(e){return 0==e.length?0:e[0].matchType}function t(e){switch(e){case"i":return"rgba(255, 102, 102, 0.9)";case"s":return"rgba(255, 154, 154, 0.9)";case"r":return"rgba(255, 217, 176, 0.9)"}}return String.prototype.splice=function(e,t){return this.slice(0,e)+t+this.slice(e)},e}])}function B(){}function F(e){this.data=e,this.next=null}function L(){this.head=null}function j(e){e.service("reportDataService",["contentTypeService",function(e){var t={};function n(){t.sources={},t.scanProgressPercents=100,t.excludedRangesPerPage=null,t.excludedRangeCount=0}return t.showStatisticControls=!0,t.working=!0,n(),t.reportTypes={multipleSuspects:1,singleSuspect:2},t.pageTypes={source:"source",suspect:"suspect"},t.resultType={batch:0,internet:1,database:2},t.splitExcludedRanges=function(){var e=new B;this.excludedTextRangesPerPage=e.splitExcluded(this.scanned_document.text.exclude,this.scanned_document.text.pages.startPosition),this.excludedHtmlRangesPerPage=e.splitExcluded(this.scanned_document.html.exclude,[0])},t.setError=function(e){t.isErrored=!0,t.ErrorMessage=e},t.getSourceIdFromMatchId=function(e){var t=e.substr(2);return t=t.substr(0,t.lastIndexOf("_"))},t.clearSourcesMatch=function(){underscore.each(t.sources,function(e){delete e.matches,delete e.matchesBeforeSplit})},t.clear=function(){delete t.isErrored,delete t.noMatches,delete t.excludedRangesPerPage,delete t.scanProgressPercents,n(),delete t.sourceType,delete t.sourceTitle,delete t.sourceCount,delete t.resultTitle,delete t.scannedDocumentMeta,delete t.reportTitle,delete t.reportIcon},t}])}function A(e){e.service("reportServiceMediator",["$q",function(e){var t={iconButtonClicked:function(){o("icon-button-clicked",{})},switchReportContentType:function(e){o("content-type-changed",{contentType:e})},changeMultiSuspectPage:function(e){o("multiple-suspect-page-change",{pageNumber:e})},changeSingleSuspectSourcePage:function(e){o("single-suspect-source-page-change",{pageNumber:e})},changeSingleSuspectSuspectPage:function(e){o("single-suspect-suspect-page-change",{pageNumber:e})},downloadSource:function(e){o("download-source-clicked",{contentType:e})},downloadSuspect:function(e){o("download-suspect-clicked",{contentType:e})},deleteSharingKey:function(){o("delete-sharing-key",{})}},n=e.defer();function o(e,t){n.notify({type:e,params:t})}return t.promise=n.promise,t}]),e.service("reportServiceListener",["reportDataService","$rootScope","settingsService","DataService","reportServiceMediator","logService","sourcesService","$q","$timeout","contentTypeService",function(o,n,t,i,s,e,r,a,c,l){var u={init:function(e){if(!e.id)throw new Error("missing id");if(!e.reportType)throw new Error("missing reportType ( single or multiple suspects");if(!e.contentType)throw new Error("missing contentType");switch(o.pid=e.id,o.availableTypes=["text/html","text/plain"],o.type=e.reportType,e.contentType){case"html":case"text":break;default:throw new Error("unsuported content type")}o.type==o.reportTypes.singleSuspect&&(o.resultId=e.suspectId);e.hasOwnProperty("showShareButton")?o.showShareButton=e.showShareButton:o.showShareButton=!0;e.shareLinkCreationCallback&&(this.shareLinkCreationCallback=e.shareLinkCreationCallback);e.multiSuspectePage&&(o.pageNum=e.multiSuspectePage);e.singleSuspectSourcePage&&(o.pageNumSource=e.singleSuspectSourcePage);e.singleSuspectSuspectPage&&(o.pageNumResult=e.singleSuspectSuspectPage);return l.contentType.init(e.contentType),t.initSettings(),s.promise},registerToEvents:function(){var e=a.defer();return u.deferred=e,c(function(){s.registered&&s.registered()}),e.promise},progressChanged:function(e){o.scanProgressPercents=e},onDocumentReady:function(e){i.splitTextDocument(e.text),null==e.html.value&&(o.availableTypes=["text/plain"],l.contentType.setToText());o.scanned_document=e,o.splitExcludedRanges(),r.splitExistingSources(),n.$broadcast("updatePageMatchesNow"),u.deferred.notify({type:"cb_scanned_document_success",params:{doc:e}})},onNewResult:function(e){r.incomingSource(e),u.deferred.notify({type:"new_result_recieved",params:{result:e}})},onCompletion:function(e){if(o.scannedDocumentMeta)return;e.results.batch||(e.results.batch=[]);e.results.database||(e.results.database=[]);e.results.internet||(e.results.internet=[]);p(e.results.batch,o.resultType.batch),p(e.results.internet,o.resultType.internet),p(e.results.database,o.resultType.database),e.results.all=e.results.database.concat(e.results.internet,e.results.batch),o.sourceCount=e.results.all.length,o.scannedDocumentMeta=e.scannedDocument,0==o.sourceCount?100==o.scanProgressPercents&&u.deferred.notify({type:"cb_emptySources",params:{}}):(d=!0,r.incomingSources(e.results.all),u.deferred.notify({type:"incoming_results",params:{sources:e}}))},onMatches:function(e,t){var n=r.handleMatches(e,t);o.working=0<n,u.deferred.notify({type:"result_matches_recieved",params:{suspectId:e,match:t}}),d&&0==n&&(o.working=!1,u.deferred.notify({type:"cb_last_sourceRequestSent",params:{}}))},setError:function(e){o.setError(e)},getSources:function(){return o.type==o.reportTypes.multipleSuspects?underscore.values(o.sources):[o.sources[o.resultId]]},setContentType:function(e){if(l.contentType.get()==e)return;null==e&&(e=l.types.html);l.contentType.set(e),n.$broadcast("switchContentType")},switchReportType:function(e,t){e==o.reportTypes.singleSuspect?(o.resultId=t,n.$broadcast("switchToSingleSuspectReport")):n.$broadcast("switchToMultiSuspectReport")},setDocumentProperties:function(e){o.reportIcon=e.icon,o.reportTitle=e.title},reportTypes:o.reportTypes,getSharingUrl:function(e){if(!this.shareLinkCreationCallback)return a.reject();var t=a.defer();return this.shareLinkCreationCallback(e,t),t.promise},setMultipleSuspectPage:function(e){n.$broadcast("setMultipleSuspectPage",{pageNumber:e})},setSingleSuspectSourcePage:function(e){n.$broadcast("setSingleSuspectSourcePage",{pageNumber:e})},setSingleSuspectSuspectPage:function(e){n.$broadcast("setSingleSuspectSuspectPage",{pageNumber:e})}};var d=!1;function p(e,t){if(e)for(var n=0;n<e.length;++n)g(e[n]),e[n].resultType=t}function g(e){e.is_active=!0,e.status=i.eSourceStatus.reportDownloaded,null==e.URL&&(e.URL="no public address")}return u}])}function z(e){e.service("scrollService",["pageService",function(e){var t={scrollSource:function(e){void 0!==n.SoS?(t=e,o("."+n.SoS,t),delete n.SoS):void 0!==n.sourcePageLocation&&($(".source-page").find(".panel-body").scrollTop(n.sourcePageLocation),delete n.sourcePageLocation);var t},scrollSuspect:function(e){void 0!==n.SuS?(t=e,o("."+n.SuS,t),delete n.SuS):void 0!==n.suspectPageLocation&&($(".suspect-page").find(".panel-body").scrollTop(n.suspectPageLocation),delete n.suspectPageLocation);var t},setSourceMatchToScrollTo:function(e){n.SoS=e},setSuspectMatchToScrollTo:function(e){n.SuS=e},recordSourcePageTopLocation:function(e){n.sourcePageLocation=$(".source-page").find(".panel-body").scrollTop()},recordSuspectPageTopLocation:function(e){n.suspectPageLocation=$(".suspect-page").find(".panel-body").scrollTop()}},n={};function o(e,t,n){var o=t.findElement(e);if(0<o.length){var i=o.offset().top-o.parent().offset().top,s=o.closest(".panel-body");o.addClass("selected-match"),s.animate({scrollTop:i},400)}}return t}])}function H(e){e.service("settingsService",["utilitiesService","reportDataService",function(n,t){function e(){return t.pid+".settings"in localStorage?JSON.parse(localStorage[t.pid+".settings"]):null}function o(){return"default-settings"in localStorage?JSON.parse(localStorage["default-settings"]):null}this.getMaxSourcesNumber=function(){return this.instance.showOnlyTopResults?100:1/0},this.sortSourcesByNumberOfMatches=function(e){return underscore.sortBy(e,"matchedWords").reverse()},this.getMaxSourcesWithMatches=function(e){var t=this.getMaxSourcesNumber();return t==1/0&&(t=n.length(e)),underscore.first(this.sortSourcesByNumberOfMatches(e),t)},this.initSettings=function(){return this.instance=this.get_settings(),this.instance},this.get_settings=function(){return null!==e()?e():null!==o()?o():{showIdentical:!0,showSimilar:!0,showRelated:!0,showPageSources:!1,showOnlyTopResults:!0,ui:{fontSize:18,rtlMode:!1},source:{ui:{fontSize:18,rtlMode:!1}},suspect:{ui:{fontSize:18,rtlMode:!1}}}},this.set_settings=function(e){delete e.make_default;try{localStorage[t.pid+".settings"]=JSON.stringify(e)}catch(e){}},this.set_default_settings=function(e){delete e.make_default;try{localStorage["default-settings"]=JSON.stringify(settings)}catch(e){}}}])}function V(e){e.service("sourcesService",["DataService","contentTypeService","reportDataService","pageService","logService","settingsService","utilitiesService",function(n,e,i,o,s,r,a){var c={},l=0;this.resetSourcesWithoutMatches=function(e){l=e},this.checkForMissingMatches=function(e){l=underscore.find(i.sources,function(e){return!e.hasOwnProperty("matches")}).length},this.matchesBeforeSources={},this.handleMatches=function(e,t){var n=i.sources[e];if(null==n)throw new Error("Must get source before matches");return n.matches?l:this.handelSourceAndMatches(n,t)},this.handelSourceAndMatches=function(e,t){return e.matches||l--,e.matches=t,e.text=t.text.value,this.calculateSuspectPercentage(e),i.scanned_document&&i.scanned_document.text&&(e.splitMatchesText=o.splitMatchesToPages(t.text.comparison,i.scanned_document.text.pages.startPosition,"sourceToSuspect"),e.splitMatchesHtml=o.splitMatchesToPages(t.html.comparison,[0],"sourceToSuspect")),e.status=n.eSourceStatus.completed,l},this.splitExistingSources=function(){if(i.scanned_document&&i.scanned_document.text)for(var e in i.sources){var t=i.sources[e];t.matches&&!t.hasOwnProperty("splitMatchesText")&&(t.splitMatchesText=o.splitMatchesToPages(t.matches.text.comparison,i.scanned_document.text.pages.startPosition,"sourceToSuspect"),t.splitMatchesHtml=o.splitMatchesToPages(t.matches.html.comparison,[0],"sourceToSuspect"))}},this.calculateSuspectPercentage=function(e){var t=e.matches.statistics.identical+e.matches.statistics.minorChanges+e.matches.statistics.relatedMeaning,n=function(){if(i.scannedDocumentMeta&&i.scannedDocumentMeta.totalWords)return i.scannedDocumentMeta.totalWords;if(i.scanned_document&&i.scanned_document.metadata&&i.scanned_document.metadata.words)return i.scanned_document.metadata.words}();if(n){var o=Math.floor(t/n*100);0==o&&(o=1),e.totalMatchedPercents=o}},this.incomingSource=function(e){e.id in i.sources||(i.type==i.reportTypes.singleSuspect?i.resultId==e.id&&(e.matches||l++):e.matches||l++,i.sources[e.id]=e,this.matchesBeforeSources[e.id]&&this.handelSourceAndMatches(e,this.matchesBeforeSources[e.id]))},this.incomingSources=function(e){e=r.sortSourcesByNumberOfMatches(e);for(var t=r.getMaxSourcesNumber(),n=0;n<e.length&&n<t;++n){var o=e[n];o.id in i.sources||(i.type==i.reportTypes.singleSuspect?i.resultId==o.id&&(o.matches||l++):o.matches||l++,i.sources[o.id]=o,this.matchesBeforeSources[o.id]&&this.handelSourceAndMatches(o,this.matchesBeforeSources[o.id]))}for(;n<e.length;++n)c[e[n].id]=e[n];s.log("Parsed "+a.length(e)+" incoming sources"),s.log("There are"+a.length(c)+" remaining sources, that were not processed")},this.getRemainingSources=function(){for(var e in s.log("processing "+a.length(c)+" remaining sources"),c)incomingSource(c[e]);c.length=0}}])}function W(e){e.service("statisticsService",["settingsService","utilitiesService","logService",function(l,o,u){function d(e,t){if(e&&0!=Object.keys(e).length){for(var n,o=l.getMaxSourcesNumber(),i=l.sortSourcesByNumberOfMatches(e),s=[],r=i.length,a=0;a<r&&a<o;a++)(n=i[a]).hasOwnProperty("matches")&&(t?n.is_active&&s.push(n):s.push(n));return s}}function g(e,t){u.log("mergeSourceMatches");var n,o=d(e,!0),i=[];l.instance.showIdentical&&(n=o,i=underscore.flatten(underscore.map(n,function(e){return e.matches.text.comparison.identical.source.words})));var s,r=[];l.instance.showSimilar&&(s=o,r=underscore.flatten(underscore.map(s,function(e){return e.matches.text.comparison.minorChanges.source.words})));var a,c=[];return l.instance.showRelated&&(a=o,c=underscore.flatten(underscore.map(a,function(e){return e.matches.text.comparison.relatedMeaning.source.words}))),function(e){var t=underscore.groupBy(e,"p"),n={identical:0,similar:0,related:0};t.hasOwnProperty("1")&&(n.identical=p(t[1]));t.hasOwnProperty("2")&&(n.similar=p(t[2]));t.hasOwnProperty("3")&&(n.related=p(t[3]));return n}(function(e,t,n,o){var i=new L;i.add({s:0,e:o-1,p:4});var s=i.head;return e.forEach(function(e){s=i.append(e,s)}),s=i.head,t.forEach(function(e){s=i.append(e,s)}),s=i.head,n.forEach(function(e){s=i.append(e,s)}),i.toArray()}(m(i,1),m(r,2),m(c,3),t))}function p(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].e-e[n].s+1;return t}function m(e,t){var n=[];if(!e||0==e.length)return[];for(var o=0;o<e[0].starts.length;++o){var i=e[0].starts[o];n.push({wordIndex:i,type:0}),n.push({wordIndex:i+e[0].lengths[o],type:1})}var s=n.sort(function(e,t){return e.wordIndex<t.wordIndex?-1:e.wordIndex>t.wordIndex?1:e.type<t.type?-1:e.type>t.type?1:0}),r=[],a=0,c=0;for(o=0;o<s.length;++o){var l=s[o];0==l.type&&(0==a&&(c=l.wordIndex),a+=1),1==l.type&&0==(a-=1)&&r.push({p:t,s:c,e:l.wordIndex})}return r}this.atLeastOneSourceWithMatches=function(e){if(null!=e){for(var t in e){var n=e[t];if(n.hasOwnProperty("matches")&&null!=n.matches.text.comparison.identical)return!0}return!1}},this.haveDataForStatistics=function(e){if(null==e)return!1;if(0==o.length(e))return!1;if(!this.atLeastOneSourceWithMatches(e))return!1;var t=d(e,!1),n=l.getMaxSourcesNumber();return n!=1/0&&t.length>=n||Object.keys(e).length==t.length},this.getEmpty=function(e){return{totalCopiedWords:0,totalWordCount:e,percentage:{identical:{round:0,real:0},similar:{round:0,real:0},related:{round:0,real:0},wordsNotCopied:e}}},this.computeStatistics=function(e,t,n){if(!e)return null;if(!t)return null;var o,i,s,r,a,c,l=g(e,t),u=t-n,d=(l.identical,l.related,l.similar,o=l,i=u,s=underscore.map(o,function(e,t){var n=e/i*100;return{name:t,value:e,percentage:n,percentageRoundedDown:Math.floor(n),priority:function(e){switch(e){case"identical":return 1;case"similar":return 2;case"related":return 3}}(t)}}).filter(function(e){return 0<e.value}),r=underscore.reduce(s,function(e,t){return e+t.percentage},0),a=underscore.reduce(s,function(e,t){return e+t.percentageRoundedDown},0),c=Math.floor(r-a),s=underscore.sortBy(s,"percentageRoundedDown"),underscore.each(s,function(e){if(0==c)return!1;1<=e.percentageRoundedDown&&(e.percentageRoundedDown=e.percentageRoundedDown+1,c--)}),underscore.indexBy(s,"name")),p={totalCopiedWords:l.identical+l.related+l.similar,totalWordCount:u,percentage:{identical:{round:d.identical&&d.identical.percentageRoundedDown||0,real:d.identical&&d.identical.percentage||0},similar:{round:d.similar&&d.similar.percentageRoundedDown||0,real:d.similar&&d.similar.percentage||0},related:{round:d.related&&d.related.percentageRoundedDown||0,real:d.related&&d.related.percentage||0}}};return p.percentage.wordsNotCopied=100-p.percentage.identical.round-p.percentage.similar.round-p.percentage.related.round,p}}])}function U(e){e.service("utilitiesService",["$timeout",function(e){this.clearObject=function(e){for(var t in e)e.hasOwnProperty(t)&&delete e[t]},this.throttleWithGuaranteedLastRun=function(n,o){var i,s,r;return function(){var e=this,t=arguments;i?(clearTimeout(s),s=setTimeout(function(){Date.now()-r>=o&&(n.apply(e,t),r=Date.now())},o-(Date.now()-r))):(n.apply(e,t),r=Date.now(),i=!0)}},this.length=function(e){if(e instanceof Array)return e.length;if(e instanceof Object)return Object.keys(e).length;throw new Error("Unsupported type")},this.setControlToNoResultsState=function(e,t){e.showEmpty?e.showEmpty(t):(e.isEmpty=!0,e.emptyResults=t)},this.getMaxPaginationCount=function(){var e=$(window).width();return 768<=e?10:400<=e?5:1},this.getMaxPaginationOneToOne=function(){var e=$(window).width();return 1300<=e?10:1e3<=e?6:850<=e?4:600<=e?3:300<=e?2:1};var t,n=function(e){return t||(t=document.createElement("a")),t.href=e,t.href};function o(e){return{"-ms-zoom":e,"-moz-transform":"scale("+e+")","-moz-transform-origin":"0 0","-o-transform":"scale("+e+")","-o-transform-origin":"0 0","-webkit-transform":"scale("+e+")","-webkit-transform-origin":"0 0"}}this.getAbsoluteUrl=n,this.initScopeForIframeZoom=function(e){e.maxZoom=3.75,e.minZoom=1,e.zoom=1,e.zoomIn=function(){e.zoom+=.25,e.iframeStyle=o(e.zoom)},e.zoomOut=function(){e.zoom-=.25,e.iframeStyle=o(e.zoom)}}}])}B.prototype.splitText=function(e,t){for(var n=[],o=0;o<t.length;o++){var i,s=t[o];if(o==t.length-1)i=e.substr(s);else{var r=t[o+1];i=e.substr(s,r-s)}n.push(i)}return n},B.prototype.splitMatch=function(e,t,n){if(null==e)return null;var o,i;if("sourceToSuspect"==n)o="source",i="suspected";else{if("suspectToSource"!=n)throw new Error("Unsupported map type: "+n);o="suspected",i="source"}var s=[];null===t&&(t=[0]);for(var r=0;r<t.length;++r)s.push({groupId:[],starts:[],lengths:[],otherStarts:[],otherLengths:[]});var a=e.groupId.length,c=0;for(r=0;r<t.length;++r){var l,u=t[r];l=r+1===t.length?99999999999:t[r+1];for(var d=c;d<a;++d){var p=e[o].chars.starts[d],g=e[o].chars.lengths[d],m=e[i].chars.starts[d],h=e[i].chars.lengths[d],f=p+g;if(u<=p&&p<l){if(!(f<=l)){s[r].groupId.push(e.groupId[d]),s[r].starts.push(p),s[r].lengths.push(l-p),s[r].otherStarts.push(m),s[r].otherLengths.push(h),e[o].chars.starts[d]=l,e[o].chars.lengths[d]=f-l;break}s[r].groupId.push(e.groupId[d]),s[r].starts.push(p),s[r].lengths.push(g),s[r].otherStarts.push(m),s[r].otherLengths.push(h),c++}}}return this.makePageZeroBased(s,t,n)},B.prototype.splitExcluded=function(e,t){if(null==e)return null;var n=[];null===t&&(t=[0]);for(var o=0;o<t.length;++o)n.push({});var i=0;for(o=0;o<t.length;++o){var s,r=t[o];s=o+1===t.length?99999999:t[o+1];for(var a=i;a<e.length;++a){var c=e.value[a],l=c+e.length[a];if(r<=c&&c<s)if(l-1<=s)n[o].groupIds.push(e.groupIds[a]),n[o].reasons.push(e.reasons[a]),n[o].lengths.push(e.lengths[a]),n[o].value.push(e.value[a]),i--;else{var u=l-s;n[o].groupIds.push(e.groupIds[a]),n[o].reasons.push(e.reasons[a]),n[o].lengths.push(u),n[o].value.push(e.value[a]),e.value[a]=s+1,e.lengths[a]=e.lengths[a]-u}}}return this.makeExcludePageZeroBased(n,t)},B.prototype.makeExcludePageZeroBased=function(e,t){for(var n=1;n<t.length;++n)if(e[n].values)for(var o=e[n].values.length,i=0;i<o;++i)e[n].values[i]-=t[n];return e},B.prototype.makePageZeroBased=function(e,t,n){for(var o=1;o<t.length;++o)for(var i=e[o].groupId.length,s=0;s<i;++s)e[o].starts[s]-=t[o];return e},L.prototype.appendHigherPriority=function(e,t){var n=t.data;if(e.s>n.e)return t.next?this.append(e,t.next):(t.next=new F(e),t.next);if(e.s==n.s){if(e.e==n.e)return n.p=e.p,t.next;if(e.e>n.e)return n.p=e.p,null==t.next?t:this.append({s:n.e+1,e:e.e,p:e.p},t.next);if(e.e<n.e)return(s=new F({s:e.e+1,e:n.e,p:n.p})).next=t.next,t.next=s,n.p=e.p,n.e=e.e,s}if(e.e==n.e)return(s=new F({s:e.s,e:e.e,p:e.p})).next=t.next,t.next=s,n.e=e.s-1,s;if(e.e>n.e){var o=n.e;return(s=new F({s:e.s,e:n.e,p:e.p})).next=t.next,t.next=s,n.e=e.s-1,null==s.next?(s.data.e=e.e,s):this.append({s:o+1,e:e.e,p:e.p},s.next)}if(e.e<n.e){var i=t.next,s=new F({s:e.s,e:e.e,p:e.p});t.next=s;var r=new F({s:e.e+1,e:n.e,p:n.p});return n.e=e.s-1,r.next=i,s.next=r}throw new Error("Should not be possible")},L.prototype.appendLowerPriority=function(e,t){var n=t.data;if(e.s>n.e)return null==t.next?t:this.append(e,t.next);if(e.s==n.s){if(e.e==n.e)return t.next;if(e.e>n.e)return null==t.next?t:this.append({s:n.e+1,e:e.e,p:e.p},t.next);if(e.e<n.e)return t}if(e.e==n.e||e.e<n.e)return t;if(e.e>n.e)return null==t.next?t:this.append({s:n.e+1,e:e.e,p:e.p},t.next);throw new Error("Should not be possible")},L.prototype.append=function(e,t){var n=t.data;return e.p<n.p?this.appendHigherPriority(e,t):this.appendLowerPriority(e,t)},L.prototype.add=function(e){var t=new F(e),n=this.head;if(!n)return this.head=t;for(;n.next;)n=n.next;return n.next=t},L.prototype.print=function(e){if(null==this.head)return"";for(var t=[],n=this.head;t.push(n.data),n=n.next;);return t.reduce(function(e,t){return e+"Node-"+t.p+": "+t.s+","+t.e+"\n"},"")},L.prototype.toArray=function(e){var t=[];if(null==this.head)return[];for(var n=this.head;n.data.p<4&&t.push(n.data),n=n.next;);return t};var q=angular.module("ThemingModule",["ngMaterial"]);function Z(e){function t(t,e,n){function o(e){t.ready=!0,t.sources[0].percent=1<=e.percentage.identical.real?e.percentage.identical.round:e.percentage.identical.real,t.sources[1].percent=1<=e.percentage.similar.real?e.percentage.similar.round:e.percentage.similar.real,t.sources[2].percent=1<=e.percentage.related.real?e.percentage.related.round:e.percentage.related.real}t.control.showStatistics=underscore.debounce(function(e){n.log("cpGraphLegend: showStatistics"),t.$apply(function(){o(e)})},1e3),t.sources=[{percent:0,text:"Identical",colorBoxStyle:{"background-color":"#FF6666"},setting:"showIdentical",tooltipText:"Exact wording in the text"},{percent:0,text:"Minor Changes",colorBoxStyle:{"background-color":"#FF9A9A"},setting:"showSimilar",tooltipText:'Nearly identical with different form i.e. "slow" becomes "slowly"'},{percent:0,text:"Related Meaning",colorBoxStyle:{"background-color":"#FFD9B0"},setting:"showRelated",tooltipText:"Close meaning but different words "}],t.settings=e.instance,t.control.isEmpty?o(t.control.emptyResults):t.control.statistics&&o(t.control.statistics),t.control.showEmpty=function(e){o(e)},t.$on("recalculatingStatistics",function(){t.ready=!1,t.sources=[{percent:0,text:"Identical",colorBoxStyle:{"background-color":"#FF6666"},setting:"showIdentical",tooltipText:"Exact wording in the text"},{percent:0,text:"Minor Changes",colorBoxStyle:{"background-color":"#FF9A9A"},setting:"showSimilar",tooltipText:'Nearly identical with different form i.e. "slow" becomes "slowly"'},{percent:0,text:"Related Meaning",colorBoxStyle:{"background-color":"#FFD9B0"},setting:"showRelated",tooltipText:"Close meaning but different words "}]})}t.$inject=["$scope","settingsService","logService"],e.directive("cpGraphLegend",[function(){return{restrict:"E",scope:{control:"="},template:'<div class="cp-graph-legend"><div ng-repeat="legendItem in sources" class="legend-item" ng-show="settings[legendItem.setting]"><div class="box-wrapper"><div class="color-box" ng-style="legendItem.colorBoxStyle"></div></div><div class="legend-title">{{legendItem.text}}</div><span class="legend-info"><md-tooltip md-autohide="true" md-delay="500">{{legendItem.tooltipText}}</md-tooltip></span><div class="legend-percent" ng-if="legendItem.percent == 0">0%</div><div class="legend-percent" ng-if="legendItem.percent >= 1">{{legendItem.percent | number:0}}%</div><div class="legend-percent" ng-if="legendItem.percent < 1 && legendItem.percent > 0">&lt;1%</div></div></div>',controller:t}}])}function G(e){function t(o,e,t,n){function i(e){o.data=[e.wordsNotCopied,e.identical.real,e.similar.real,e.related.real],o.roundedData=[e.wordsNotCopied,e.identical.round,e.similar.round,e.related.round]}o.labels=["Original","Identical","Minor Changes","Related Meaning"],o.colors=["#ffffff","#FF6666","#FF9A9A","#FFD9B0"],o.data=[10,10,10],o.options={responsive:!0,maintainAspectRatio:!1,legend:{display:!1},segmentShowStroke:!1,elements:{arc:{borderWidth:0}},tooltips:{callbacks:{title:function(e,t){return t.labels[e[0].index]},label:function(e,t){if(o.roundedData){var n=t.datasets[0];return 1<=n.data[e.index]||0==n.data[e.index]?"("+o.roundedData[e.index]+"%)":"(<1%)"}},afterLabel:function(e,t){return""}},backgroundColor:"#ff0000",titleFontSize:16,titleFontColor:"#fdfdfd",bodyFontColor:"#fdfdfd",bodyFontSize:14,displayColors:!1,mode:"nearest",position:"nearest"}},o.control.showStatistics=t.throttleWithGuaranteedLastRun(function(e){n.log("cpGraph: showStatistics"),o.ready=!0,i(o.control.statistics.percentage)},1e3),o.ready=!1,o.control.isEmpty?(o.ready=!0,o.data=[1,0,0,0]):o.control.statistics&&(o.ready=!0,i(o.control.statistics.percentage)),o.control.showEmpty=function(){o.ready=!0,o.data=[1,0,0,0]},o.$on("recalculatingStatistics",function(){o.ready=!1})}t.$inject=["$scope","$element","utilitiesService","logService"],e.directive("cpGraph",[function(){return{restrict:"E",scope:{control:"="},template:'<div ng-if="!ready" class="loading-indicator"><md-tooltip md-direction="bottom" md-delay="500">Computing statistics graph...</md-tooltip><md-progress-circular md-mode="indeterminate" class="pull-left" md-diameter="20px"></md-progress-circular><label>Computing...</label></div><div ng-if="ready" class="position-relative"><div class="cp-graph-wrapper" ng-if="ready"><canvas id="pie" class="chart chart-pie" chart-data="data" chart-labels="labels" chart-options="options" chart-click="onClick" chart-colors="colors"></canvas></div></div>',controller:t}}])}function J(e){function t(t,e,n){function o(){t.total=t.statistics.percentage.identical.round+t.statistics.percentage.similar.round+t.statistics.percentage.related.round,t.ready=!0}t.control.showStatistics=underscore.debounce(function(e){n.log("cpStatistics: showStatistics"),t.$apply(function(){t.statistics=e,o()})},1e3),t.ready=!1,t.control.isEmpty?(n.log("cpStatistics: $scope.control.isEmpty"),t.statistics=t.control.emptyResults,o()):t.control.statistics&&(t.statistics=t.control.statistics,o()),t.control.showEmpty=function(e){t.statistics=e,o()},t.$on("recalculatingStatistics",function(){t.ready=!1,delete t.total})}t.$inject=["$scope","$element","logService"],e.directive("cpStatistics",["logService",function(e){return{restrict:"E",scope:{control:"="},template:'<div class="statistics-control"><div class="suspected-words">Suspected Words</div><div ng-if="!ready" class="loading-indicator"><md-tooltip md-direction="bottom" md-delay="500">Computing statistics...</md-tooltip><md-progress-circular md-mode="indeterminate" class="pull-left" md-diameter="20px"></md-progress-circular><label>Computing...</label></div><div ng-if="ready"><div class="suspected-indicator" ng-class="{\'low\': total <= 20 , \'medium\': total <= 60 && total>=21, \'high\': total > 60}">{{total| number:0}}%</div><span class="suspected-indicator-icon"><md-icon class="cl-info">info_outline</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">{{total| number:0}}% of this content is similar to other sources</md-tooltip></span><div class="suspected-counter" ng-class="{\'low\': total <= 20 , \'medium\': total <= 60 && total>=21, \'high\': total > 60}">{{statistics.totalCopiedWords | prettyNumberWithK}} Words Copied<md-tooltip md-direction="left" md-autohide="true" ng-if="statistics.totalCopiedWords >= 1000" md-delay="500">{{statistics.totalCopiedWords | number}} Words Copied</md-tooltip></div></div></div>',controller:t}}])}function K(e){e.service("affixService",["$q",function(e){return{init:function(m,h,f){var v=-1;function S(){$("#my-affix").css("width","")}m.$on("registerAffix",function(e,t){t.type,m.registerAffix()}),m.registerAffix=function(){m.removeAffix=function(){var e=document.getElementById(f),t=$(e);t.removeClass("my-affix-active");var n=t.parent();n.css("flex-direction","row")},m.deregisterAffix=function(){window.removeEventListener("scroll",e)},window.removeEventListener("scroll",e),window.addEventListener("scroll",e),$(window).resize(function(){var e=$(window);if(!(e.width()<768)){var t=document.getElementById(f),n=$(t);n.hasClass("my-affix-active")}})};var w=-1;function e(){!function(){var e=$(window),t=$(h),n=document.getElementById(f),o=$(n);if(e.width()<768)return S();if(!m.okToAffix)return;var i=window.innerHeight,s=t.offset().top-i+t.height(),r=o.offset().top,a=o.height(),c=e.scrollTop(),l=$(".actual-results-height").height();if(c<v)y(o),v=-1;else if(c<w)y(o),v=-1;else if(-1==v&&s<=c){if(c<=r)return;if(l<o.find("md-card").height())return;w=r;o.find("md-card").height();o.addClass("my-affix-active"),v=s,a<i?(o.css("top",0),o.css("bottom","auto")):(o.css("bottom",62),o.css("top","auto"));var u=o.parent();u.css("flex-direction","row-reverse");var d=u.width(),p=$("#result-column-next-to-affix").width();o.find("md-card").css("margin-top",0);var g=d-p-16;$("#my-affix").css("width",g)}}()}function y(e){var t;(t=e).parent().css("flex-direction","row"),t.removeClass("my-affix-active"),v=-1,t.css("top","auto"),t.css("bottom","auto"),S(),t.css("width",""),t.find("md-card").css("margin-top","")}}}}])}function Y(e){function t(t,e,n,o,i,s){t.allSources=function(e){var t=[];for(var n in e)t.push(e[n]);return t}(i.sources),t.reportDataService=i,t.changeSourceVisibilityStatus=function(e){e.is_active=!e.is_active},t.test=function(){},t.uncheckAll=function(){for(var e in t.reportDataService.sources)t.reportDataService.sources[e].is_active=!1},t.checkAll=function(){for(var e in t.reportDataService.sources)t.reportDataService.sources[e].is_active=!0},t.close=function(){o.cancel(),s.$broadcast("updatePageMatchesNow"),s.$broadcast("updateGraph")}}e.service("filterDialogService",["$mdDialog",function(e){return{show:function(){return e.show({controller:t,template:'<md-dialog aria-label="Filter results" class="modal-dialog"><form ng-cloak><md-toolbar><div layout="row" class="flex-center-center"><h4 class="modal-title" flex>Results Filter</h4><md-button ng-click="close()" class="md-icon-button" aria-label="close filter dialog"><i class="material-icons">close</i></md-button></div></md-toolbar><md-dialog-content class="filter-dialog-content"><md-input-container class="md-block no-gap-bottom"><label layout="row"><i class="material-icons" aria-hidden="true">search</i> Filtered by Results</label> <input ng-model="source_filter_query"></md-input-container><ul class="filtered-list list-unstyled flexcroll"><li ng-repeat="source in allSources | orderBy:\'title\' | filter: {url: source_filter_query} as filtered_sources track by $index" ng-class="{\'unchecked-source\': !source.is_active}" title="{{source.url}}" ng-click="changeSourceVisibilityStatus(source);"><span ng-class="source.is_active ? \'visibility-on\' : \'visibility-off\'"></span> <span class="ellipsis-text">{{ source.title }}</span></li></ul></md-dialog-content><md-dialog-actions layout="row"><div flex layout="column"><a ng-click="uncheckAll()">Hide all results</a> <a ng-click="checkAll()">Show all results</a></div><md-button class="md-raised md-primary" ng-click="close()">Close</md-button></md-dialog-actions></form></md-dialog>',parent:angular.element(document.body),clickOutsideToClose:!0})}}}]),t.$inject=["$scope","$element","$timeout","$mdDialog","reportDataService","$rootScope"]}function X(e){function t(n,e,t,o,i,s,r){n.saveDisabled=!0,n.tempSettings=angular.extend({},s.instance),n.settings_make_default=!1,n.saveSettings=function(){var e=s.instance.showPageSources!=n.tempSettings.showPageSources,t=s.instance.showOnlyTopResults!=n.tempSettings.showOnlyTopResults;angular.extend(s.instance,n.tempSettings),n.settings_make_default&&s.set_default_settings(s.instance),s.set_settings(n.pageId,s.instance),n.tempSettings.showPageSources||r.$broadcast("getMoreResults"),(t||e)&&r.$broadcast("raiseSourceListRefresh"),o.cancel(),r.$broadcast("updatePageMatches"),n.$emit("updateGraph")},n.enableSave=function(){n.saveDisabled=!1},n.close=function(){o.cancel(),r.$broadcast("updatePageMatchesNow"),r.$broadcast("updateGraph")}}e.service("settingsDialogService",["$mdDialog",function(e){return{show:function(){return e.show({controller:t,template:'<md-dialog aria-label="settings dialog" class="modal-dialog"><form ng-cloak><md-toolbar><div layout="row" class="flex-center-center"><h4 class="modal-title" flex>Settings</h4><md-button ng-click="close()" class="md-icon-button" aria-label="close filter dialog"><i class="material-icons" aria-hidden="true">close</i></md-button></div></md-toolbar><md-dialog-content class="settings-dialog-content"><div class="modal-body"><md-switch ng-model="tempSettings.showPageSources" aria-label="Show only sources with matches in page" ng-click="enableSave();">View sources with matches in page</md-switch><md-switch ng-model="tempSettings.showOnlyTopResults" aria-label="Related Meaning" ng-click="enableSave();">Show only top 100 relevant results</md-switch><label class="warning" ng-if="!tempSettings.showOnlyTopResults">If disabled, the scan may be slowed down</label><md-divider style="margin:20px 0;"></md-divider><ul class="list-unstyled"><li><md-checkbox ng-model="tempSettings.showIdentical" aria-label="Identical" ng-click="enableSave();" ng-disabled="!tempSettings.showSimilar && !tempSettings.showRelated">Identical</md-checkbox></li><li><md-checkbox ng-model="tempSettings.showSimilar" aria-label="Similar" ng-click="enableSave();" ng-disabled="!tempSettings.showIdentical&& !tempSettings.showRelated">Minor Changes</md-checkbox></li><li><md-checkbox ng-model="tempSettings.showRelated" aria-label="Related Meaning" ng-click="enableSave();" ng-disabled="!tempSettings.showIdentical && !tempSettings.showSimilar">Related Meaning</md-checkbox></li></ul></div></md-dialog-content><md-dialog-actions layout="row"><div layout="row" class="settings-actions" flex><div><md-checkbox ng-model="settings_make_default" aria-label="Set default" ng-click="enableSave();">Set as default for all scans</md-checkbox></div><md-button class="md-raised md-primary" ng-click="saveSettings()" ng-disabled="saveDisabled">Save</md-button></div></md-dialog-actions></form></md-dialog>',parent:angular.element(document.body),clickOutsideToClose:!0})}}}]),t.$inject=["$scope","$element","$timeout","$mdDialog","reportDataService","settingsService","$rootScope"]}function Q(e){function n(t,n,o,e,i,s,r){var a="Only you can view this report.";t.urlForSharing=null,t.deleted=!1,t.saveDisabled=!0,s.getSharingUrl(i.pid).then(function(e){e&&(t.urlForSharing=e,t.urlForSharing&&t.urlForSharing!=a)&&t.selectText()});var c=0;t.selectText=function(){5<=c++?t.saveDisabled=!1:angular.element(document.body).hasClass("md-dialog-is-showing")?o(function(){var e=n.find("#share-link-input")[0];e.focus(),e.setSelectionRange(0,e.value.length),o(function(){t.saveDisabled=!1},500)},100):o(t.selectText,100)},t.deleteSharedLink=function(){reportServiceMediator.deleteSharingKey(t.pid),t.deleted=!0,t.urlForSharing=a},t.close=function(){e.cancel(),r.$broadcast("updatePageMatchesNow"),r.$broadcast("updateGraph")}}e.service("shareDialogService",["$mdDialog","reportServiceMediator",function(e,t){return{show:function(){return e.show({controller:n,template:'<md-dialog aria-label="settings dialog" class="modal-dialog" id="share-form"><form ng-cloak><md-toolbar><div layout="row" class="flex-center-center"><h4 class="modal-title" flex>Share with others</h4><md-button ng-click="close()" class="md-icon-button" aria-label="close filter dialog"><i class="material-icons" aria-hidden="true">close</i></md-button></div></md-toolbar><md-dialog-content class="settings-dialog-content"><div class="modal-body"><div layout="row"><div flex="100" class="anyone-can-share-label"><div ng-show="!urlForSharing && !deleted"><md-tooltip md-direction="bottom" style="margin-right:10px" md-delay="500">Generating Share url</md-tooltip><md-progress-circular md-mode="indeterminate" class="pull-left" md-diameter="25px"></md-progress-circular></div><md-label>Use this URL to share the comparison report</md-label></div></div><div layout="row"><div flex="100"><md-input-container class="md-block"><md-icon md-font-icon="link">link</md-icon><input id="share-link-input" type="text" aria-label="Share this comparison report" ng-model="urlForSharing" readonly onClick="this.setSelectionRange(0, this.value.length)"></md-input-container></div></div><div layout="row" class="sharing-info-section" ng-if="!disableDelete"><div flex="9"><md-icon>lock_outline</md-icon></div><div flex="91"><div>You can <a ng-click="deleteSharedLink()">revoke access</a> from others seeing this report</div></div></div></div></md-dialog-content><md-dialog-actions layout="row"><div layout="row" class="sharing-actions" flex><md-button class="md-raised md-primary" ng-click="saveSettings()" ng-disabled="saveDisabled">OK</md-button></div></md-dialog-actions></form></md-dialog>',parent:angular.element(document.body),clickOutsideToClose:!0})}}}]),n.$inject=["$scope","$element","$timeout","$mdDialog","reportDataService","reportServiceListener","$rootScope"]}q.config(["$mdThemingProvider",function(e){e.definePalette("amazingPaletteName",{50:"ffebee",100:"bbc3c9",200:"ef9a9a",300:"e57373",400:"ef5350",500:"17a1ff",600:"1c7ffa",700:"00ff00",800:"c62828",900:"b71c1c",A100:"ff8a01",A200:"ff5202",A400:"ff1703",A700:"17c9ff",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.definePalette("amazingContrastPallete",{50:"000000",100:"ffcd01",200:"ef9a9a",300:"e57373",400:"ef5350",500:"f44336",600:"e53902",700:"00ff00",800:"c62828",900:"b71c1c",A100:"ff8a01",A200:"17a1ff",A400:"ff1703",A700:"17a1ff",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.theme("default").primaryPalette("amazingPaletteName").accentPalette("amazingContrastPallete")}]),window.underscore=_.noConflict();