function e(e){x(e),p(e),c(e),g(e),y(e),Z(e),q(e),J(e),U(e),V(e),A(e),X(e),Y(e),E(e),Q(e),W(e),S(e),F(e),b(e),n(e),v(e),m(e),o(e),K(e),d(e),s(e),j(e),I(e),H(e),h(e),r(e),O(e),T(e),u(e),l(e),f(e),W(e),i(e),z(e)}var t=angular.module("CopyleaksReport",["ngAnimate","ngSanitize","ngMaterial","ThemingModule","angularMoment","chart.js"]);function n(e){e.controller("education-report-ctrl",["$scope","$window","$location","$http","$timeout","utilitiesService","statisticsService","settingsService","logService","shareDialogService","pageService","affixService","reportDataService","$rootScope","contentTypeService","reportServiceListener","sourcesService","DataService","reportServiceMediator",function(r,e,t,n,s,o,a,i,c,l,u,d,p,g,m,h,f,v,S){if($("html").css("maxHeight","auto"),!r.comingFromBusinessReport){p.type=p.reportTypes.multipleSuspects,r.$emit("recalculateHeaderSegments"),r.reportDataService=p,r.$on("on-element-resized",function(){b()}),s(b,1e3),window.addEventListener("popstate",T),r.$on("$destroy",function(){window.removeEventListener("popstate",T)}),x(),r.document_pagination={current:-1,total_pages:-1,ready:!1},r.lockedSources={},r.sources=p.sources,r.sourceListControl={},r.paginationControl={},r.paginationControl.getMaxPagination=o.getMaxPaginationCount;var y=!1;r.$on("updatePageMatches",function(){y||r.updateCurrentPageMatchesAndStatistics()}),r.updateCurrentPageMatchesAndStatistics=function(){r.updateCurrentPageMatches(),E()},r.updateCurrentPageMatches=function(){c.log("updateCurrentPageMatches() called."),r.document_pagination.ready&&(y=!0,r.$broadcast("updatePageMatches"),y=!1)},r.updateCurrentPageMatchesThrotteled=o.throttleWithGuaranteedLastRun(r.updateCurrentPageMatches,1e3),r.getMoreResults=function(){if(!i.instance.showOnlyTopResults)throw new Error("not implemented")},r.$on("getMoreResults",r.getMoreResults),r.start=function(){h.registerToEvents().then(R,M,P)},r.start(),r.focusResults=function(e){r.unfocusResults();for(var t=0;t<e.length;++t){var n=e[t];null!=n&&(r.lockedSources[n]=n)}$(window).width()<768&&r.sourceListControl&&r.sourceListControl.show&&r.sourceListControl.show()},r.unfocusResults=function(){o.clearObject(r.lockedSources)};r.source_page_changed=function(e){S.changeMultiSuspectPage(e.current),_(e.current)};r.$on("updateGraph",function(){E()}),r.$on("switchToSingleSuspectReport",function(){r.deregisterAffix()});var w=null;r.$on("raiseSourceListRefresh",I),r.switchToHtmlContentType=function(){m.contentType.setToHtml(),S.switchReportContentType("html"),F()},r.switchToTextContentType=function(){m.contentType.setToText(),S.switchReportContentType("text"),F()},d.init(r,".my-target","my-affix")}function b(){var e=$(".contributing-to-height-1").height()+$(".contributing-to-height-report-info").height()+$(".contributing-to-height-scan-properties").height()+$(".contributing-to-height-page").height()+100;isNaN(e)||window.parent.postMessage(JSON.stringify(e),"*")}function T(e){if(!e.state){var t=location.href.substr(location.href.lastIndexOf("/")+1),n=/\d+/g;t.match(n)[0],_(t=t.match(n),!1)}}function x(){r.okToAffix=!1;try{var e=$(".contributing-to-height-page").offset().top}catch(e){}isNaN(e)&&(e=0),$("html").animate({scrollTop:e},"slow",function(){r.okToAffix=!0})}function C(){var e=p.scanned_document.pages;r.document_pagination.total_pages=e.length}function _(e,t){p.scanned_document&&p.scanned_document.pages&&(r.document_pagination.ready=!0,r.document_pagination.current=parseInt(e),C(),p.pageNum==e&&!1!==t||(x(),p.pageNum=e,r.removeAffix&&r.removeAffix(),s(function(){},10)),I(),r.updateCurrentPageMatches(),k())}function k(){g.$broadcast("updatePageMatchesNow")}function P(e){var t,n,o=e.type,i=e.params;switch(o){case"cb_process_info_success":n=i.info,r.info=n,r.$emit("hideLabelIfRequestIsInTheFuture");break;case"cb_scanned_document_success":!function(){r.switchingContentType&&(C(),r.$broadcast("updateNavigationButtons"),r.switchingContentType=!1);p.pageNum?_(p.pageNum):_(1)}();break;case"new_result_recieved":t=i.result,I(),D(t);break;case"cb_result_ready":D(i.result),I(),r.paginationControl.recomputePageColors&&r.paginationControl.recomputePageColors(p.sources);break;case"cb_last_sourceRequestSent":E();break;case"cb_emptySources":!function(){if(r.info&&"Processing"!=r.info.status&&r.info.wordsCount){if(p.showStatisticControls){var e=a.getEmpty(r.info.wordsCount);O(),r.$emit("setControlToNoResultsState",e)}r.sourceListControl.showEmpty&&r.sourceListControl.showEmpty()}p.noMatches=!0,r.$broadcast("isEmptySources",e),r.isEmpty=!0}();break;case"cb_scanned_document_error":r.switchingContentType&&(r.switchingContentType=!1);break;case"result_matches_recieved":break;case"existing_results_with_matches":E();break;case"incoming_results":break;default:s(function(){throw new Error("out of range: "+o)})}}function M(e){var t=e.type;e.params;s(function(){throw new Error("out of range: "+t)})}function R(e,t){s(function(){throw new Error("out of range: "+e)})}function D(e){var t=1<r.document_pagination.total?r.document_pagination.current-1:0;r.document_pagination.ready&&e.matches&&(e.matches.identical&&0<e.matches.identical[t].length||e.matches.similar&&0<e.matches.similar[t].length||e.matches.relatedMeaning&&0<e.matches.relatedMeaning[t].length)&&r.updateCurrentPageMatchesThrotteled()}function O(e){c.log("updateChildrenControls"),e&&(c.log("got statistics"),r.$emit("showStatistics",e)),r.paginationControl.recomputePageColors&&r.paginationControl.recomputePageColors(p.sources)}function E(){if(w&&(s.cancel(w),w=null),100==p.scanProgressPercents){if(p.showStatisticControls)var e=function(){if(p.info){c.log("word count: "+p.info.wordsCount);var e=p.info.wordsCount;return e&&a.haveDataForStatistics(p.sources)?(c.log("sources for statistics: "),c.log(p.sources),a.computeStatistics(p.sources,e,p.excludedRangeCount)):null}}();O(e),!p.showStatisticControls||e?k():w=s(E,1e3)}else w=s(E,1e3)}function I(){r.sourceListControl.refresh&&r.sourceListControl.refresh()}function F(){p.excludedRangesPerPage=null,p.clearSourcesMatch(),underscore.each(p.sources,function(e){e.status=v.eSourceStatus.switchingType}),r.switchingContentType=!0,x(),r.removeAffix&&r.removeAffix(),f.resetSourcesWithoutMatches(o.length(p.sources)),p.working=!0,r.$broadcast("updateNavigationButtons"),r.$broadcast("refreshSingleSuspectReportLinks")}}])}function o(e){e.controller("one-to-one-ctrl",["$scope","$timeout","utilitiesService","statisticsService","settingsService","logService","shareDialogService","oneToOneReportService","pageService","reportDataService","scrollService","$rootScope","contentTypeService","reportServiceListener","reportServiceMediator",function(a,c,e,l,t,n,o,u,i,d,r,s,p,g,m){function h(){a.sourcePageIndex=Number(d.pageNumSource),a.resultPageIndex=Number(d.pageNumResult)}function f(){var e=$(".contributing-to-height-1").height()+$(".contributing-to-height-report-info").height()+$(".contributing-to-height-scan-properties").height()+$(".source-page").height()+100;isNaN(e)||window.parent.postMessage(JSON.stringify(e),"*")}function v(e,t,n,o){var i=function(e,t){switch(e.substr(0,1)){case"i":return t.Identical;case"r":return t.RelatedMeaning;case"s":return t.Similar}}(e,t.matchesBeforeSplit),r=e.substr(e.lastIndexOf("_")+1);return S(n,underscore.find(i,function(e){return e.GID==r})["source"==o?"SoS":"SuS"])}function S(e,t){for(var n=e.length-1;0<n;n--){if(e[n]<=t)break}return n}function y(){h(),M(),E(),a.page1Control.setText(a.sourceText)}function w(){h(),R(),D(),I(),a.page2Control.setText(a.resultText)}function b(e){e.then(C,_,T)}function T(e){var t,n,o,i,r=e.type,s=e.params;switch(r){case"cb_process_info_success":!function(e){a.info=e,a.info.customFields&&a.info.customFields[0]&&"type"==a.info.customFields[0].Key&&"Textual"==a.info.customFields[0].Value||(a.sourceUrl=a.info.title);a.$emit("hideLabelIfRequestIsInTheFuture")}(s.info);break;case"cb_scanned_document_success":M(),E(),a.showDocument=!0;break;case"new_result_recieved":i=s.result,u.setSource(angular.merge({},i)),d.resultTitle=i.title;break;case"cb_result_ready":!function(){R(),D(),I(),E(),a.page1Control.setText&&a.page1Control.setText(a.sourceText);a.page2Control.setText&&a.page2Control.setText(a.resultText);F()}();break;case"cb_last_sourceRequestSent":break;case"cb_emptySources":!function(){if(d.info&&"Processing"!=d.info.status&&d.info.wordsCount){if(d.showStatisticControls){var e=l.getEmpty(d.info.wordsCount);N(),a.$emit("setControlToNoResultsState",e)}a.sourceListControl.showEmpty&&a.sourceListControl.showEmpty()}}();break;case"incoming_results":n=s.sources,o=underscore.find(n,function(e){return e.id==d.resultId}),u.setSource(angular.merge({},o)),d.resultTitle=o.title;break;case"result_matches_recieved":!function(e,t){if(e!=d.resultId)return;u.resultSuccess(t),x()}(s.suspectId,s.match);break;case"existing_result_with_matches":t=s.result,u.setSource(angular.merge({},t)),d.resultTitle=t.title,u.resultSuccess({comparison:t.matchesBeforeSplit,text:t.text,contentType:t.contentType,info:t.info,comparisonVersion:t.comparisonVersion}),x();break;default:c(function(){throw new Error("out of range: "+r)})}}function x(){a.result=u.getSource(),a.suspectResult=u.getSuspect(),R(),D(),F(),E(),I(),c(function(){a.page1Control.setText&&a.page1Control.setText(a.sourceText),a.page2Control.setText&&a.page2Control.setText(a.resultText)})}function C(e,t){}function _(e,t){switch(e){case"cb_scanned_document_error":t.response,a.showDocument=!1;break;case"cb_failed_to_get_resources":break;default:c(function(){throw new Error("out of range: "+e)})}}function k(){return p.isHtmlContentType(d.scanned_document.contentType)?0:a.sourcePaginationObject&&a.sourcePaginationObject.pagination?a.sourcePaginationObject.pagination.current-1:0}function P(){return p.isHtmlContentType(a.suspectResult.contentType)?0:a.suspectPaginationObject&&a.suspectPaginationObject.pagination?a.suspectPaginationObject.pagination.current-1:0}function M(){a.sourcePages=a.reportDataService.scanned_document.pages,a.sourceContentType=a.reportDataService.scanned_document.contentType,null==a.sourceContentType&&(a.sourceContentType=p.contentTypes.text),angular.extend(a.sourcePaginationObject.pagination,{current:parseInt(a.sourcePageIndex),total_pages:a.sourcePages.length,ready:!0}),a.$broadcast("updateNavigationButtons"),a.sourceText=a.sourceTextClean=a.sourcePages[k()]}function R(){a.result=u.getSource(),a.suspectResult=u.getSuspect(),a.sourcesForSource={},a.sourcesForSource[a.result.id]=a.result,a.sourcesForSuspect={},a.sourcesForSuspect[a.result.id]=a.suspectResult,a.sourcePaginationObject.results=a.sourcesForSource,a.suspectPaginationObject.results=a.sourcesForSuspect,a.comingFromTwoFilesCompare?a.suspectTitle="File 2":a.suspectTitle=a.result.title,a.suspectUrl=a.suspectResult.url}function D(){a.resultPages=d.suspectPages,a.resultPages&&(angular.extend(a.suspectPaginationObject.pagination,{current:parseInt(a.resultPageIndex),total_pages:a.resultPages.length,ready:!0}),s.$broadcast("updateNavigationButtons"),a.resultText=a.resultPages[P()],a.page2Control.setText&&a.page2Control.setText(a.resultText),a.comingFromTwoFilesCompare?a.sourceTitle="File 1":a.sourceTitle="Your text",f())}function O(){d.scrollToPagesPlease&&c(function(){d.scrollToPagesPlease=!1,$("html, body").scrollTop($(".contributing-to-height-page").offset().top)})}function E(){if(a.sourcesForSource){if(a.result){var e=k(),t=i.updateCurrentPageMatches([a.result],e,d.excludedRangesPerPage);a.sourceText=i.highlightText({text:a.sourceTextClean,matches:t,sources:a.sourcesForSource,mapType:"sourceToSuspect",reportType:"1to1",disableTooltip:!0,contentType:a.sourceContentType,pageType:d.pageTypes.source}),c(function(){r.scrollSource(a.page1Control),O()},300),a.sourcePaginationObject.control.recomputePageColors&&a.sourcePaginationObject.control.recomputePageColors(a.sourcesForSource)}}else a.page1Control.setText&&a.page1Control.setText(a.sourceText)}function I(){if(a.sourcesForSuspect&&a.suspectPaginationObject.pagination){var e=i.updateCurrentPageMatches([a.suspectResult],P());a.resultText=i.highlightText({text:a.resultText,matches:e,sources:a.sourcesForSuspect,mapType:"suspectToSource",reportType:"1to1",disableTooltip:!0,contentType:a.result.contentType,pageType:d.pageTypes.suspect}),c(function(){r.scrollSuspect(a.page2Control),O()},300),a.suspectPaginationObject.control.recomputePageColors&&a.suspectPaginationObject.control.recomputePageColors(a.sourcesForSuspect)}}function F(){if(d.showStatisticControls)var e=function(){if(d.info){n.log("word count: "+d.info.wordsCount);var e=d.info.wordsCount;return e&&l.haveDataForStatistics(a.sourcesForSource)?(n.log("sources for statistics: "),n.log(a.sourcesForSource),l.computeStatistics(a.sourcesForSource,e,d.excludedRangeCount)):null}}();N(e)}function N(e){n.log("updateChildrenControls"),e&&(n.log("got statistics"),a.$emit("showStatistics",e))}function B(){u.copySourceToOtherTypes(p.contentType.get(),p.contentType.getOther()),u.copySuspectToOtherTypes(p.contentType.get(),p.contentType.getOther()),p.contentType.switch(),m.switchReportContentType(p.contentType.get()),d.excludedRangesPerPage=null,p.scanned_document=null,delete a.suspectResult.matches,delete a.suspectResult.matchesBeforeSplit,delete a.result.matches,delete a.result.matchesBeforeSplit,a.switchingContentType=!0}d.type=d.reportTypes.singleSuspect,a.$emit("recalculateHeaderSegments"),a.oneToOneReportService=u,a.reportDataService=d,a.contentTypeService=p,a.resultId=d.resultId,d.pageNumSource||(d.pageNumSource=1),d.pageNumResult||(d.pageNumResult=1),h(),a.page1Control={},a.page2Control={},a.sourcePaginationObject={control:{},pagination:{ready:!1}},a.suspectPaginationObject={control:{},pagination:{ready:!1}},window.maxHeight&&$("html").css("maxHeight",window.maxHeight+"px"),a.$on("gotParentHeight",function(){$("html").css("maxHeight",window.maxHeight+"px")}),a.$on("switchToSingleSuspectReport",function(){a.deregisterAffix()}),c(f,1e3),a.$on("on-element-resized",function(){f()}),a.page1Selected=function(e){if(p.isHtmlContentType(a.result.contentType))a.page2Control.scrollToMatch(e);else{r.setSuspectMatchToScrollTo(e[0]);var t=v(e[0],a.suspectResult,d.suspectRanges,"suspect");a.suspectPaginationObject.pagination.current!=t+1?(a.suspectPaginationObject.pagination.current=t+1,a.resultPagechanged(!0)):r.scrollSuspect(a.page2Control)}},a.page2Selected=function(e){if(p.isHtmlContentType(a.sourceContentType))a.page1Control.scrollToMatch(e);else{r.setSourceMatchToScrollTo(e[0]);var t=v(e[0],a.suspectResult,d.scanned_document.ranges,"source");a.sourcePaginationObject.pagination.current!=t+1?(a.sourcePaginationObject.pagination.current=t+1,a.sourcePageChanged()):r.scrollSource(a.page1Control)}},a.$on("setSingleSuspectSourcePage",function(e,t){d.pageNumSource=a.sourcePaginationObject.pagination.current=t.pageNumber,y()}),a.sourcePageChanged=function(e){e||r.recordSuspectPageTopLocation(),rtDataService.pageNumSource=a.sourcePaginationObject.pagination.current,m.changeSingleSuspectSourcePage(d.pageNumSource),y()},a.$on("setSingleSuspectSuspectPage",function(e,t){d.pageNumResult=a.suspectPaginationObject.pagination.current=t.pageNumber,w()}),a.sourcePaginationObject.changed=a.sourcePageChanged,a.resultPagechanged=function(e){e||r.recordSourcePageTopLocation(),d.pageNumResult=a.suspectPaginationObject.pagination.current,m.changeSingleSuspectSuspectPage(d.pageNumResult),w()},a.suspectPaginationObject.changed=a.resultPagechanged,a.result=u.getSource(),a.suspectResult=u.getSuspect(),a.suspectResult&&a.result&&a.result.info&&a.result.info.ranges&&a.reportDataService.scanned_document&&(!p.contentType.get||(p.isHtmlContentType(a.result.contentType)?p.contentType.isHtml():p.contentType.isText()))?(b(g.registerToEvents()),function(){var e=new L;p.isHtmlContentType(a.result.contentType)?d.suspectRanges=[0]:d.suspectRanges=a.result.info.ranges;d.suspectPages=e.splitText(a.result.text,d.suspectRanges),M(),R(),D(),F(),E(),I(),c(function(){a.page1Control.setText&&a.page1Control.setText(a.sourceText),a.page2Control.setText&&a.page2Control.setText(a.resultText)})}()):b(g.registerToEvents()),a.suspectHasHtmlContentType=function(){return a.suspectResult.hasHtmlContentType},a.$on("switchContentType",function(e,t){B()}),a.switchContentType=function(){B(),m.switchReportContentType(p.contentType.get())}}])}function i(e){e.controller("reportController",["$scope","reportDataService","contentTypeService","reportServiceListener","$timeout","reportServiceMediator",function(e,t,n,o,i,r){function s(){o.onInfoReady(t.info),o.onDocumentReadyV2(t.scanned_document);var e=t.sources[t.resultId];o.deferred.notify({type:"existing_result_with_matches",params:{result:e}})}function a(){o.onInfoReady(t.info),o.onDocumentReadyV2(t.scanned_document),o.deferred.notify({type:"existing_results_with_matches",params:{result:t.sources}})}e.reportDataService=t,e.contentTypeService=n,e.showOneToOne=t.type==t.reportTypes.singleSuspect,e.goBack=function(){t.backButtonClicked()},e.$on("switchToSingleSuspectReport",function(){e.showOneToOne=!0,r.registered=s}),e.$on("switchToMultiSuspectReport",function(){e.showOneToOne=!1,r.registered=a})}])}function r(e){function t(n,e,t,o,i,r,s){n.showShareModal=function(){s.show()},n.reportDataService=i,n.statisticsControl={},n.scanPropertiesControl={},n.$on("showStatistics",function(e,t){n.scanPropertiesControl.statistics=t,n.statisticsControl.statistics=t,n.scanPropertiesControl.showStatistics&&n.scanPropertiesControl.showStatistics(t),n.statisticsControl.showStatistics&&n.statisticsControl.showStatistics(t)}),n.$on("setControlToNoResultsState",function(e,t){r.setControlToNoResultsState(n.scanPropertiesControl,t),r.setControlToNoResultsState(n.statisticsControl,t)}),n.$on("hideLabelIfRequestIsInTheFuture",function(){!function(){if(n.info&&n.info.requestTime){var e=moment(),t=moment.utc(n.info.requestTime);n.isRequestTimeInTheFuture=e<t?function(){return new moment<moment.utc(n.info.requestTime)||!(n.isRequestTimeInTheFuture=function(){return!1})}:function(){return!1}}}()})}t.$inject=["$scope","settingsService","logService","$element","reportDataService","utilitiesService","shareDialogService"],e.directive("cpEducationReportTopArea",[function(){return{restrict:"A",controller:t}}])}function s(e){function t(n,o,e,t,i,r,s,a,c,l,u,d){n.reportDataService=a,n.isShared=!!window.keyForToken,n.toggleBurger=function(){n.isBurgerMenuVisible=!n.isBurgerMenuVisible},n.control.setText=function(t){n.loaded=!0,o(function(){t=u.getIframeText(t);var e=c.find(".content-iframe")[0];$(e).attr("srcdoc",t)},100)},n.control.scrollToMatch=function(e){var t={matchId:e,type:"copyleaksMatchScrollRequest"},n=JSON.stringify(t),o=c.find(".content-iframe")[0];o&&o.contentWindow&&o.contentWindow.postMessage(n,"*")},n.text&&n.control.setText(n.text),t.initScopeForIframeZoom(n),n.clicked=function(e){var t=e.currentTarget.getAttribute("ranges");n.raiseFocusResults(t)},n.raiseFocusResults=function(e){n.focusResult({items:e})},n.toggleBurger=function(){n.isBurgerMenuVisible=!n.isBurgerMenuVisible},n.showShareModal=function(){s.show()},n.$watch("pageTitle",function(e,t){e!=t&&(n.showToolTip="Your text"!=e)}),window.addEventListener("message",function(e){if(!e||!e.data)return;var t=null;try{t=JSON.parse(e.data)}catch(e){return}if("copyleaksMatchClicked"!==t.type)return;if(t.pageType!=n.pageType)return;o(function(){n.raiseFocusResults(t.rangeIds)})},!1),n.download=function(){n.pageType==a.pageTypes.source?d.downloadSource():d.downloadSuspect()}}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","reportDataService","$element","pageService","iframeService","reportServiceMediator"],e.directive("cpOneToOneHtmlPage",["logService",function(e){return{restrict:"E",scope:{control:"=",text:"=",focusResult:"&",pageTitle:"=",pageType:"@",pageUrl:"=?",switchContentType:"&"},template:'<div class="panel panel-scanned-text panel-scanned-text-one-to-one parent-height" ng-clock><div class="burger-menu" ng-show="isBurgerMenuVisible"><div class="burger-menu-item" role="button"><a ng-click="zoom < maxZoom && zoomIn()" ng-class="{\'disabled\': zoom == maxZoom}"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">zoom_in</md-icon></a></div><div class="burger-menu-item" role="button"><a ng-click="zoom > minZoom && zoomOut()" ng-class="{\'disabled\': zoom == minZoom}"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">zoom_out</md-icon></a></div><div class="burger-menu-item" role="button" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a></div><div class="burger-menu-item" role="button" ng-if="pageUrl" aria-label="visit website"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="showShareModal()"><md-icon md-font-icon="link">share</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="switchContentType()"><md-icon md-font-icon="link">title</md-icon></a></div></div><div class="panel-heading" layout="row"><div class="one-to-one-page-title" flex><md-tooltip ng-if="showToolTip">{{pageTitle}}</md-tooltip>{{pageTitle}}</div><span class="hidden visible-when-burger"><a ng-click="toggleBurger()"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">menu</md-icon></a></span> <span class="hidden-when-burger"><a class="btn-share-report-mobile" ng-click="switchContentType()"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span> <span class="hidden-when-burger"><md-icon class="panel-heading-button-with-md-icon" ng-click="zoom > minZoom && zoomOut()" md-font-icon="link" ng-class="{\'disabled\': zoom == minZoom}">zoom_out</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom Out</md-tooltip></span> <span class="hidden-when-burger"><md-icon ng-click="zoom < maxZoom && zoomIn()" class="panel-heading-button-with-md-icon" md-font-icon="link" ng-class="{\'disabled\': zoom == maxZoom}">zoom_in</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom In</md-tooltip></span> <span class="hidden-when-burger" ng-if="pageUrl"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile" aria-label="visit website"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Visit Website</md-tooltip></span> <span class="hidden-when-burger" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span></div><div class="panel-body panel-body-html" ng-class="{\'results-panel-body\': !loaded || reportDataService.working, \'heigher\': !paginationObject || paginationObject.pagination.total_pages == 1 && otherPageObject.pagination.total_pages == 1}"><md-progress-circular md-mode="indeterminate" class="pull-left hide-during-angular-ng-leave" md-diameter="50px" ng-show="!loaded || reportDataService.working"></md-progress-circular><iframe class="content-iframe" sandbox="allow-scripts" seamless frameBorder="0" style="height:100%;width:100%;" ng-style="iframeStyle"></iframe></div></div>',controller:t,link:function(e,t,n){}}}])}e(t);var a=window.innerHeight;function c(e){function t(l,e,t,n,u,d,o,p,g,i,m,h,r){l.settings=t.instance,l.reportDataService=g,l.isShared=!!window.keyForToken,l.showShareModal=function(){o.show()},l.download=function(){r.downloadSource()},n.initScopeForIframeZoom(l);var f=null;function s(){if(d.log("refreshMatches() called."),g.scanned_document&&g.scanned_document.pages&&!h.isTextContentType(g.scanned_document.contentType)){var e,t=p.updateCurrentPageMatches(g.sources,0,g.excludedRangesPerPage);((e=t).identical&&0<e.identical.length||e.relatedMeaning&&0<e.relatedMeaning.length||e.similar&&0<e.similar.length)&&(l.isSwitchTypeVisible=!0);var n,o,i=(n=t,(o={}).identical=underscore.pluck(n.identical,"id"),o.similar=underscore.pluck(n.similar,"id"),o.relatedMeaning=underscore.pluck(n.relatedMeaning,"id"),o.similar=underscore.pluck(n.similar,"id"),o);if(!(f&&(s=f,v((r=i).identical,s.identical)&&v(r.similar,s.similar)&&v(r.relatedMeaning,s.relatedMeaning)))){var r,s;f=i,l.loaded=!0;var a=p.highlightText({text:g.scanned_document.pages[0],matches:t,sources:g.sources,mapType:"sourceToSuspect",disableTooltip:!0,contentType:h.contentTypes.html});a=m.getIframeText(a);var c=document.getElementById("sourceIframe");$(c).attr("srcdoc",a),u.$broadcast("registerAffix",{type:"html"})}}}function v(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;for(var n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}l.refreshMatches=s,g.scanned_document&&g.scanned_document.pages&&h.isHtmlContentType(g.scanned_document.contentType)&&s(),l.$on("isEmptySources",function(){l.isSwitchTypeVisible=!0}),window.addEventListener("message",function(e){if(!e||!e.data)return;var t=null;try{t=JSON.parse(e.data)}catch(e){return}if("copyleaksMatchClicked"!==t.type)return;l.clicked(t.rangeIds)},!1),l.askForRefresh=underscore.throttle(function(){d.log("Asked page matches to refresh"),l.refreshedNow?l.refreshedNow=!1:s()},3e4),l.clicked=function(e){if(1!=e.length||-1!=e[0]){var t=underscore.map(e,g.getSourceIdFromMatchId);l.focusResults({items:t})}},l.exitLocked=function(){l.focusResults({})}}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","pageService","reportDataService","$element","iframeService","contentTypeService","reportServiceMediator"],e.directive("cpHtmlPage",["logService","contentTypeService",function(o,i){return{restrict:"E",scope:{focusResults:"&",unfocus:"&",switchContentType:"&",text:"=?"},template:'<div class="panel panel-scanned-text parent-height"><div class="panel-heading" layout="row"><div flex></div><span class="hidden-when-burger"><md-icon ng-click="zoom < maxZoom && zoomIn()" class="panel-heading-button-with-md-icon" md-font-icon="link" ng-class="{\'disabled\': zoom == maxZoom}">zoom_in</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom In</md-tooltip></span> <span class="hidden-when-burger"><md-icon class="panel-heading-button-with-md-icon" ng-click="zoom > minZoom && zoomOut()" md-font-icon="link" ng-class="{\'disabled\': zoom == minZoom}">zoom_out</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Zoom Out</md-tooltip></span> <span ng-if="!isShared" class="hidden-when-burger"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span> <span><a class="btn-share-report-mobile hidden visible-xs-inline" ng-click="showShareModal()"><md-icon md-font-icon="link" class="panel-heading-button-with-md-icon">share</md-icon></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Share this report</md-tooltip></span> <span class="hidden-when-burger"><a class="btn-share-report-mobile" ng-click="isSwitchTypeVisible ? switchContentType() : angular.noop" ng-class="{\'disabeld-anchor\' : !isSwitchTypeVisible}"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span></div><div class="panel-body panel-body-html results-panel-body multi heigher"><md-progress-circular md-mode="indeterminate" class="hide-during-angular-ng-leave" md-diameter="50px" ng-show="!loaded || reportDataService.working"></md-progress-circular><iframe id="sourceIframe" width="100%" sandbox="allow-scripts" seamless frameBorder="0" style="max-height: 100%; height:100%" ng-style="iframeStyle"></iframe></div></div>',controller:t,link:function(e,t,n){e.$on("updatePageMatches",function(){i.contentType.isText()||(o.log("cp-page: currentMatches changed!"),e.askForRefresh())}),e.$on("updatePageMatchesNow",function(){i.contentType.isText()||(e.refreshMatches(),e.refreshedNow=!0)})}}}])}function l(e){e.directive("multiSuspectReport",[function(){return{restrict:"E",template:'<div ng-cloak class="parent-height contributing-to-height-page" ng-if="!reportDataService.isErrored" cp-on-resize><div flex-gt-lg="75" flex-gt-xs="67" flex="100" ng-if="contentTypeService.contentType.isText()" class="almost-parent-height" id="my-affix" ng-class="{\'no-pagination\': !document_pagination.ready || document_pagination.total_pages == 1}"><md-card layout="row" class="parent-height"><div flex class="parent-height overflow-x-hidden"><cp-page focus-results="focusResults(items)" unfocus="unfocusResults()" document-pagination="document_pagination" switch-content-type="switchToHtmlContentType()"></cp-page></div></md-card><div layout="row" class="pagination-row" ng-show="document_pagination.current > 0 && document_pagination.total_pages > 1"><div flex><cp-pagination2 pagination="document_pagination" control="paginationControl" on-changed="source_page_changed(pagination);" initial-sources="paginationObject.results"></cp-pagination2></div></div><div layout="row" class="one-to-one-footer my-target"><span>Powered by</span><a href="https://copyleaks.com" alt="Copyleaks.com"><img src="/images/small_logo_black.png"></a></div></div><div class="almost-parent-height no-pagination content-div" id="my-affix" ng-if="contentTypeService.contentType.isHtml()"><md-card layout="row" class="parent-height"><div flex class="parent-height overflow-x-hidden"><cp-html-page focus-results="focusResults(items)" unfocus="unfocusResults()" switch-content-type="switchToTextContentType()"></cp-html-page></div></md-card><div layout="row" class="pagination-row" ng-show="document_pagination.current > 0 && document_pagination.total_pages > 1"><div flex><cp-pagination2 pagination="document_pagination" control="paginationControl" on-changed="source_page_changed(pagination);" initial-sources="paginationObject.results"></cp-pagination2></div></div><div layout="row" class="one-to-one-footer my-target"><span>Powered by</span><a href="https://copyleaks.com" alt="Copyleaks.com"><img src="/images/small_logo_black.png"></a></div></div><div class="result-div"><md-card id="result-column-next-to-affix"><div layout="row"><div flex class="actual-results"><cp-sources sources="sources" selection-changed="updateCurrentPageMatchesAndStatistics()" locked-sources="lockedSources" pagination="document_pagination" control="sourceListControl"></cp-sources></div></div></md-card></div></div>',controller:"education-report-ctrl"}}])}function u(e){e.directive("cpOneToOneReport",[function(){return{restrict:"E",template:'<div class="container parent-height main-container"><div ng-cloak layout-xs="column" layout="row" class="parent-height contributing-to-height-page" ng-if="!reportDataService.isErrored" cp-on-resize><md-card flex-xs="100" flex-gt-xs="50" class="source-page one-to-one-page"><div class="parent-height overflow-x-hidden"><cp-one-to-one-page control="page1Control" ng-if="contentTypeService.contentType.isText()" text="sourceText" focus-result="page1Selected(items)" page-title="sourceTitle" page-url="sourceUrl" page-type="{{reportDataService.pageTypes.source}}" pagination-object="sourcePaginationObject" other-page-object="suspectPaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-page><cp-one-to-one-html-page control="page1Control" ng-if="contentTypeService.contentType.isHtml()" text="sourceText" focus-result="page1Selected(items)" page-title="sourceTitle" page-type="{{reportDataService.pageTypes.source}}" page-url="sourceUrl" pagination-object="sourcePaginationObject" other-page-object="suspectPaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-html-page></div></md-card><md-card flex-xs="100" flex-gt-xs="50" class="suspect-page one-to-one-page"><div class="parent-height overflow-x-hidden"><cp-one-to-one-page control="page2Control" text="resultText" ng-if="!result.contentType ||contentTypeService.isTextContentType(result.contentType)" focus-result="page2Selected(items)" page-title="suspectTitle" page-url="suspectUrl" page-type="{{reportDataService.pageTypes.suspect}}" pagination-object="suspectPaginationObject" other-page-object="sourcePaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-page><cp-one-to-one-html-page control="page2Control" text="resultText" ng-if="result.contentType && contentTypeService.isHtmlContentType(result.contentType)" focus-result="page2Selected(items)" page-title="suspectTitle" page-type="{{reportDataService.pageTypes.suspect}}" page-url="suspectUrl" pagination-object="suspectPaginationObject" other-page-object="sourcePaginationObject" switch-content-type="switchContentType()"></cp-one-to-one-html-page></div></md-card></div><div layout="row" class="one-to-one-footer"><span>Powered by</span><a href="https://copyleaks.com" alt="Copyleaks.com"><img src="/images/small_logo_black.png"></a></div></div>',controller:"one-to-one-ctrl"}}])}function d(e){function t(r,e,t,n,o,i,s,a,c,l,u){r.reportDataService=a,r.highlighted_text=r.text,r.isShared=!!window.keyForToken,r.paginationObject.control.getMaxPagination=n.getMaxPaginationOneToOne,r.download=function(){r.pageType==a.pageTypes.source?u.downloadSource():u.downloadSuspect()},r.control.setText=function(e){r.highlighted_text=e},r.control.findElement=function(e){return c.find(e)},r.clicked=function(e){!function(e){var t="copyleaksSelectedStyle"+(r.pageType==a.pageTypes.source?"Source":"Suspect"),n="."+e.join(".");window[t]&&(window[t].remove(),window[t]=null);var o=r.pageType==a.pageTypes.source?".source-page ":".suspect-page ",i=window[t]=document.createElement("style");i.type="text/css",i.innerHTML=o+n+"{border-bottom: 2px solid "+l.getColorForClassName(e)+"}",document.getElementsByTagName("head")[0].appendChild(i)}(e),r.focusResult({items:e})},r.settings=t.instance,r.pageSettings=t.instance[r.pageType],r.source_set_rtl=function(e){r.pageSettings.ui.rtlMode=e,t.set_settings(t.instance)},r.source_font_inc=function(){r.pageSettings.ui.fontSize+=1,r.pageSettings.ui.fontSize=Math.min(r.pageSettings.ui.fontSize,35),t.set_settings(t.instance)},r.source_font_dec=function(){r.pageSettings.ui.fontSize-=1,r.pageSettings.ui.fontSize=Math.max(5,r.pageSettings.ui.fontSize),t.set_settings(t.instance)},r.toggleBurger=function(){r.isBurgerMenuVisible=!r.isBurgerMenuVisible},r.showShareModal=function(){s.show()},r.$watch("pageTitle",function(e,t){e!=t&&(r.showToolTip="Your text"!=e)})}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","reportDataService","$element","pageService","reportServiceMediator"],e.directive("cpOneToOnePage",["logService",function(e){return{restrict:"E",scope:{control:"=",text:"=",focusResult:"&",pageTitle:"=",pageType:"@",paginationObject:"=",otherPageObject:"=",switchContentType:"&",pageUrl:"=?"},template:'<div class="panel panel-scanned-text parent-height" ng-clock><div class="burger-menu" ng-show="isBurgerMenuVisible" ng-clock><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/format_align_left/white@3x.svg" ng-click="source_set_rtl(false)"></div><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/format_align_right/white@3x.svg" ng-click="source_set_rtl(true)"></div><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/FontSizeUp/white@3x.svg" ng-click="source_font_inc()"></div><div class="burger-menu-item" role="button"><img src="/images/compare-education/formating/FontSizeDown/white@3x.svg" ng-click="source_font_dec()"></div><div class="burger-menu-item" role="button" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a></div><div class="burger-menu-item" role="button" ng-if="pageUrl && pageUrl != \'Uploaded text\'" aria-label="visit website"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="showShareModal()"><md-icon md-font-icon="link">share</md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="downloadPdfReport()"><md-icon md-svg-src="/images/compare-education/Report@3x.svg" aria-label="download report in pdf format"></md-icon></a></div><div class="burger-menu-item" role="button"><a class="btn-share-report-mobile" ng-click="!reportDataService.textOnly &&switchContentType()" ng-class="{\'disabeld-anchor\' : reportDataService.textOnly}"><md-icon md-font-icon="link" class="clicked-panel-button">title</md-icon></a></div></div><div class="panel-heading" layout="row"><div class="one-to-one-page-title" flex><md-tooltip ng-if="showToolTip">{{pageTitle}}</md-tooltip>{{pageTitle}}</div><span class="hidden-when-burger"><a class="btn-share-report-mobile" ng-click="!reportDataService.textOnly ? switchContentType() : angular.noop" ng-class="{\'disabeld-anchor\' : reportDataService.textOnly }"><md-icon class="panel-heading-button-with-md-icon clicked-panel-button" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/format_align_left/white@3x.svg" ng-click="source_set_rtl(false)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Left</md-tooltip></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/format_align_right/white@3x.svg" ng-click="source_set_rtl(true)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Right</md-tooltip></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/FontSizeUp/white@3x.svg" ng-click="source_font_inc()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Increase Font Size</md-tooltip></span> <span class="hidden-when-burger"><img src="/images/compare-education/formating/FontSizeDown/white@3x.svg" ng-click="source_font_dec()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Decrease Font Size</md-tooltip></span> <span class="hidden-when-burger" ng-if="pageUrl && pageUrl != \'Uploaded text\'"><a ng-href="{{pageUrl}}" class="btn-share-report-mobile" aria-label="visit website"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">launch</md-icon></a><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Visit Website</md-tooltip></span> <span class="hidden-when-burger" ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span> <span class="hidden visible-when-burger"><a ng-click="toggleBurger()"><md-icon class="panel-heading-button-with-md-icon" md-font-icon="link">menu</md-icon></a></span></div><div class="panel-body panel-body-scrollable flexcroll" ng-class="{\'heigher\': paginationObject.pagination.total_pages == 1 && otherPageObject.pagination.total_pages == 1, \'results-panel-body\': !highlighted_text || reportDataService.working}"><md-progress-circular md-mode="indeterminate" class="pull-left hide-during-angular-ng-leave" md-diameter="50px" ng-show="!highlighted_text || reportDataService.working"></md-progress-circular><pre ng-show="highlighted_text" ng-bind-html-compile="highlighted_text | unsafe" compile-tags="span" style="font-size: {{ pageSettings.ui.fontSize }}px;" ng-class="{\'rtl-mode\': pageSettings.ui.rtlMode, \'identical-on\': settings.showIdentical, \'similar-on\': settings.showSimilar, \'related-on\': settings.showRelated}"></pre></div><div class="panel-footer" ng-hide="!highlighted_text || paginationObject.pagination.total_pages == 1 && otherPageObject.pagination.total_pages == 1"><div class="one-to-one-pagination-row"><cp-pagination2 pagination="paginationObject.pagination" control="paginationObject.control" on-changed="paginationObject.changed()" initial-sources="paginationObject.results"></cp-pagination2></div></div></div>',controller:t,link:function(e,t,n){}}}])}function p(e){function t(n,e,t,o,i,r,s,a,c,l,u){function d(){if(r.log("refreshMatches() called."),c.scanned_document&&c.scanned_document.pages&&n.documentPagination.ready){var e=a.updateCurrentPageMatches(c.sources,n.documentPagination.current-1,c.excludedRangesPerPage),t=c.scanned_document.pages[n.documentPagination.current-1];(0<o.length(c.sources)||c.noMatches)&&(n.isSwitchTypeVisible=!0),n.highlighted_text=a.highlightText({text:t,matches:e,sources:c.sources,mapType:"sourceToSuspect"}),i.$broadcast("registerAffix",{type:"text"})}}if(n.settings=t.instance,n.reportDataService=c,n.isShared=!!window.keyForToken,n.showShareModal=function(){s.show()},n.download=function(){u.downloadSource()},n.shouldHide=function(){return!c.scanned_document||(!!l.contentType.isHtml()||!!l.isHtmlContentType(c.scanned_document.contentType))},n.refreshMatches=d,c.scanned_document&&c.scanned_document.pages)try{n.shouldHide()||d()}catch(e){}n.askForRefresh=underscore.throttle(function(){n.askedForRefresh&&(r.log("Asked page matches to refresh"),d())},15e3),n.clicked=function(e){if(1!=e.length||-1!=e[0]){!function(e){var t="."+e.join(".");window.copyleaksSelectedStyle&&(window.copyleaksSelectedStyle.remove(),window.copyleaksSelectedStyle=null);var n=window.copyleaksSelectedStyle=document.createElement("style");n.type="text/css",n.innerHTML=t+"{border-bottom: 2px solid "+a.getColorForClassName(e)+"}",document.getElementsByTagName("head")[0].appendChild(n)}(e);var t=underscore.map(e,c.getSourceIdFromMatchId);n.focusResults({items:t})}},n.exitLocked=function(){n.focusResults({})},n.source_set_rtl=function(e){t.instance.ui.rtlMode=e,t.set_settings(t.instance)},n.source_font_inc=function(){t.instance.ui.fontSize+=1,t.instance.ui.fontSize=Math.min(t.instance.ui.fontSize,35),t.set_settings(t.instance)},n.source_font_dec=function(){t.instance.ui.fontSize-=1,t.instance.ui.fontSize=Math.max(5,t.instance.ui.fontSize),t.set_settings(t.instance)}}t.$inject=["$scope","$timeout","settingsService","utilitiesService","$rootScope","logService","shareDialogService","pageService","reportDataService","contentTypeService","reportServiceMediator"],w(e),e.directive("cpPage",["logService","contentTypeService",function(o,e){return{restrict:"E",scope:{focusResults:"&",unfocus:"&",documentPagination:"=",switchContentType:"&"},template:'<div class="panel panel-scanned-text" layout="column"><div class="panel-heading" layout="row"><div flex></div><span><img src="/images/compare-education/formating/format_align_left/white@3x.svg" ng-click="source_set_rtl(false)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Left</md-tooltip></span> <span><img src="/images/compare-education/formating/format_align_right/white@3x.svg" ng-click="source_set_rtl(true)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Align Right</md-tooltip></span> <span><img src="/images/compare-education/formating/FontSizeUp/white@3x.svg" ng-click="source_font_inc()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Increase Font Size</md-tooltip></span> <span><img src="/images/compare-education/formating/FontSizeDown/white@3x.svg" ng-click="source_font_dec()"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Decrease Font Size</md-tooltip></span> <span ng-if="!isShared"><a ng-click="download()"><img src="/images/compare-education/formating/file_download/white@3x.svg"></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Download Your Text</md-tooltip></span> <span><a class="btn-share-report-mobile hidden visible-xs-inline" ng-click="showShareModal()"><md-icon md-font-icon="link" class="panel-heading-button-with-md-icon">share</md-icon></a><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Share this report</md-tooltip></span> <span><a ng-class="{\'disabeld-anchor\' : reportDataService.textOnly || !isSwitchTypeVisible}"><md-icon class="panel-heading-button-with-md-icon" ng-click="!reportDataService.textOnly && isSwitchTypeVisible? switchContentType() : angular.noop()" md-font-icon="link">title</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">Switch between html and text view</md-tooltip></a></span></div><div class="panel-body flexcroll" ng-class="{\'results-panel-body\': !highlighted_text}" flex><div class="text-page-loading-container"><md-progress-circular md-mode="indeterminate" class="hide-during-angular-ng-leave text-loading-indicator" md-diameter="50px" ng-show="!highlighted_text || reportDataService.working"></md-progress-circular></div><pre ng-show="highlighted_text" ng-bind-html-compile="highlighted_text | unsafe" compile-tags="span" style="font-size: {{ settings.ui.fontSize }}px;" ng-class="{\'rtl-mode\': settings.ui.rtlMode, \'identical-on\': settings.showIdentical, \'similar-on\': settings.showSimilar, \'related-on\': settings.showRelated}"></pre></div></div>',controller:t,link:function(e,t,n){e.askedForRefresh=!1,e.$on("updatePageMatches",function(){e.shouldHide()||(o.log("cp-page: currentMatches changed!"),e.askedForRefresh=!0,e.askForRefresh())}),e.$on("updatePageMatchesNow",function(){e.shouldHide()||(e.askedForRefresh=!1,e.refreshMatches())})}}}])}function g(e){function t(s,a,c,e,t){function n(){void 0===s.pagination.current&&(s.pagination.current=s.savedCurrent)}function o(){if(void 0!==s.pagination.current&&1<s.pagination.current)for(var e=s.pagination.current-2;0<=e;e--)if(s.pagesToHighlight[e]!=l.noMatch)return{index:e+1,matchType:s.pagesToHighlight[e]}}function i(){if(void 0!==s.pagination.current&&s.pagination.current<s.pagination.total_pages)for(var e=s.pagination.current,t=s.pagination.total_pages,n=e;n<t;n++)if(s.pagesToHighlight[n]!=l.noMatch)return{index:n+1,matchType:s.pagesToHighlight[n]}}function r(){s.onChanged({pagination:s.pagination}),s.setNextMatchesButtons()}s.pagesToHighlight=[],s.pagination.ready&&(s.savedCurrent=s.pagination.current),s.source_next=function(){s.pagination.ready&&(n(),void 0!==s.pagination&&s.pagination.total_pages!==s.pagination.current&&(s.pagination.current+=1,r()))},s.source_back=function(){s.pagination.ready&&(n(),void 0===s.pagination||s.pagination.current<=1||(s.pagination.current-=1,r()))},s.findMatchBackwards=function(){if(s.pagination.ready&&(n(),!(s.pagination.total_pages<=1))){var e=o();e&&(s.pagination.current=e.index,r())}},s.findMatchForwards=function(){if(s.pagination.ready&&(n(),s.pagination.current!==s.pagination.total_pages)){var e=i();e&&(s.pagination.current=e.index,r())}},s.page_changed=function(){null!=s.pagination.current?r():s.pagination.current=s.savedCurrent},s.updateNavButtons=function(){if(a.log("updateNavButtons() called"),null!=s.pagination.current){if(!s.pagination.ready)return s.source_next_disabled=!1,void(s.source_back_disabled=!1);s.source_next_disabled=s.pagination.total_pages===s.pagination.current,s.source_back_disabled=1===s.pagination.current}},s.setNextMatchesButtons=function(){var e=i();s.isExistMatchesForward=!!e;var t=o();s.isExistMatchesBackward=!!t},s.isExistMatchesBackward=!1,s.isExistMatchesForward=!1,s.$on("updateNavigationButtons",function(){s.updateNavButtons()}),s.updateNavButtons();var l={noMatch:0,related:3,similar:2,identical:1};function u(e){var t=c.instance;if(t&&s.pagination.ready&&e){a.log("cpPagination: highlightByPage");var n,o=[];e=underscore.filter(e,function(e){return e.is_active&&0==e.status}),e=underscore.sortBy(e,"totalMatchedWords").reverse();for(var i=s.pagination.total_pages,r=0;r<i;++r){if(o[r]=l.noMatch,t.showIdentical)for(n=0;n<e.length;n++)if(e[n].matches&&e[n].matches.identical&&0<e[n].matches.identical[r].length){o[r]=l.identical;break}if(o[r]==l.noMatch){if(t.showSimilar)for(n=0;n<e.length;n++)if(e[n].matches&&e[n].matches.similar&&0<e[n].matches.similar[r].length){o[r]=l.similar;break}if(o[r]==l.noMatch&&t.showRelated)for(n=0;n<e.length;n++)if(e[n].matches&&e[n].matches.relatedMeaning&&0<e[n].matches.relatedMeaning[r].length){o[r]=l.related;break}}}s.pagesToHighlight=o,s.setNextMatchesButtons()}}s.control.recomputePageColors=underscore.debounce(function(e){a.log("cpPagination: recomputePageColors"),s.$apply(function(){u(e)})},1e3),s.initialSources&&u(s.initialSources)}t.$inject=["$scope","logService","settingsService","$window","utilitiesService"],e.directive("cpPagination2",function(){return{restrict:"E",scope:{pagination:"=",onChanged:"&",control:"=",initialSources:"=?"},template:'<div class="pagination2"><div class="pagination-back"><md-button class="md-icon-button hide-when-really-small" aria-label="First page" ng-click="findMatchBackwards()" ng-disabled="!isExistMatchesBackward"><md-icon md-font-icon="link">first_page</md-icon><md-tooltip md-direction="top">Go to previous page with matches</md-tooltip></md-button><md-button class="md-icon-button" aria-label="More" ng-click="source_back()" ng-disabled="source_back_disabled"><md-icon md-font-icon="link">navigate_before</md-icon></md-button></div><div class="pagination-center"><md-input-container><input type="number" ng-model="pagination.current" ng-change="page_changed()" ng-model-options="{ updateOn: \'blur\'}" min="1" max="{{pagination.total_pages}}" update-on-enter class="text-center"></md-input-container><span>of &nbsp;&nbsp;{{pagination.total_pages}}</span></div><div class="pagination-forward"><md-button class="md-icon-button" aria-label="First page" ng-click="source_next()" ng-disabled="source_next_disabled"><md-icon md-font-icon="link">navigate_next</md-icon></md-button><md-button class="md-icon-button hide-when-really-small" aria-label="More" ng-click="findMatchForwards()" ng-disabled="!isExistMatchesForward"><md-icon md-font-icon="link">last_page</md-icon><md-tooltip md-direction="top">Go to next page with matches</md-tooltip></md-button></div></div>',controller:t,link:function(n,e,t){n.$watch("pagination.current",function(e,t){e!=t&&void 0!==e&&(n.savedCurrent=e,n.updateNavButtons())},!0)}}}),e.directive("updateOnEnter",function(){return{restrict:"A",require:"ngModel",link:function(t,e,n,o){e.bind("keyup",function(e){13==e.keyCode&&(o.$commitViewValue(),t.$apply(function(){o&&o.$setTouched()}))})}}})}function m(e){e.directive("cpReportInfo",[function(){return{restrict:"E",template:'<div layout="column" layout-gt-xs="row" class="report-info contributing-to-height-report-info" ng-hide="hideReportInfo"><a ng-click="raiseIconClick()" hide-xs><div class="report-type-image"><img ng-src="{{reportDataService.reportIcon}}"></div></a><div layout="row" flex><div class="scan-title" flex layout="column"><h1 class="ellipsis-text" ng-cloak flex>{{reportDataService.reportTitle}}</h1><div class="compare-image-height-filler" ng-if="reportDataService.isErrored"></div><div class="scan-metadata" ng-if="getScanTime()"><time ng-if="isRequestTimeInTheFuture()">a few seconds ago</time><time ng-if="!isRequestTimeInTheFuture()" am-time-ago="getScanTime() | amUtc | amLocal"></time></div></div><div class="suspected-info-border" ng-hide="hideStatistics" ng-if="!reportDataService.isErrored"><cp-statistics control="statisticsControl" ng-if="reportDataService.showStatisticControls"></cp-statistics></div><md-button class="suspected-info btn-share-report" ng-if="!reportDataService.isErrored && reportDataService.showShareButton && reportDataService.scanProgressPercents == 100" ng-class="{\'hidden-when-burger\': reportDataService.type== reportDataService.reportTypes.singleSuspect, \'multi\': reportDataService.type== reportDataService.reportTypes.multipleSuspects}" ng-click="showShareModal()" layout="row" layout-align="center center"><md-icon md-font-icon="link">share</md-icon><span class="hide-sm">Share</span></md-button><md-button class="suspected-info download btn-share-report" ng-if="!reportDataService.isErrored && reportDataService.showDownloadPdfReportButton && reportDataService.scanProgressPercents == 100" ng-class="{\'hidden-when-burger\': reportDataService.type== reportDataService.reportTypes.singleSuspect, \'multi\': reportDataService.type== reportDataService.reportTypes.multipleSuspects}" ng-click="downloadPDF()" layout="row" layout-align="center center"><md-icon md-svg-src="/images/compare-education/Report@3x.svg" aria-label="download report in pdf format"></md-icon><span class="hide-sm">Download</span></md-button></div></div>',controller:["$scope","reportServiceMediator",function(e,t){e.hideReportInfo=window.hideTitleSectionCompletely,e.raiseIconClick=function(){t.iconButtonClicked()},e.getScanTime=function(){return e.reportDataService.info&&e.reportDataService.info.requestTime&&!e.reportDataService.isErrored?e.reportDataService.info.requestTime:null}}]}}])}function h(e){e.directive("cpOnResize",["$rootScope","$timeout",function(o,i){return{restrict:"A",link:function(t,n,e){"undefined"!=typeof ResizeSensor&&i(function(){var e=new ResizeSensor(n[0],function(){i(function(){o.$broadcast("on-element-resized")})});t.$on("$destroy",function(){e.detach()})},500)}}}])}function f(e){e.directive("report",[function(){return{restrict:"E",scope:{},template:'<div class="report-container container parent-height full-width" cp-education-report-top-area ng-class="{\'one-to-one\' : showOneToOne, \'parent-height-desktop\': parentHeight, \'html-report\': contentTypeService.contentType.isHtml()}"><cp-report-info></cp-report-info><cp-scan-progress></cp-scan-progress><div layout="row" class="contributing-to-height-error error-container" ng-if="reportDataService.isErrored" ng-cloak><div flex><div class="bs-callout bs-callout-warning"><h4 class="normal-font-weight">Scanning Problem</h4><p>{{reportDataService.ErrorMessage}}</p></div></div></div><div layout="row" class="cp-affix-parent contributing-to-height-scan-properties" ng-if="!reportDataService.isErrored"><div flex="100" hide-xs ng-hide="hide"><cp-scan-properties control="scanPropertiesControl"></cp-scan-properties></div></div><div class="parent-height"><div class="almost-parent-height-one-to-one" ng-class="{\'margin-top-20\' : hidePropertiesSectionCompletely}" ng-if="showOneToOne"><cp-one-to-one-report></cp-one-to-one-report></div><div class="parent-height" ng-class="{\'margin-top-20\' : hidePropertiesSectionCompletely}" ng-if="!showOneToOne"><multi-suspect-report></multi-suspect-report></div></div></div>',controller:"reportController"}}])}function v(e){e.directive("cpScanProgress",[function(){return{restrict:"E",template:'<div ng-if="reportDataService.scanProgressPercents < 100 && !reportDataService.isErrored" ng-cloak layout="row" class="contributing-to-height-scan-progress scan-progress"><div flex="100"><div class="panel panel panel-progress"><div class="panel-heading"><i class="fa fa-hourglass-start" aria-hidden="true"></i> Scanning Status</div><div class="panel-body"><md-progress-linear md-mode="determinate" value="{{reportDataService.scanProgressPercents}}"></md-progress-linear><div class="text-center"><div ng-if="reportDataService.scanProgressPercents <= 5">Analyzing your content...</div><div ng-if="reportDataService.scanProgressPercents > 5 && reportDataService.scanProgressPercents <= 30">Searching more than 30 billion pages online to find matches...</div><div ng-if="reportDataService.scanProgressPercents > 30 && reportDataService.scanProgressPercents < 95">Comparing your text...</div><div ng-if="reportDataService.scanProgressPercents >= 95 && true">Final touches</div><div ng-if="reportDataService.scanProgressPercents >= 95 && (comingFromEducationUiReport || comingFromEducationReport)">Calculating score...</div></div></div></div></div></div>'}}])}function S(e){function t(t,e,n,o,i,r){t.hide=window.hidePropertiesSectionCompletely,t.reportDataService=i,t.graphControl={},t.graphLegendControl={},t.panelVisible=!0,t.togglePanel=function(){$("#scan-properties").slideToggle(),t.panelVisible=!t.panelVisible},t.control.statistics&&(t.graphControl.statistics=t.control.statistics,t.graphLegendControl.statistics=t.control.statistics),t.control.showStatistics=function(e){t.graphControl.statistics=e,t.graphLegendControl.statistics=e,t.graphControl.showStatistics&&t.graphControl.showStatistics(e),t.graphLegendControl.showStatistics&&t.graphLegendControl.showStatistics(e)},t.control.showEmpty=function(e){r.setControlToNoResultsState(t.graphControl,e),r.setControlToNoResultsState(t.graphLegendControl,e)},t.control.isEmpty&&t.control.showEmpty(t.control.emptyResults)}t.$inject=["$scope","settingsService","logService","$element","reportDataService","utilitiesService"],e.directive("cpScanProperties",[function(){return{restrict:"E",scope:{control:"="},template:'<md-card><div class="panel panel-properties" ng-class="{\'when-status-is-shown\': reportDataService.scanProgressPercents < 100 }"><md-button ng-click="togglePanel()"><span>Scan Properties</span> <i class="material-icons" ng-show="panelVisible">expand_less</i> <i class="material-icons" ng-show="!panelVisible">expand_more</i></md-button><div id="scan-properties" class="in top-border"><div layout="row" layout-fill><div flex-gt-md="67" flex-md="58" flex-xs="42" flex><div class="panel-body"><div>Words in Document: {{reportDataService.info.wordsCount | number }}</div><div><span ng-if="reportDataService.excludedRangeCount > 0">Omitted Words: {{reportDataService.excludedRangeCount | number}}</span></div><div ng-if="reportDataService.type== reportDataService.reportTypes.multipleSuspects && reportDataService.sourceCount > 0">Results Found: {{reportDataService.sourceCount | number }}</div></div></div><div flex-gt-md="11" flex-md="21" flex-xs="27"><cp-graph control="graphControl"></cp-graph></div><div flex-gt-md="22" flex-md="21" flex-xs="27"><cp-graph-legend control="graphLegendControl"></cp-graph-legend></div></div></div></div></md-card>',controller:t}}])}function y(e){function t(s,n,a,o,t,i,r,e,c,l,u){s.settings=a.instance,s.MODE_NORMAL=0,s.MODE_LOCKED=1,s.mode=s.MODE_NORMAL,s.sourcesToShow=[],s.numOfSources=0,s.totalSources=0,function(){function e(){var e=$(".actual-results");e.stop(),e.animate({height:"100%",top:0,bottom:"auto"},300,function(){o(function(){s.sourcesVisible=!0,e.css("overflow","auto")})})}$(window).scroll(function(){768<=$(window).width()||s.sourcesVisible||o(function(){s.hideSources()})}),$(window).resize(function(){s.isMobile=$(window).width()<768,768<=$(window).width()?s.sourcesVisible||e():s.sourcesVisible||o(function(){s.hideSources()})}),s.toggleSourcesVisibility=function(e){768<=$(window).width()||(e.stopPropagation(),s.sourcesVisible?s.hideSources():s.showSources())},s.hideSources=function(){if(!(768<=$(window).width())){var e=$("#sources-panel-heading").outerHeight(),t=$(".actual-results");t.stop(),t.css("overflow","hidden"),s.sourcesVisible?t.animate({top:window.innerHeight},300,function(){o(function(){t.height(e),t.css("bottom",0),t.css("top","auto"),s.sourcesVisible=!1})}):(t.height(e),t.css("top","auto"),t.animate({bottom:0},300,function(){o(function(){s.sourcesVisible=!1})})),n.clearObject(s.lockedSources),s.mode=s.MODE_NORMAL,s.refreshSources()}},s.showSources=function(){768<=$(window).width()||e()},s.control.show=s.showSources,s.isMobile=$(window).width()<768,o(s.hideSources,2e3)}(),s.update_source_status=function(){s.selectionChanged({})},s.refreshSources=function(){if(i.log("cpSources: refreshSources"),s.totalSources=Object.keys(s.sources).length,s.lockedSources&&0<Object.keys(s.lockedSources).length){var e=[];for(var t in s.sources)t in s.lockedSources&&e.push(s.sources[t]);s.numOfSources=e.length,s.mode=s.MODE_LOCKED,s.sourcesToShow=e}else if(s.pagination){var n=function(){var e,t=[],n=s.pagination.current-1,o=!1,i=a.getMaxSourcesWithMatches(s.sources);if(0<i.length)if(a.instance.showPageSources){for(var r in i)(e=i[r]).hasOwnProperty("matches")||(o=!0),0===e.status&&e.hasOwnProperty("matches")&&(e.matches.identical&&e.matches.identical[n]&&0<e.matches.identical[n].length?t.push(e):e.matches.similar&&e.matches.similar[n]&&0<e.matches.similar[n].length?t.push(e):e.matches.relatedMeaning&&e.matches.relatedMeaning[n]&&0<e.matches.relatedMeaning[n].length&&t.push(e));s.isPageEmpty=0==t.length&&!o}else for(var r in i)e=i[r],t.push(e);return t}();s.numOfSources=n.length,s.mode=s.MODE_NORMAL,s.sourcesToShow=n}else s.numOfSources=Object.keys(s.sources).length,s.sourcesToShow=underscore.map(s.sources,function(e){return e})},s.goToSingleSuspectReport=function(e){e.status==c.eSourceStatus.completed&&(r.resultId=e.id,l.$broadcast("switchToSingleSuspectReport"))},s.changeVisibilityAndUpdateIfEnter=function(e,t){13===e.keyCode&&s.changeVisibilityAndUpdate(t)},s.changeVisibilityAndUpdate=function(e){s.changeSourceVisibilityStatus(e),s.update_source_status()},s.changeSourceVisibilityStatus=function(e){e.is_active=!e.is_active},s.exitLockedModeIfNotInMobile=function(e){s.exitLockedMode(e)},s.exitLockedMode=function(e){e.stopPropagation(),n.clearObject(s.lockedSources),s.mode=s.MODE_NORMAL,s.refreshSources()},s.showSettings=function(e){e.stopPropagation(),u.show()},s.showFilter=function(e){e.stopPropagation(),t.show()},s.control.refresh=n.throttleWithGuaranteedLastRun(function(){null!=s.sources&&s.refreshSources()},1e3),s.control.showEmpty=function(){s.isEmpty=!0},s.reportDataService=r}t.$inject=["$scope","utilitiesService","settingsService","$timeout","filterDialogService","logService","reportDataService","contentTypeService","DataService","$rootScope","settingsDialogService"],w(e),e.directive("cpSources",["logService",function(o){return{restrict:"E",scope:{sources:"=",selectionChanged:"&",lockedSources:"=",pagination:"=",control:"="},template:'<div id="sources" class="panel panel-default panel-sources actual-results-height"><div class="panel-heading" id="sources-panel-heading" ng-click="toggleSourcesVisibility($event)" layout="row"><span flex="none" class="visible-xs-inline" id="sources-visibility-toggle" ng-click="toggleSourcesVisibility($event)" ng-class="{\'up-arrow\': !sourcesVisible, \'down-arrow\': sourcesVisible}"></span> <span flex ng-show="mode === MODE_NORMAL" class="mode-normal">Results</span> <span flex="none" ng-show="mode === MODE_LOCKED" class="mode-locked" ng-click="exitLockedMode($event);" ng-if="!isMobile">Results ({{numOfSources}} of {{totalSources}})</span> <span flex="none" ng-show="mode === MODE_LOCKED" ng-if="isMobile">Results ({{numOfSources}} of {{totalSources}})</span><div flex="none"><span><img src="/images/compare-education/filter_list/white@3x.svg" class="pointer" ng-click="showFilter($event)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Filter Results</md-tooltip></span> <span><img src="/images/compare-education/settings/white@3x.svg" class="pointer" ng-click="showSettings($event)"><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500">Settings</md-tooltip></span></div></div><div class="panel-body"><div ng-if="isEmpty"><div class="no-results-div text-center"><img src="/images/compare-education/PilgarFree05.png" height="180"><div class="no-results-text">Plagiarism Free</div></div></div><div ng-if="!isEmpty && isPageEmpty"><div class="no-results-div text-center"><img src="/images/compare-education/PilgarFreeOne Page.png" height="180"><div class="no-results-text">This Page Is Plagiarism Free</div></div></div><md-card class="source-card" md-theme="default" md-theme-watch ng-repeat="source in sourcesToShow | orderBy:\'-totalMatchedWords\' track by $index" ng-class="{\'unchecked-source\': !source.is_active}"><md-card-title><md-card-title-text><div class="md-headline" layout="row"><div flex><div ng-show="source.status"><md-tooltip md-direction="bottom" md-delay="500">Loading matches...</md-tooltip><md-progress-circular md-mode="indeterminate" md-diameter="25px"></md-progress-circular></div><a class="title" ng-class="{\'rtl-mode\': settings.ui.rtlMode}" ng-click="goToSingleSuspectReport(source)" ng-if="!source.singleSuspectLink">{{ source.title }}</a> <a class="title" ng-class="{\'rtl-mode\': settings.ui.rtlMode}" ng-href="{{source.singleSuspectLink}}" ng-if="source.singleSuspectLink">{{ source.title }}</a></div><md-button class="md-icon-button visibility-toggle-wrapper" ng-class="{\'pull-left\': settings.ui.rtlMode}" aria-label="Toggle source visibility" ng-click="changeVisibilityAndUpdate(source)" ng-keypress="changeVisibilityAndUpdateIfEnter($event,source)"><md-icon ng-if="source.is_active" md-svg-icon="/images/compare-education/visibility/googblue@3x.svg"></md-icon><md-icon ng-if="!source.is_active" md-svg-icon="/images/compare-education/visibility_off/grey600@3x.svg"></md-icon><md-tooltip md-direction="bottom" md-autohide="true" md-delay="500"><span ng-show="source.is_active">Hide</span> <span ng-show="!source.is_active">Show</span></md-tooltip></md-button></div></md-card-title-text></md-card-title><md-card-content><span class="md-subhead block-with-text" ng-class="{\'rtl-mode\': settings.ui.rtlMode}">{{ source.introduction }}</span><div class="source-url"><a ng-show="source.url.startsWith(\'http\')" href="{{source.url}}" target="_blank">{{ source.url | removeProtocol}}<md-tooltip md-direction="left" md-delay="300">{{ source.url }}</md-tooltip></a> <span ng-show="!source.url.startsWith(\'http\')">{{source.url}}<md-tooltip md-direction="left" md-delay="300">{{ source.url }}</md-tooltip></span></div><div class="source-stat" ng-show="source.status === 0"><hr><span class="percent" ng-class="{\'low\': source.totalMatchedPercents<= 20 , \'medium\': source.totalMatchedPercents<= 60 && source.totalMatchedPercents>=21, \'high\': source.totalMatchedPercents> 60}"><span>{{ source.totalMatchedWords | prettyNumberWithK }}<md-tooltip ng-if="source.totalMatchedWords > 999" class="multiline" md-direction="bottom" md-delay="500">{{ source.totalMatchedWords | prettyNumber }}</md-tooltip></span> similar words ({{source.totalMatchedPercents}}%)</span><div class="pull-right"><md-tooltip class="multiline" md-delay="500" md-direction="left"><div ng-show="source.matches.identicalWordsCounter > 0"><span class="identical-color">Identical {{ source.matches.identicalWordsCounter }} words</span> <span ng-show="!settings.showIdentical">(disabled)</span></div><div ng-show="source.matches.similarWordsCounter > 0"><span class="similar-color">Minor Changes {{ source.matches.similarWordsCounter }} words</span> <span ng-show="!settings.showSimilar">(disabled)</span></div><div ng-show="source.matches.relatedWordsCounter > 0"><span class="related-color">Related Meaning {{ source.matches.relatedWordsCounter }} words</span> <span ng-show="!settings.showRelated">(disabled)</span></div></md-tooltip><div ng-show="source.matches.identicalWordsCounter > 0" ng-class="settings.showIdentical ? \'identical-on\' : \'identical-off\'"></div><div ng-show="source.matches.similarWordsCounter > 0" ng-class="settings.showSimilar ? \'similar-on\' : \'similar-off\'"></div><div ng-show="source.matches.relatedWordsCounter > 0" ng-class="settings.showRelated ? \'related-on\' : \'related-off\'"></div></div></div></md-card-content></md-card></div></div>',controller:t,link:function(n,e,t){n.$watchCollection("sources",function(e,t){o.log("sources changed."),e!==t&&n.refreshSources()}),n.$watch("lockedSources",function(e,t){o.log("lockedSources changed."),e!==t&&n.refreshSources()},!0)}}}])}function w(e){e.directive("ngBindHtmlCompile",["$compile","$parse",function(i,r){return{link:function(t,n,o){var e=r(o.ngBindHtmlCompile);t.$watch(function(){return(e(t)||"").toString()},function(e){n.html(e),o.compileTags?i(n[0].querySelectorAll(o.compileTags))(t):i(n,null,-9999)(t)})}}}]),e.filter("unsafe",["$sce",function(e){return e.trustAsHtml}])}function b(e){e.filter("removeProtocol",function(){return function(e){return e&&e.replace(/(^\w+:|^)\/\//,"")}}).filter("prettyNumberWithK",function(){return function(e){return 1e3<e?parseInt(e/1e3).toLocaleString("en")+"k":e}}).filter("prettyNumber",function(){return function(e){return 1e3<=e?e.toLocaleString("en"):e}})}function T(e){e.service("contentTypeService",[function(){var t={types:{html:"html",text:"text"},contentTypes:{html:"text/html",text:"text/plain"}};t.contentTypesConverter={"text/html":t.types.html,"text/plain":t.types.text};var n="html";function o(e){return n}function e(e){this.propertyName=e}return t.defaultContentType="text/html, text/plain",t.isHtmlContentType=function(e){return e==t.contentTypes.html},t.isTextContentType=function(e){return e==t.contentTypes.text},t.getTypeFromContentType=function(e){return t.contentTypesConverter[e]},e.prototype={init:function(e){this.set(e)},setToText:function(){this.set(t.types.text)},setToHtml:function(){this.set(t.types.html)},getOther:function(){return this.isText()?t.types.html:t.types.text},isText:function(){return this.get()==t.types.text},isHtml:function(){return this.get()==t.types.html},isHtmlOrDefault:function(){var e=this.get();return e==t.types.html||!e},set:function(e){var t;t=e,this.propertyName,n=t},get:function(){return o(this.propertyName)},getOrDefault:function(){var e=o(this.propertyName);return e||t.types.html},hasValue:function(){return!!o(this.propertyName)},switch:function(){this.isHtmlOrDefault()?this.setToText():this.setToHtml()}},t.contentType=new e("mode"),t.getOtherType=function(e){return t.isHtmlContentType(e)?t.contentTypes.html:t.contentTypes.text},t.isHtmlContentType=function(e){return e==t.contentTypes.html},t.isTextContentType=function(e){return e==t.contentTypes.text},t}])}function x(e){e.service("DataService",["contentTypeService",function(o){this.eSourceStatus=Object.freeze({completed:0,reportDownloaded:1,readyToSplit:2,readyToFullText:3,switchingType:4}),this.splitDocument=function(e){var t={};if(t.contentType=e.contentType,!e.info||!e.info.ranges)return null;if(!t.contentType||o.isTextContentType(t.contentType)){var n=new L;t.ranges=e.info.ranges,t.pages=n.splitText(e.text,e.info.ranges)}else t.ranges=[0],t.pages=[e.text];return t.info=e.info,t.text=e.text,t}}])}function C(e){e.service("educationReportService",["settingsService","DataService","$q","$interval","logService","$timeout","$window","reportDataService","utilitiesService","contentTypeService",function(e,t,n,o,i,r,s,a,c,l){return{}}])}function k(e){var t=[];if(3==e.nodeType)t.push(e);else for(var n=e.childNodes,o=0,i=n.length;o<i;++o)t.push.apply(t,k(n[o]));return t}function P(e,t,n){if(document.createRange&&window.getSelection){var o=document.createRange();o.selectNodeContents(e);for(var i,r,s=k(e),a=!1,c=0,l=0;r=s[l++];){if(i=c+r.length,!a&&c<=t&&(t<i||t==i&&l<=s.length)&&(o.setStart(r,t-c),a=!0),a&&n<=i){o.setEnd(r,n-c);break}c=i}var u=window.getSelection();u.removeAllRanges(),u.addRange(o)}else if(document.selection&&document.body.createTextRange){var d=document.body.createTextRange();d.moveToElementText(e),d.collapse(!0),d.moveEnd("character",n),d.moveStart("character",t),d.select()}}function M(e){var t,n=window.getSelection();n.rangeCount&&n.getRangeAt&&(t=n.getRangeAt(0)),document.designMode="on",t&&(n.removeAllRanges(),n.addRange(t)),document.execCommand("HiliteColor",!1,e)||document.execCommand("BackColor",!1,e),document.designMode="off"}function R(t){if(window.getSelection)try{document.execCommand("BackColor",!1,t)||M(t)}catch(e){M(t)}else document.selection&&document.selection.createRange&&document.selection.createRange().execCommand("BackColor",!1,t)}function D(e,t,n,o){P(document.getElementById(e),t,n),R(o)}function O(e){e.service("iframeService",["pageService",function(s){var e={getIframeText:function(e){var t=document.createElement("html");try{t.innerHTML=e}catch(e){}t.getElementsByTagName("body")[0].classList.add("identical-on","similar-on","related-on");var n=t.getElementsByTagName("head")[0],o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=window.location.origin+"/css/copyleaks/copyleaks-plagiarism-report-iframe.min.css",n.appendChild(o);var i=document.createElement("script");i.type="text/javascript";var r=document.createTextNode("var cpyc = "+function(e,t){var n={rangeIds:e,type:"copyleaksMatchClicked",pageType:t};window.removeCss();var o=JSON.stringify(n);parent.postMessage(o,"*");var i="."+e.join("."),r=window.copyleaksSelectedStyle=document.createElement("style");r.type="text/css";var s=e[0].substr(0,1),a=window.getColorForMatchType(s);r.innerHTML=i+"{border-bottom: 2px solid "+a+"}",document.getElementsByTagName("head")[0].appendChild(r)}.toString()+";var listenToMatchScrollRequest = "+function(){window.addEventListener("message",function(e){if(!e||!e.data)return;var t=null;try{t=JSON.parse(e.data)}catch(e){return}if("copyleaksMatchScrollRequest"!==t.type)return;var n=t.matchId,o=document.getElementsByClassName(n)[0],i=o.getBoundingClientRect(),r=i.top+window.scrollY;r<0&&(r=0);var s=i.left;window.removeCss();var a=n[0].substr(0,1),c=window.getColorForMatchType(a),l=window.copyleaksSelectedStyle=document.createElement("style");function u(){for(var e=document.getElementsByTagName("meta"),t=0;t<e.length;t++)if("generator"==e[t].getAttribute("name")&&"pdf2htmlEX"==e[t].getAttribute("content"))return!0;return!1}function d(e,t){for(;(e=e.parentElement)&&!(e.matches||e.matchesSelector).call(e,t););return e}if(l.type="text/css",l.innerHTML="."+n+"{border-bottom: 2px solid "+c+"}",document.getElementsByTagName("head")[0].appendChild(l),u()){var p=d(o,"[data-page-no]"),g=(window.testElement=p).getBoundingClientRect(),m=g.top,h=document.getElementById("page-container");h.scrollTop=h.scrollTop+m,setTimeout(function(){var e=o.getBoundingClientRect();h.scrollTop=h.scrollTop+e.top,h.scrollLeft=e.left},100)}else window.scrollTo(s,r)},!1)}.toString()+";var removeCss = "+function(){window.copyleaksSelectedStyle&&(window.copyleaksSelectedStyle.remove(),window.copyleaksSelectedStyle=null)}.toString()+";var getColorForMatchType= "+s.getColorForMatchType+";listenToMatchScrollRequest();");return i.appendChild(r),n.appendChild(i),e=t.outerHTML}};return String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},e}])}function E(e){e.service("logService",function(){this.debug=!1,this.printStack=!1,this.log=function(e){this.debug&&(this.printStack&&(new Error).stack.substr(5))}})}function I(e){e.service("oneToOneReportService",["settingsService","DataService","$q","$interval","logService","$timeout","sourcesService","$window","reportDataService","pageService","$rootScope","contentTypeService",function(e,t,n,o,i,r,s,a,c,l,u,d){var p={};function g(e){return c[e]}function m(e){return h(e,d.contentType.getOrDefault())}function h(e,t){return e+"_suspect_"+t}function f(e){return v(e,d.contentType.getOrDefault())}function v(e,t){return e+"_source_"+t}return p.setSuspect=function(e){var t=m(c.resultId);c[t]=e},p.getSuspect=function(){return g(m(c.resultId))},p.copySuspectToOtherTypes=function(e,t){var n=h(c.resultId,e),o=h(c.resultId,t);c[o]=c[n]},p.setSource=function(e){var t=f(c.resultId);c[t]=e},p.getSource=function(){return g(f(c.resultId))},p.copySourceToOtherTypes=function(e,t){var n=v(c.resultId,e),o=v(c.resultId,t);c[o]=c[n]},p.requestToScannedProcessSent=!1,p.resultSuccess=function(e){var t=p.getSource();if(null!=t){t.matches=e.comparison,t.info=e.info,t.text=e.text,t.contentType=e.contentType;var n=angular.merge({},t);if(!t.contentType||d.isTextContentType(t.contentType)){var o=new L;c.suspectRanges=e.info.ranges,c.suspectPages=o.splitText(e.text,e.info.ranges),(e.comparisonVersion<2||!c.sourceHasGids(n))&&(c.fixOldTextScanGids(n),c.fixOldTextScanGids(t)),c.scanned_document&&l.convert_comparison_report_with_pages(t,c.scanned_document.ranges,"sourceToSuspect"),l.convert_comparison_report_with_pages(n,e.info.ranges,"suspectToSource")}else{if(!d.isHtmlContentType(t.contentType))throw new Error("unsupported content type");if(t.hasHtmlContentType=!0,c.suspectRanges=[0],c.suspectPages=[e.text],c.scanned_document)if(d.isTextContentType(c.scanned_document.contentType))l.convert_comparison_report_with_pages(t,c.scanned_document.ranges,"sourceToSuspect");else{if(!d.isHtmlContentType(c.scanned_document.contentType))throw new Error("unsupported content type");l.convert_comparison_report_with_pages(t,[0],"sourceToSuspect")}l.convert_comparison_report_with_pages(n,[0],"suspectToSource")}p.setSuspect(n)}else p.match=e},p}])}function F(e){e.service("pageService",["settingsService","DataService","reportDataService","contentTypeService",function(l,u,f,i){var e={updateCurrentPageMatches:function(e,t,n){var o,i={identical:[],similar:[],relatedMeaning:[],excluded:[]},r=l.instance,s=l.getMaxSourcesWithMatches(e);for(var a in s)if((o=s[a]).is_active&&o.status==u.eSourceStatus.completed&&o.matches&&o.matches.identical&&o.matches.identical[t]&&o.matches.relatedMeaning&&o.matches.relatedMeaning[t]&&o.matches.similar&&o.matches.similar[t]){if(r.showIdentical)for(var c=0;c<o.matches.identical[t].length;++c)i.identical.push({id:o.id,match:o.matches.identical[t][c]});if(r.showSimilar)for(var c=0;c<o.matches.similar[t].length;++c)i.similar.push({id:o.id,match:o.matches.similar[t][c]});if(r.showRelated)for(var c=0;c<o.matches.relatedMeaning[t].length;++c)i.relatedMeaning.push({id:o.id,match:o.matches.relatedMeaning[t][c]})}if(n&&0<n.length)for(var c=0;c<n[t].length;++c)i.excluded.push({id:-1,match:n[t][c]});return i},highlightText:function(e){if(!e.text)return"";var t=e.text,n=e.text.length,o=e.matches,i=e.sources,r=e.mapType,s=e.reportType,a=e.disableTooltip,c=e.contentType,l=e.pageType;if(!o||0==o.length)return[];o.excluded=underscore.sortBy(o.excluded,function(e){return e.match.SoE});var u=function(e,t,n){var o,i,r=e;if("sourceToSuspect"==n)o="SoS",i="SoE","SuS","SuE";else{if("suspectToSource"!=n)throw new Error("unsupported mapping type");o="SuS",i="SuE","SoS","SoE"}var s,a=[];for(u=0;u<r;++u)a.push([]);for(var c,l=null,u=0;u<t.identical.length;++u){l=t.identical[u],s="i_"+l.id+"_"+l.match.GID;for(var d=l.match[o];d<l.match[i];++d)a[d].push({matchType:1,id:s})}for(var u=0;u<t.similar.length;++u){l=t.similar[u],s="s_"+l.id+"_"+l.match.GID;for(var d=l.match[o];d<l.match[i];++d)a[d].push({matchType:2,id:s})}for(var u=0;u<t.relatedMeaning.length;++u){l=t.relatedMeaning[u],s="r_"+l.id+"_"+l.match.GID;for(var d=l.match[o];d<l.match[i];++d)a[d].push({matchType:3,id:s})}for(var u=0;u<t.excluded.length;++u)for(var d=(l=t.excluded[u].match)[o];d<l[i];++d)a[d].push({matchType:4,id:-1});for(var u=0;u<a.length;++u)0!==(c=w(a[u]))&&(a[u]=a[u].filter(function(e){return e.matchType===c}));for(var p=[{matchType:-1,SoS:-1,SoE:-1,ids:[]}],g={},u=0;u<r;++u)if(0!==a[u].length){var m=p[p.length-1];if(a[u].length===m.ids.length&&a[u][0].matchType==m.matchType&&m.SoE==u&&y(a[u],g[m.SoS]))m.SoE+=1;else{p.push({matchType:a[u][0].matchType,SoS:u,SoE:u+1,ids:[]}),g[u]={},m=p[p.length-1];for(var h=0;h<a[u].length;++h){var f=a[u][h].id;m.ids.push(f),g[u][f]=!0}}}return p.shift(),p}(n,o,r);return 0==u.length?t:(function(e){for(var t=0;t<e.length;++t)e[t].ids=underscore.uniq(e[t].ids)}(u=function(e){var t=[];0<e.length&&t.push(e[0]);for(var n=1;n<e.length;++n){var o=e[n-1],i=e[n],r=t[t.length-1];o.matchType===i.matchType&&p(o.ids,i.ids)?o.SoE===i.SoS?(r.SoE!==i.SoS&&t.push(o),r.SoE=i.SoE):o.SoE>i.SoS&&o.SoE<i.SoE?r.SoE=i.SoE:t.push(i):t.push(i)}return t}(u)),d=u,u=d=d.sort(function(e,t){return parseFloat(t.SoS)-parseFloat(e.SoS)}),t=function(e,t,n,o,i,r,s,a){for(var c,l=null,u=e.length-1,d=[],p=0;p<t.length;++p){if(c=t[p],u>=c.SoE&&d.unshift(e.substr(c.SoE,u-c.SoE+1)),4==c.matchType){l="",r||(l='<md-tooltip md-direction="top" md-delay="1000">References are omitted according to your settings</md-tooltip>');var g=e.substr(c.SoS,c.SoE-c.SoS);d.unshift('<span class="highlight-4">'+l+g+"</span>")}else{l="",r||(l=S(c.ids,n,i));var g=e.substr(c.SoS,c.SoE-c.SoS),m="<span"+(h=c.matchType,f=c.ids,' class="highlight-'+h+" "+f.join(" ")+'"')+v(s,a,c.ids)+">"+l;d.unshift(m+g+"</span>")}u=c.SoS-1}var h,f;return 0!=u&&d.unshift(e.substr(0,u+1)),d.join("")}(t,u,i,0,s,a,c,l));var d},convert_comparison_report_with_pages:function(e,t,n){if(!t||null===t)throw"pageRanges cannot be null";(e.comparisonVersion<2||!f.sourceHasGids(e))&&f.fixOldTextScanGids(e);e.matchesBeforeSplit||(e.matchesBeforeSplit=jQuery.extend(!0,{},e.matches));var o=new L;return e.matches={identical:o.split(e.matches.Identical||e.matches.identical,t,n),similar:o.split(e.matches.Similar||e.matches.similar,t,n),relatedMeaning:o.split(e.matches.RelatedMeaning||e.matches.relatedMeaning,t,n),identicalWordsCounter:e.matchesBeforeSplit.IdenticalCopiedWords,similarWordsCounter:e.matchesBeforeSplit.SimilarCopiedWords,relatedWordsCounter:e.matchesBeforeSplit.RelatedMeaningCopiedWords},e.status=u.eSourceStatus.completed,e},getColorForMatchType:t,getColorForClassName:function(e){return t(e[0].substr(0,1))}};function v(e,t,n){var o=function(e){for(var t="[",n=0;n<e.length;++n)t+="'"+e[n]+"',";return t=t.slice(0,-1),t+="]"}(n);return i.isHtmlContentType(e)?(t||(t="test"),' onclick="cpyc('+o+", '"+t+"');\""):' ng-click="clicked('+o+');"'}function S(e,t,n){return"1to1"!=n?'<md-tooltip class="multiline" md-direction="top" md-delay="1000">'+function(e,t){{if(1==e.length&&-1==e[0])return"<b>Ignored by request</b>";for(var n={},o={},i=0;i<e.length;++i){var r=f.getSourceIdFromMatchId(e[i]),s=t[r],a=s.url;if(null!=a){var c=a.replace("http://","").replace("https://","").split(/[/?#]/)[0];n.hasOwnProperty(c)?n[c]++:n[c]=1}else o.hasOwnProperty(s.title)?o[s.title]++:o[s.title]=1}for(var l,u,d,p=Object.keys(n),i=0;i<p.length;++i){for(a=p[i],l=n[a],u=a,d=null;;){var g=u.indexOf(".");if(g<0)break;u=u.substr(g+1),n.hasOwnProperty(u)&&(d=u)}null!=d&&(delete n[a],n[d]=n[d]+l)}for(var m="<b>Results came from:</b>",h=Object.keys(n),i=0;i<h.length&&i<7;++i)m+="<BR>"+h[i]+": "+n[h[i]];if(i<7)for(h=Object.keys(o);i<h.length&&i<7;++i)m+="<BR>"+h[i]+": "+o[h[i]];return m}}(e,t)+"</md-tooltip>":""}function y(e,t){for(var n=0;n<e.length;++n)if(!t.hasOwnProperty(e[n].id))return!1;return!0}function p(e,t){if(e.length!==t.length)return!1;for(var n=e.length;n--;)if(e[n]!==t[n])return!1;return!0}function w(e){return 0==e.length?0:e[0].matchType}function t(e){switch(e){case"i":return"rgba(255, 102, 102, 0.9)";case"s":return"rgba(255, 154, 154, 0.9)";case"r":return"rgba(255, 217, 176, 0.9)"}}return String.prototype.splice=function(e,t){return this.slice(0,e)+t+this.slice(e)},e}])}function L(){}function N(e){this.data=e,this.next=null}function B(){this.head=null}function j(e){e.service("reportDataService",["contentTypeService",function(i){var r={};function e(){r.sources={},r.scanProgressPercents=100,r.excludedRangesPerPage=null,r.excludedRangeCount=0}function s(e){var t=0;e&&(2<=e.length&&e[0].GID==e[1].GID||1==e.length&&!e[0].hasOwnProperty("GID"))&&underscore.each(e,function(e){e.GID=t++})}return r.showStatisticControls=!0,r.working=!0,e(),r.reportTypes={multipleSuspects:1,singleSuspect:2},r.pageTypes={source:"source",suspect:"suspect"},r.splitExcludedRanges=function(){if(!this.excludedRangesPerPage&&this.scanned_document&&this.scanned_document.ranges&&this.info&&this.info.excludedRanges&&0!=this.info.excludedRanges.length){var e=i.isHtmlContentType(this.scanned_document.contentType)?this.info.htmlExcludedRanges:this.info.excludedRanges,t=underscore.map(e,function(e){return{SoS:e.start,SoE:e.end,id:-1}}),n=new L;this.excludedRangesPerPage=n.split(t,this.scanned_document.ranges,"sourceToSuspect");var o=r.excludedRangeCount;r.computeTotalExcludedWords(),null!=o&&r.excludedRangeCount}},r.computeTotalExcludedWords=function(){if(r.excludedRangeCount=0,!r.excludedRangeCount&&r.info&&r.info.excludedRanges){var n={};r.excludedRangeCount=underscore.reduce(r.info.excludedRanges,function(e,t){return null==t.gid?t.numOfWords+e:n[t.gid]?e:(n[t.gid]=!0,t.numOfWords+e)},0)}},r.setError=function(e){r.isErrored=!0,r.ErrorMessage=e},r.getSourceIdFromMatchId=function(e){var t=e.substr(2);return t=t.substr(0,t.lastIndexOf("_"))},r.clearSourcesMatch=function(){underscore.each(r.sources,function(e){delete e.matches,delete e.matchesBeforeSplit})},r.fixOldTextScanGids=function(e){if(e.matches){var t=e.matches.Identical,n=e.matches.Similar,o=e.matches.RelatedMeaning;i.contentType.isText()||(s(t),s(n),s(o))}},r.sourceHasGids=function(e){var t=e.matches.Identical,n=e.matches.Similar,o=e.matches.RelatedMeaning;return t&&0<t.length?t[0].hasOwnProperty("GID"):n&&0<n.length?n[0].hasOwnProperty("GID"):!(o&&0<o.length)||o[0].hasOwnProperty("GID")},r.clear=function(){delete r.isErrored,delete r.noMatches,delete r.excludedRangesPerPage,delete r.info,delete r.scanProgressPercents,e(),delete r.sourceType,delete r.sourceTitle,delete r.sourceCount,delete r.hasHtmlContentType,delete r.resultTitle,delete r.suspectRanges,delete r.suspectPages,delete r.reportTitle,delete r.reportIcon},r}])}function z(e){e.service("reportServiceMediator",["$q",function(e){var t={iconButtonClicked:function(){o("icon-button-clicked",{})},switchReportContentType:function(e){o("content-type-changed",{contentType:e})},changeMultiSuspectPage:function(e){o("multiple-suspect-page-change",{pageNumber:e})},changeSingleSuspectSourcePage:function(e){o("single-suspect-source-page-change",{pageNumber:e})},changeSingleSuspectSuspectPage:function(e){o("single-suspect-suspect-page-change",{pageNumber:e})},downloadSource:function(){o("download-source-clicked",{})},downloadSuspect:function(){o("download-suspect-clicked",{})},deleteSharingKey:function(){o("delete-sharing-key",{})}},n=e.defer();function o(e,t){n.notify({type:e,params:t})}return t.promise=n.promise,t}]),e.service("reportServiceListener",["reportDataService","$rootScope","settingsService","DataService","reportServiceMediator","logService","sourcesService","$q","$timeout","contentTypeService",function(r,n,t,o,i,e,s,a,c,l){var u={registerToEvents:function(){var e=a.defer();return u.deferred=e,c(function(){i.registered&&i.registered()}),e.promise},progressChanged:function(e){r.scanProgressPercents=e},onDocumentReadyV2:g,onDocumentReady:function(e){g({text:e,contentType:"text/plain",info:{wordsCount:1212121212,ranges:[0]}},!0)},onInfoReady:function(e){r.info=e,function(){if(r.info&&r.info.title){var e,t,n=r.info.title;r.sourceTitle=n,r.sourceType="Uploaded text"==(e=n)?"FreeText":(t=e,new RegExp("^(https?:\\/\\/)").test(t)?"Url":/.*\.(gif|png|bmp|jpg|jpeg)$/i.test(e)?"Ocr":/.*\.(html|pdf|docx|doc|txt|rtf|xml|pptx|ppt|odt|chm|epub|odp|ppsx|pages|xlsx|xls|csv|LaTeX)$/i.test(e)?"Textual":void c(function(){throw new Error("Could not extract source type from title. Title: "+e)}))}}(),"Processing"===r.info.status&&(r.scanProgressPercents=5);m()},onNewResult:function(e){s.incomingSource(e),u.deferred.notify({type:"new_result_recieved",params:{result:e}})},onCompletion:function(e){for(var t=0;t<e.length;++t)p(e[t]);r.sourceCount=e.length,e&&0!=e.length?(d=!0,s.incomingSources(e),u.deferred.notify({type:"incoming_results",params:{sources:e}})):r.info&&"Processing"!==r.info.status&&u.deferred.notify({type:"cb_emptySources",params:{}})},onMatchesV2:function(e,t){var n=s.handleMatches(e,t);r.working=0<n,u.deferred.notify({type:"result_matches_recieved",params:{suspectId:e,match:t}}),d&&0==n&&(r.working=!1,u.deferred.notify({type:"cb_last_sourceRequestSent",params:{}}))},onMatches:function(e,t,n){var o={comparison:n,text:t,contentType:"text/plain",info:{wordsCount:0,ranges:[0]}},i=s.handleMatches(e,o);r.working=0<i,u.deferred.notify({type:"result_matches_recieved",params:{suspectId:e,match:o}}),d&&0==i&&(r.working=!1,u.deferred.notify({type:"cb_last_sourceRequestSent",params:{}}))},setError:function(e){r.setError(e)},init:function(e){if(r.clear(),!e.id)throw new Error("missing id");if(!e.reportType)throw new Error("missing reportType ( single or multiple suspects");r.pid=e.id,r.type=e.reportType,e.shareLinkCreationCallback&&(this.shareLinkCreationCallback=e.shareLinkCreationCallback);r.type==r.reportTypes.singleSuspect&&(r.resultId=e.suspectId);e.hasOwnProperty("showShareButton")?r.showShareButton=e.showShareButton:r.showShareButton=!0;e.multiSuspectePage&&(r.pageNum=e.multiSuspectePage);e.singleSuspectSourcePage&&(r.pageNumSource=e.singleSuspectSourcePage);e.singleSuspectSuspectPage&&(r.pageNumResult=e.singleSuspectSuspectPage);if(e.contentType){switch(e.contentType){case"html":case"text":break;default:throw new Error("unsuported content type")}l.contentType.init(e.contentType)}return t.initSettings(),i.promise},reportTypes:r.reportTypes,getSharingUrl:function(e){if(!this.shareLinkCreationCallback)return a.reject();var t=a.defer();return this.shareLinkCreationCallback(e,t),t.promise},setDocumentProperties:function(e){r.reportIcon=e.icon,r.reportTitle=e.title},setMultipleSuspectPage:function(e){n.$broadcast("setMultipleSuspectPage",{pageNumber:e})},setSingleSuspectSourcePage:function(e){n.$broadcast("setSingleSuspectSourcePage",{pageNumber:e})},setSingleSuspectSuspectPage:function(e){n.$broadcast("setSingleSuspectSuspectPage",{pageNumber:e})},setContentType:function(e){if(l.contentType.get()==e)return;null==e&&(e=l.types.html);l.contentType.set(e),n.$broadcast("switchContentType")},switchReportType:function(e,t){e==r.reportTypes.singleSuspect?(r.resultId=t,n.$broadcast("switchToSingleSuspectReport")):n.$broadcast("switchToMultiSuspectReport")}};var d=!1;function p(e){e.is_active=!0,e.status=o.eSourceStatus.reportDownloaded,null==e.URL&&(e.URL="no public address")}function g(e,t){void 0!==t&&(r.textOnly=t)&&l.contentType.setToText(),e=o.splitDocument(e),r.scanned_document=e,s.setPageRanges(e.ranges),m(),n.$broadcast("updatePageMatchesNow"),u.deferred.notify({type:"cb_scanned_document_success",params:{doc:e}})}function m(){r.splitExcludedRanges()}return u}])}function H(e){e.service("scrollService",["pageService",function(e){var t={scrollSource:function(e){void 0!==n.SoS?(t=e,o("."+n.SoS,t),delete n.SoS):void 0!==n.sourcePageLocation&&($(".source-page").find(".panel-body").scrollTop(n.sourcePageLocation),delete n.sourcePageLocation);var t},scrollSuspect:function(e){void 0!==n.SuS?(t=e,o("."+n.SuS,t),delete n.SuS):void 0!==n.suspectPageLocation&&($(".suspect-page").find(".panel-body").scrollTop(n.suspectPageLocation),delete n.suspectPageLocation);var t},setSourceMatchToScrollTo:function(e){n.SoS=e},setSuspectMatchToScrollTo:function(e){n.SuS=e},recordSourcePageTopLocation:function(e){n.sourcePageLocation=$(".source-page").find(".panel-body").scrollTop()},recordSuspectPageTopLocation:function(e){n.suspectPageLocation=$(".suspect-page").find(".panel-body").scrollTop()}},n={};function o(e,t,n){var o=t.findElement(e);if(0<o.length){var i=o.offset().top-o.parent().offset().top,r=o.closest(".panel-body");$(".selected-match").removeClass("selected-match"),o.addClass("selected-match"),r.animate({scrollTop:i},400)}}return t}])}function A(e){e.service("settingsService",["utilitiesService","reportDataService",function(n,t){function e(){return t.pid+".settings"in localStorage?JSON.parse(localStorage[t.pid+".settings"]):null}function o(){return"default-settings"in localStorage?JSON.parse(localStorage["default-settings"]):null}this.getMaxSourcesNumber=function(){return this.instance.showOnlyTopResults?100:1/0},this.sortSourcesByNumberOfMatches=function(e){return underscore.sortBy(e,"totalMatchedWords").reverse()},this.getMaxSourcesWithMatches=function(e){if(!e||0==n.length(e))return[];var t=this.getMaxSourcesNumber();return t==1/0&&(t=n.length(e)),underscore.first(this.sortSourcesByNumberOfMatches(e),t)},this.initSettings=function(e){return this.instance=this.get_settings(e),this.instance},this.get_settings=function(){return null!==e()?e():null!==o()?o():{showIdentical:!0,showSimilar:!0,showRelated:!0,showPageSources:!1,showOnlyTopResults:!0,ui:{fontSize:18,rtlMode:!1},source:{ui:{fontSize:18,rtlMode:!1}},suspect:{ui:{fontSize:18,rtlMode:!1}}}},this.set_settings=function(e){delete e.make_default;try{localStorage[t.pid+".settings"]=JSON.stringify(e)}catch(e){}},this.set_default_settings=function(e){delete e.make_default;try{localStorage["default-settings"]=JSON.stringify(settings)}catch(e){}}}])}function W(e){e.service("sourcesService",["DataService","contentTypeService","reportDataService","pageService","logService","settingsService","utilitiesService",function(e,o,i,r,s,a,c){var t=!1,l=null,u={},d=0;function p(e,t){i.type==i.reportTypes.singleSuspect?i.resultId==e.id&&(e.matches||d--):e.matches||d--;var n;o.contentTypesConverter[t.contentType];return o.isHtmlContentType(t.contentType)&&(t.hasHtmlContentType=!0),(n=t.comparison).Identical&&0<n.Identical.length&&n.Identical[0].hasOwnProperty("SoWE")||n.Similar&&0<n.Similar.length&&n.Similar[0].hasOwnProperty("SoWE")||n&&n.RelatedMeaning&&0<n.RelatedMeaning.length&&n.RelatedMeaning[0].hasOwnProperty("SoWE")||(!function(e){var t=null;if(e.Identical)for(var n=0;n<e.Identical.length;++n)(t=e.Identical[n]).SoWS=t.SoS,t.SoWE=t.SoE;if(e.Similar)for(var n=0;n<e.Similar.length;++n)(t=e.Similar[n]).SoWS=t.SoS,t.SoWE=t.SoE;if(e.RelatedMeaning)for(var n=0;n<e.RelatedMeaning.length;++n)(t=e.RelatedMeaning[n]).SoWS=t.SoS,t.SoWE=t.SoE}(t.comparison),e.isWordRangeCopied=!0),e.matches=t.comparison,e.text=t.text,e.info=t.info,e.comparisonVersion=t.comparisonVersion,e.contentType=t.contentType,null!==l&&r.convert_comparison_report_with_pages(e,l,"sourceToSuspect"),d}this.isPageRangesSet=function(){return t},this.setPageRanges=function(e){t=!0,l=e},this.resetSourcesWithoutMatches=function(e){d=e},this.checkForMissingMatches=function(e){d=underscore.find(i.sources,function(e){return!e.hasOwnProperty("matches")}).length},this.matchesBeforeSources={},this.handleMatches=function(e,t){var n=i.sources[e];if(null==n)throw new Error("Must get source before matches");return n.matches?d:p(n,t)},this.incomingSource=function(e){e.id in i.sources||(i.type==i.reportTypes.singleSuspect?i.resultId==e.id&&(e.matches||d++):e.matches||d++,i.sources[e.id]=e,this.matchesBeforeSources[e.id]&&p(e,this.matchesBeforeSources[e.id]))},this.incomingSources=function(e){e=a.sortSourcesByNumberOfMatches(e);for(var t=a.getMaxSourcesNumber(),n=0;n<e.length&&n<t;++n){var o=e[n];o.id in i.sources||(i.type==i.reportTypes.singleSuspect?i.resultId==o.id&&(o.matches||d++):o.matches||d++,i.sources[o.id]=o,this.matchesBeforeSources[o.id]&&p(o,this.matchesBeforeSources[o.id]))}for(;n<e.length;++n)u[e[n].id]=e[n];s.log("Parsed "+c.length(e)+" incoming sources"),s.log("There are"+c.length(u)+" remaining sources, that were not processed")},this.getRemainingSources=function(){for(var e in s.log("processing "+c.length(u)+" remaining sources"),u)incomingSource(u[e]);u.length=0}}])}function V(e){e.service("statisticsService",["settingsService","utilitiesService","logService",function(l,o,u){function d(e,t){if(e&&0!=Object.keys(e).length){for(var n,o=l.getMaxSourcesNumber(),i=l.sortSourcesByNumberOfMatches(e),r=[],s=i.length,a=0;a<s&&a<o;a++)(n=i[a]).hasOwnProperty("matchesBeforeSplit")&&(t?n.is_active&&r.push(n):r.push(n));return r}}function g(e,t){u.log("mergeSourceMatches");var n,o=d(e,!0),i=[];l.instance.showIdentical&&(n=o,i=underscore.flatten(underscore.map(n,function(e){return e.matchesBeforeSplit.Identical})));var r,s=[];l.instance.showSimilar&&(r=o,s=underscore.flatten(underscore.map(r,function(e){return e.matchesBeforeSplit.Similar})));var a,c=[];return l.instance.showRelated&&(a=o,c=underscore.flatten(underscore.map(a,function(e){return e.matchesBeforeSplit.RelatedMeaning}))),function(e){var t=underscore.groupBy(e,"p"),n={identical:0,similar:0,related:0};t.hasOwnProperty("1")&&(n.identical=p(t[1]));t.hasOwnProperty("2")&&(n.similar=p(t[2]));t.hasOwnProperty("3")&&(n.related=p(t[3]));return n}(function(e,t,n,o){var i=new B;i.add({s:0,e:o-1,p:4});var r=i.head;return e.forEach(function(e){r=i.append(e,r)}),r=i.head,t.forEach(function(e){r=i.append(e,r)}),r=i.head,n.forEach(function(e){r=i.append(e,r)}),i.toArray()}(m(i,1),m(s,2),m(c,3),t))}function p(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].e-e[n].s+1;return t}function m(e,t){for(var n=[],o=0;o<e.length;++o)n.push({wordIndex:e[o].SoWS,type:0}),n.push({wordIndex:e[o].SoWE,type:1});var i=n.sort(function(e,t){return e.wordIndex<t.wordIndex?-1:e.wordIndex>t.wordIndex?1:e.type<t.type?-1:e.type>t.type?1:0}),r=[],s=0,a=0;for(o=0;o<i.length;++o){var c=i[o];0==c.type&&(0==s&&(a=c.wordIndex),s+=1),1==c.type&&0==(s-=1)&&r.push({p:t,s:a,e:c.wordIndex})}return r}this.atLeastOneSourceWithMatches=function(e){if(null!=e){for(var t in e){var n=e[t];if(n.hasOwnProperty("matchesBeforeSplit")&&null!=n.matchesBeforeSplit.Identical)return!0}return!1}},this.haveDataForStatistics=function(e){if(null==e)return!1;if(0==o.length(e))return!1;if(!this.atLeastOneSourceWithMatches(e))return!1;var t=d(e,!1),n=l.getMaxSourcesNumber();return n!=1/0&&t.length>=n||Object.keys(e).length==t.length},this.getEmpty=function(e){return{totalCopiedWords:0,totalWordCount:e,percentage:{identical:{round:0,real:0},similar:{round:0,real:0},related:{round:0,real:0},wordsNotCopied:e}}},this.computeStatistics=function(e,t,n){if(!e)return null;if(!t)return null;var o,i,r,s,a,c,l=g(e,t),u=t-n,d=(l.identical,l.related,l.similar,o=l,i=u,r=underscore.map(o,function(e,t){var n=e/i*100;return{name:t,value:e,percentage:n,percentageRoundedDown:Math.floor(n),priority:function(e){switch(e){case"identical":return 1;case"similar":return 2;case"related":return 3}}(t)}}).filter(function(e){return 0<e.value}),s=underscore.reduce(r,function(e,t){return e+t.percentage},0),a=underscore.reduce(r,function(e,t){return e+t.percentageRoundedDown},0),c=Math.floor(s-a),r=underscore.sortBy(r,"percentageRoundedDown"),underscore.each(r,function(e){if(0==c)return!1;1<=e.percentageRoundedDown&&(e.percentageRoundedDown=e.percentageRoundedDown+1,c--)}),underscore.indexBy(r,"name")),p={totalCopiedWords:l.identical+l.related+l.similar,totalWordCount:u,percentage:{identical:{round:d.identical&&d.identical.percentageRoundedDown||0,real:d.identical&&d.identical.percentage||0},similar:{round:d.similar&&d.similar.percentageRoundedDown||0,real:d.similar&&d.similar.percentage||0},related:{round:d.related&&d.related.percentageRoundedDown||0,real:d.related&&d.related.percentage||0}}};return p.percentage.wordsNotCopied=100-p.percentage.identical.round-p.percentage.similar.round-p.percentage.related.round,p}}])}function U(e){e.service("utilitiesService",["$timeout",function(e){this.clearObject=function(e){for(var t in e)e.hasOwnProperty(t)&&delete e[t]},this.throttleWithGuaranteedLastRun=function(n,o){var i,r,s;return function(){var e=this,t=arguments;i?(clearTimeout(r),r=setTimeout(function(){Date.now()-s>=o&&(n.apply(e,t),s=Date.now())},o-(Date.now()-s))):(n.apply(e,t),s=Date.now(),i=!0)}},this.length=function(e){if(e instanceof Array)return e.length;if(e instanceof Object)return Object.keys(e).length;throw new Error("Unsupported type")},this.setControlToNoResultsState=function(e,t){e.showEmpty?e.showEmpty(t):(e.isEmpty=!0,e.emptyResults=t)},this.getMaxPaginationCount=function(){var e=$(window).width();return 768<=e?10:400<=e?5:1},this.getMaxPaginationOneToOne=function(){var e=$(window).width();return 1300<=e?10:1e3<=e?6:850<=e?4:600<=e?3:300<=e?2:1};var t,n=function(e){return t||(t=document.createElement("a")),t.href=e,t.href};function o(e){return{"-ms-zoom":e,"-moz-transform":"scale("+e+")","-moz-transform-origin":"0 0","-o-transform":"scale("+e+")","-o-transform-origin":"0 0","-webkit-transform":"scale("+e+")","-webkit-transform-origin":"0 0"}}this.getAbsoluteUrl=n,this.initScopeForIframeZoom=function(e){e.maxZoom=3.75,e.minZoom=1,e.zoom=1,e.zoomIn=function(){e.zoom+=.25,e.iframeStyle=o(e.zoom)},e.zoomOut=function(){e.zoom-=.25,e.iframeStyle=o(e.zoom)}}}])}L.prototype.splitText=function(e,t){for(var n=[],o=0;o<t.length;o++){var i,r=t[o];if(o==t.length-1)i=e.substr(r);else{var s=t[o+1];i=e.substr(r,s-r)}n.push(i)}return n},L.prototype.split=function(e,t,n){if(null==e)return null;var o,i;"sourceToSuspect"==n?(o="SoS",i="SoE"):"suspectToSource"==n&&(o="SuS",i="SuE");var r=[];null===t&&(t=[0]);for(var s=0;s<t.length;++s)r.push([]);for(s=0;s<t.length;++s){var a,c=t[s];a=s+1===t.length?99999999:t[s+1];for(var l=0;l<e.length;++l){var u=e[l];if(c<=u[o]&&u[o]<a)if(a>u[i])r[s].push(u);else{var d=$.extend({},u);d[i]=a,u[o]=a,r[s].push(d)}}}return this.makePageZeroBased(r,t,n)},L.prototype.makePageZeroBased=function(e,t,n){var o,i;"sourceToSuspect"==n?(o="SoS",i="SoE"):"suspectToSource"==n&&(o="SuS",i="SuE");for(var r=1;r<t.length;++r)for(var s=0;s<e[r].length;++s)e[r][s][o]-=t[r],e[r][s][i]-=t[r];return e},B.prototype.appendHigherPriority=function(e,t){var n=t.data;if(e.s>n.e)return t.next?this.append(e,t.next):(t.next=new N(e),t.next);if(e.s==n.s){if(e.e==n.e)return n.p=e.p,t.next;if(e.e>n.e)return n.p=e.p,null==t.next?t:this.append({s:n.e+1,e:e.e,p:e.p},t.next);if(e.e<n.e)return(r=new N({s:e.e+1,e:n.e,p:n.p})).next=t.next,t.next=r,n.p=e.p,n.e=e.e,r}if(e.e==n.e)return(r=new N({s:e.s,e:e.e,p:e.p})).next=t.next,t.next=r,n.e=e.s-1,r;if(e.e>n.e){var o=n.e;return(r=new N({s:e.s,e:n.e,p:e.p})).next=t.next,t.next=r,n.e=e.s-1,null==r.next?(r.data.e=e.e,r):this.append({s:o+1,e:e.e,p:e.p},r.next)}if(e.e<n.e){var i=t.next,r=new N({s:e.s,e:e.e,p:e.p});t.next=r;var s=new N({s:e.e+1,e:n.e,p:n.p});return n.e=e.s-1,s.next=i,r.next=s}throw new Error("Should not be possible")},B.prototype.appendLowerPriority=function(e,t){var n=t.data;if(e.s>n.e)return null==t.next?t:this.append(e,t.next);if(e.s==n.s){if(e.e==n.e)return t.next;if(e.e>n.e)return null==t.next?t:this.append({s:n.e+1,e:e.e,p:e.p},t.next);if(e.e<n.e)return t}if(e.e==n.e||e.e<n.e)return t;if(e.e>n.e)return null==t.next?t:this.append({s:n.e+1,e:e.e,p:e.p},t.next);throw new Error("Should not be possible")},B.prototype.append=function(e,t){var n=t.data;return e.p<n.p?this.appendHigherPriority(e,t):this.appendLowerPriority(e,t)},B.prototype.add=function(e){var t=new N(e),n=this.head;if(!n)return this.head=t;for(;n.next;)n=n.next;return n.next=t},B.prototype.print=function(e){if(null==this.head)return"";for(var t=[],n=this.head;t.push(n.data),n=n.next;);return t.reduce(function(e,t){return e+"Node-"+t.p+": "+t.s+","+t.e+"\n"},"")},B.prototype.toArray=function(e){var t=[];if(null==this.head)return[];for(var n=this.head;n.data.p<4&&t.push(n.data),n=n.next;);return t};var G=angular.module("ThemingModule",["ngMaterial"]);function q(e){function t(t,e,n){function o(e){t.ready=!0,t.sources[0].percent=1<=e.percentage.identical.real?e.percentage.identical.round:e.percentage.identical.real,t.sources[1].percent=1<=e.percentage.similar.real?e.percentage.similar.round:e.percentage.similar.real,t.sources[2].percent=1<=e.percentage.related.real?e.percentage.related.round:e.percentage.related.real}t.control.showStatistics=underscore.debounce(function(e){n.log("cpGraphLegend: showStatistics"),t.$apply(function(){o(e)})},1e3),t.sources=[{percent:0,text:"Identical",colorBoxStyle:{"background-color":"#FF6666"},setting:"showIdentical",tooltipText:"Exact wording in the text"},{percent:0,text:"Minor Changes",colorBoxStyle:{"background-color":"#FF9A9A"},setting:"showSimilar",tooltipText:'Nearly identical with different form i.e. "slow" becomes "slowly"'},{percent:0,text:"Related Meaning",colorBoxStyle:{"background-color":"#FFD9B0"},setting:"showRelated",tooltipText:"Close meaning but different words "}],t.settings=e.instance,t.control.isEmpty?o(t.control.emptyResults):t.control.statistics&&o(t.control.statistics),t.control.showEmpty=function(e){o(e)},t.$on("recalculatingStatistics",function(){t.ready=!1,t.sources=[{percent:0,text:"Identical",colorBoxStyle:{"background-color":"#FF6666"},setting:"showIdentical",tooltipText:"Exact wording in the text"},{percent:0,text:"Minor Changes",colorBoxStyle:{"background-color":"#FF9A9A"},setting:"showSimilar",tooltipText:'Nearly identical with different form i.e. "slow" becomes "slowly"'},{percent:0,text:"Related Meaning",colorBoxStyle:{"background-color":"#FFD9B0"},setting:"showRelated",tooltipText:"Close meaning but different words "}]})}t.$inject=["$scope","settingsService","logService"],e.directive("cpGraphLegend",[function(){return{restrict:"E",scope:{control:"="},template:'<div class="cp-graph-legend"><div ng-repeat="legendItem in sources" class="legend-item" ng-show="settings[legendItem.setting]"><div class="box-wrapper"><div class="color-box" ng-style="legendItem.colorBoxStyle"></div></div><div class="legend-title">{{legendItem.text}}</div><span class="legend-info"><md-tooltip md-autohide="true" md-delay="500">{{legendItem.tooltipText}}</md-tooltip></span><div class="legend-percent" ng-if="legendItem.percent == 0">0%</div><div class="legend-percent" ng-if="legendItem.percent >= 1">{{legendItem.percent | number:0}}%</div><div class="legend-percent" ng-if="legendItem.percent < 1 && legendItem.percent > 0">&lt;1%</div></div></div>',controller:t}}])}function Z(e){function t(o,e,t,n){function i(e){o.data=[e.wordsNotCopied,e.identical.real,e.similar.real,e.related.real],o.roundedData=[e.wordsNotCopied,e.identical.round,e.similar.round,e.related.round]}o.labels=["Original","Identical","Minor Changes","Related Meaning"],o.colors=["#ffffff","#FF6666","#FF9A9A","#FFD9B0"],o.data=[10,10,10],o.options={responsive:!0,maintainAspectRatio:!1,legend:{display:!1},segmentShowStroke:!1,elements:{arc:{borderWidth:0}},tooltips:{callbacks:{title:function(e,t){return t.labels[e[0].index]},label:function(e,t){if(o.roundedData){var n=t.datasets[0];return 1<=n.data[e.index]||0==n.data[e.index]?"("+o.roundedData[e.index]+"%)":"(<1%)"}},afterLabel:function(e,t){return""}},backgroundColor:"#ff0000",titleFontSize:16,titleFontColor:"#fdfdfd",bodyFontColor:"#fdfdfd",bodyFontSize:14,displayColors:!1,mode:"nearest",position:"nearest"}},o.control.showStatistics=t.throttleWithGuaranteedLastRun(function(e){n.log("cpGraph: showStatistics"),o.ready=!0,i(o.control.statistics.percentage)},1e3),o.ready=!1,o.control.isEmpty?(o.ready=!0,o.data=[1,0,0,0]):o.control.statistics&&(o.ready=!0,i(o.control.statistics.percentage)),o.control.showEmpty=function(){o.ready=!0,o.data=[1,0,0,0]},o.$on("recalculatingStatistics",function(){o.ready=!1})}t.$inject=["$scope","$element","utilitiesService","logService"],e.directive("cpGraph",[function(){return{restrict:"E",scope:{control:"="},template:'<div ng-if="!ready" class="loading-indicator"><md-tooltip md-direction="bottom" md-delay="500">Computing statistics graph...</md-tooltip><md-progress-circular md-mode="indeterminate" class="pull-left" md-diameter="20px"></md-progress-circular><label>Computing...</label></div><div ng-if="ready" class="position-relative"><div class="cp-graph-wrapper" ng-if="ready"><canvas id="pie" class="chart chart-pie" chart-data="data" chart-labels="labels" chart-options="options" chart-click="onClick" chart-colors="colors"></canvas></div></div>',controller:t}}])}function J(e){function t(t,e,n){function o(){t.total=t.statistics.percentage.identical.round+t.statistics.percentage.similar.round+t.statistics.percentage.related.round,t.ready=!0}t.control.showStatistics=underscore.debounce(function(e){n.log("cpStatistics: showStatistics"),t.$apply(function(){t.statistics=e,o()})},1e3),t.ready=!1,t.control.isEmpty?(n.log("cpStatistics: $scope.control.isEmpty"),t.statistics=t.control.emptyResults,o()):t.control.statistics&&(t.statistics=t.control.statistics,o()),t.control.showEmpty=function(e){t.statistics=e,o()},t.$on("recalculatingStatistics",function(){t.ready=!1,delete t.total})}t.$inject=["$scope","$element","logService"],e.directive("cpStatistics",["logService",function(e){return{restrict:"E",scope:{control:"="},template:'<div class="statistics-control"><div class="suspected-words">Suspected Words</div><div ng-if="!ready" class="loading-indicator"><md-tooltip md-direction="bottom" md-delay="500">Computing statistics...</md-tooltip><md-progress-circular md-mode="indeterminate" class="pull-left" md-diameter="20px"></md-progress-circular><label>Computing...</label></div><div ng-if="ready" layout="column"><div layout="row" layout-align="start center"><div class="suspected-indicator" ng-class="{\'low\': total <= 20 , \'medium\': total <= 60 && total>=21, \'high\': total > 60}">{{total| number:0}}%</div><span class="suspected-indicator-icon"><md-icon class="cl-info">info_outline</md-icon><md-tooltip md-direction="left" md-autohide="true" md-delay="500">{{total| number:0}}% of this content is similar to other sources</md-tooltip></span></div><div class="suspected-counter" ng-class="{\'low\': total <= 20 , \'medium\': total <= 60 && total>=21, \'high\': total > 60}">{{statistics.totalCopiedWords | prettyNumberWithK}} Words Copied<md-tooltip md-direction="left" md-autohide="true" ng-if="statistics.totalCopiedWords >= 1000" md-delay="500">{{statistics.totalCopiedWords | number}} Words Copied</md-tooltip></div></div></div>',controller:t}}])}function K(e){e.service("affixService",["$q",function(e){return{init:function(m,h,f){var v=-1;m.$on("registerAffix",function(e,t){t.type,m.registerAffix()}),m.registerAffix=function(){m.removeAffix=function(){var e=document.getElementById(f),t=$(e);t.removeClass("my-affix-active");var n=t.parent();n.css("flex-direction","row")},m.deregisterAffix=function(){window.removeEventListener("scroll",e)},window.removeEventListener("scroll",e),window.addEventListener("scroll",e),$(window).resize(function(){var e=$(window);if(!(e.width()<768)){var t=document.getElementById(f),n=$(t);n.hasClass("my-affix-active")}})};var S=-1;function e(){!function(){var e=$(window),t=$(h),n=document.getElementById(f),o=$(n);if(e.width()<768)return;if(!m.okToAffix)return;var i=window.innerHeight,r=t.offset().top-i+t.height(),s=o.offset().top,a=o.height(),c=e.scrollTop(),l=$(".actual-results-height").height();if(c<v)y(o),v=-1;else if(c<S)y(o),v=-1;else if(-1==v&&r<=c){$(".result-div").width();var u=$("#my-affix").width(),d=o.parent(),p=d.width();if(c<=s)return;if(l<o.find("md-card").height())return;S=s;o.find("md-card").height();o.addClass("my-affix-active"),v=r,a<i?(o.css("top",0),o.css("bottom","auto")):(o.css("bottom",62),o.css("top","auto")),d.css("flex-direction","row-reverse");o.find("md-card").css("margin-top",0);var g=u/p*100+"%";$("#my-affix").css("width",g)}}()}function y(e){var t=e.parent();t.css("flex-direction",""),e.removeClass("my-affix-active"),v=-1,e.css("top","auto"),e.css("bottom","auto"),e.css("width","auto"),e.find("md-card").css("margin-top","")}}}}])}function Y(e){function t(t,e,n,o,i,r){t.allSources=function(e){var t=[];for(var n in e)t.push(e[n]);return t}(i.sources),t.reportDataService=i,t.changeSourceVisibilityStatus=function(e){e.is_active=!e.is_active},t.test=function(){},t.uncheckAll=function(){for(var e in t.reportDataService.sources)t.reportDataService.sources[e].is_active=!1},t.checkAll=function(){for(var e in t.reportDataService.sources)t.reportDataService.sources[e].is_active=!0},t.close=function(){o.cancel(),r.$broadcast("updatePageMatchesNow"),r.$broadcast("updateGraph")}}e.service("filterDialogService",["$mdDialog",function(e){return{show:function(){return e.show({controller:t,template:'<md-dialog aria-label="Filter results" class="modal-dialog copyleaks-report-parent"><form ng-cloak><md-toolbar><div layout="row" class="flex-center-center"><h4 class="modal-title" flex>Results Filter</h4><md-button ng-click="close()" class="md-icon-button" aria-label="close filter dialog"><i class="material-icons">close</i></md-button></div></md-toolbar><md-dialog-content class="filter-dialog-content"><md-input-container class="md-block no-gap-bottom"><label layout="row"><i class="material-icons" aria-hidden="true">search</i> Filtered by Results</label> <input ng-model="source_filter_query"></md-input-container><ul class="filtered-list list-unstyled flexcroll"><li ng-repeat="source in allSources | orderBy:\'title\' | filter: {url: source_filter_query} as filtered_sources track by $index" ng-class="{\'unchecked-source\': !source.is_active}" title="{{source.url}}" ng-click="changeSourceVisibilityStatus(source);"><span ng-class="source.is_active ? \'visibility-on\' : \'visibility-off\'"></span> <span class="ellipsis-text">{{ source.title }}</span></li></ul></md-dialog-content><md-dialog-actions layout="row"><div flex layout="column"><a ng-click="uncheckAll()">Hide all results</a> <a ng-click="checkAll()">Show all results</a></div><md-button class="md-raised md-primary" ng-click="close()">Close</md-button></md-dialog-actions></form></md-dialog>',parent:angular.element(document.body),clickOutsideToClose:!0})}}}]),t.$inject=["$scope","$element","$timeout","$mdDialog","reportDataService","$rootScope"]}function X(e){function t(n,e,t,o,i,r,s){n.saveDisabled=!0,n.tempSettings=angular.extend({},r.instance),n.settings_make_default=!1,n.saveSettings=function(){var e=r.instance.showPageSources!=n.tempSettings.showPageSources,t=r.instance.showOnlyTopResults!=n.tempSettings.showOnlyTopResults;angular.extend(r.instance,n.tempSettings),n.settings_make_default&&r.set_default_settings(r.instance),r.set_settings(r.instance),n.tempSettings.showPageSources||s.$broadcast("getMoreResults"),(t||e)&&s.$broadcast("raiseSourceListRefresh"),o.cancel(),s.$broadcast("updatePageMatches"),n.$emit("updateGraph")},n.enableSave=function(){n.saveDisabled=!1},n.close=function(){o.cancel(),s.$broadcast("updatePageMatchesNow"),s.$broadcast("updateGraph")}}e.service("settingsDialogService",["$mdDialog",function(e){return{show:function(){return e.show({controller:t,template:'<md-dialog aria-label="settings dialog" class="modal-dialog copyleaks-report-parent"><form ng-cloak><md-toolbar><div layout="row" class="flex-center-center"><h4 class="modal-title" flex>Settings</h4><md-button ng-click="close()" class="md-icon-button" aria-label="close filter dialog"><i class="material-icons" aria-hidden="true">close</i></md-button></div></md-toolbar><md-dialog-content class="settings-dialog-content"><div class="modal-body"><md-switch ng-model="tempSettings.showPageSources" aria-label="Show only sources with matches in page" ng-click="enableSave();"><span hide-xs>View sources with matches in page</span></md-switch><label class="md-title" hide show-xs>View sources with matches in page</label><md-switch ng-model="tempSettings.showOnlyTopResults" aria-label="Related Meaning" ng-click="enableSave();"><span hide-xs>Show only top 100 relevant results</span></md-switch><div class="md-title" hide show-xs>Show only top 100 relevant results</div><label class="warning" ng-if="!tempSettings.showOnlyTopResults">If disabled, the scan may be slowed down</label><md-divider style="margin:20px 0;"></md-divider><ul class="list-unstyled"><li><md-checkbox ng-model="tempSettings.showIdentical" aria-label="Identical" ng-click="enableSave();" ng-disabled="!tempSettings.showSimilar && !tempSettings.showRelated">Identical</md-checkbox></li><li><md-checkbox ng-model="tempSettings.showSimilar" aria-label="Similar" ng-click="enableSave();" ng-disabled="!tempSettings.showIdentical&& !tempSettings.showRelated">Minor Changes</md-checkbox></li><li><md-checkbox ng-model="tempSettings.showRelated" aria-label="Related Meaning" ng-click="enableSave();" ng-disabled="!tempSettings.showIdentical && !tempSettings.showSimilar">Related Meaning</md-checkbox></li></ul></div></md-dialog-content><md-dialog-actions layout="row"><div layout="row" class="settings-actions" flex><div><md-checkbox ng-model="settings_make_default" aria-label="Set default" ng-click="enableSave();">Set as default for all scans</md-checkbox></div><md-button class="md-raised md-primary" ng-click="saveSettings()" ng-disabled="saveDisabled">Save</md-button></div></md-dialog-actions></form></md-dialog>',clickOutsideToClose:!0})}}}]),t.$inject=["$scope","$element","$timeout","$mdDialog","reportDataService","settingsService","$rootScope"]}function Q(e){function n(t,n,o,e,i,r,s){var a="Only you can view this report.";t.urlForSharing=null,t.deleted=!1,t.saveDisabled=!0,r.getSharingUrl(i.pid).then(function(e){e&&(t.urlForSharing=e,t.urlForSharing&&t.urlForSharing!=a)&&t.selectText()});var c=0;t.selectText=function(){5<=c++?t.saveDisabled=!1:angular.element(document.body).hasClass("md-dialog-is-showing")?o(function(){var e=n.find("#share-link-input")[0];e.focus(),e.setSelectionRange(0,e.value.length),o(function(){t.saveDisabled=!1},500)},100):o(t.selectText,100)},t.deleteSharedLink=function(){reportServiceMediator.deleteSharingKey(t.pid),t.deleted=!0,t.urlForSharing=a},t.close=function(){e.cancel()}}e.service("shareDialogService",["$mdDialog","reportServiceMediator",function(e,t){return{show:function(){return e.show({controller:n,template:'<md-dialog aria-label="settings dialog" class="modal-dialog copyleaks-report-parent" id="share-form"><form ng-cloak><md-toolbar><div layout="row" class="flex-center-center"><h4 class="modal-title" flex>Share with others</h4><md-button ng-click="close()" class="md-icon-button" aria-label="close filter dialog"><i class="material-icons" aria-hidden="true">close</i></md-button></div></md-toolbar><md-dialog-content class="settings-dialog-content"><div class="modal-body"><div layout="row"><div flex="100" class="anyone-can-share-label"><div ng-show="!urlForSharing && !deleted"><md-tooltip md-direction="bottom" style="margin-right:10px" md-delay="500">Generating Share url</md-tooltip><md-progress-circular md-mode="indeterminate" class="pull-left" md-diameter="25px"></md-progress-circular></div><md-label>Use this URL to share the comparison report</md-label></div></div><div layout="row"><div flex="100"><md-input-container class="md-block"><md-icon md-font-icon="link">link</md-icon><input id="share-link-input" type="text" aria-label="Share this comparison report" ng-model="urlForSharing" readonly onClick="this.setSelectionRange(0, this.value.length)"></md-input-container></div></div><div layout="row" class="sharing-info-section" ng-if="!disableDelete"><div flex="9"><md-icon>lock_outline</md-icon></div><div flex="91"><div>You can <a ng-click="deleteSharedLink()">revoke access</a> from others seeing this report</div></div></div></div></md-dialog-content><md-dialog-actions layout="row"><div layout="row" class="sharing-actions" flex><md-button class="md-raised md-primary" ng-click="close()" ng-disabled="saveDisabled">OK</md-button></div></md-dialog-actions></form></md-dialog>',parent:angular.element(document.body),clickOutsideToClose:!0})}}}]),n.$inject=["$scope","$element","$timeout","$mdDialog","reportDataService","reportServiceListener","$rootScope"]}G.config(["$mdThemingProvider",function(e){e.definePalette("amazingPaletteName",{50:"ffebee",100:"bbc3c9",200:"ef9a9a",300:"e57373",400:"ef5350",500:"17a1ff",600:"1c7ffa",700:"00ff00",800:"c62828",900:"b71c1c",A100:"ff8a01",A200:"ff5202",A400:"ff1703",A700:"17c9ff",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.definePalette("amazingContrastPallete",{50:"000000",100:"ffcd01",200:"ef9a9a",300:"e57373",400:"ef5350",500:"f44336",600:"e53902",700:"00ff00",800:"c62828",900:"b71c1c",A100:"ff8a01",A200:"17a1ff",A400:"ff1703",A700:"17a1ff",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.theme("default").primaryPalette("amazingPaletteName").accentPalette("amazingContrastPallete")}]),window.underscore=_.noConflict();