<cr-panel fxFlex>
	<cr-panel-header>
		Results
		<ng-container *ngIf="focusedMatch">
			({{visibleResults.length}} of {{previews?.length }})
		</ng-container>

	</cr-panel-header>
	<cr-panel-actions>
		<cr-panel-action *ngIf="focusedMatch">
			<ng-container *ngTemplateOutlet="menu__show_results"></ng-container>
		</cr-panel-action>
		<cr-panel-action *ngIf="isMobile">
			<button mat-button
							[disabled]="!previews"
							(click)="isActive = !isActive">
				<mat-icon>{{ isActive ? 'arrow_downward':'arrow_upward'}}</mat-icon>
			</button>
		</cr-panel-action>
		<cr-panel-action *ngIf="!isMobile || isActive">
			<button mat-button
							[ngClass]="{'mat-stroked-button mat-warn': hiddenResults.length}"
							[disabled]="!previews"
							[matTooltip]="hiddenResults.length  ? hiddenResults.length + ' results  are hidden':'Filter results'"
							(click)="openFilterDialog()">
				<mat-icon>filter_list</mat-icon>
			</button>
		</cr-panel-action>
		<cr-panel-action *ngIf="!isMobile || isActive">
			<button mat-button
							matTooltip="Results settings"
							(click)="openSettingsDialog()">
				<mat-icon>settings</mat-icon>
			</button>
		</cr-panel-action>

	</cr-panel-actions>
	<cr-panel-body fxLayout="column"
								 fxFlex="100">


		<cdk-virtual-scroll-viewport fxFlex
																 fxLayout="column"
																 autosize
																 fxLayoutGap="1em">
			<ng-container *ngIf="previews ; else skeleton__fakes">
				<cr-result-card *cdkVirtualFor="let preview of previews | whitelist:'id':focusedMatch?.ids;"
												[preview]="preview">
				</cr-result-card>
			</ng-container>
		</cdk-virtual-scroll-viewport>
	</cr-panel-body>
</cr-panel>
<ng-template #menu__show_results>
	<button mat-button
					(click)="clearFocusedMatch()"
					matTooltip="Clear filter">
		<mat-icon>close</mat-icon>
	</button>
</ng-template>

<ng-template #skeleton__fakes>
	<cr-result-card></cr-result-card>
	<cr-result-card></cr-result-card>
	<cr-result-card></cr-result-card>
</ng-template>
